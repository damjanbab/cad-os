var Cf=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Nm=Cf(O=>{var Pf=(()=>{var t=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(t=t||__filename),function(r){r=r||{};var r=typeof r<"u"?r:{},n,o;r.ready=new Promise(function(a,s){n=a,o=s});var i=Object.assign({},r),u="./this.program",l=(a,s)=>{throw s},f=typeof window=="object",p=typeof importScripts=="function",d=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",y="";function m(a){return r.locateFile?r.locateFile(a,y):y+a}var S,T,x;function C(a){if(a instanceof Ci)return;z("exiting due to exception: "+a)}var A,B,F;d?(p?y=require("path").dirname(y)+"/":y=__dirname+"/",F=()=>{B||(A=require("fs"),B=require("path"))},S=function(s,c){return F(),s=B.normalize(s),A.readFileSync(s,c?void 0:"utf8")},x=a=>{var s=S(a,!0);return s.buffer||(s=new Uint8Array(s)),s},T=(a,s,c)=>{F(),a=B.normalize(a),A.readFile(a,function(h,v){h?c(h):s(v.buffer)})},process.argv.length>1&&(u=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(a){if(!(a instanceof Ci))throw a}),process.on("unhandledRejection",function(a){throw a}),l=(a,s)=>{if(Zr())throw process.exitCode=a,s;C(s),process.exit(a)},r.inspect=function(){return"[Emscripten Module object]"}):(f||p)&&(p?y=self.location.href:typeof document<"u"&&document.currentScript&&(y=document.currentScript.src),t&&(y=t),y.indexOf("blob:")!==0?y=y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1):y="",S=a=>{var s=new XMLHttpRequest;return s.open("GET",a,!1),s.send(null),s.responseText},p&&(x=a=>{var s=new XMLHttpRequest;return s.open("GET",a,!1),s.responseType="arraybuffer",s.send(null),new Uint8Array(s.response)}),T=(a,s,c)=>{var h=new XMLHttpRequest;h.open("GET",a,!0),h.responseType="arraybuffer",h.onload=()=>{if(h.status==200||h.status==0&&h.response){s(h.response);return}c()},h.onerror=c,h.send(null)});var q=r.print||console.log.bind(console),z=r.printErr||console.warn.bind(console);Object.assign(r,i),i=null,r.arguments&&r.arguments,r.thisProgram&&(u=r.thisProgram),r.quit&&(l=r.quit);var ie=4,re;r.wasmBinary&&(re=r.wasmBinary);var ee=r.noExitRuntime||!0;typeof WebAssembly!="object"&&Ct("no native wasm support detected");var de,Te=!1;function Oe(a,s){a||Ct(s)}var Re=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Ce(a,s,c){for(var h=s+c,v=s;a[v]&&!(v>=h);)++v;if(v-s>16&&a.buffer&&Re)return Re.decode(a.subarray(s,v));for(var w="";s<v;){var _=a[s++];if(!(_&128)){w+=String.fromCharCode(_);continue}var b=a[s++]&63;if((_&224)==192){w+=String.fromCharCode((_&31)<<6|b);continue}var E=a[s++]&63;if((_&240)==224?_=(_&15)<<12|b<<6|E:_=(_&7)<<18|b<<12|E<<6|a[s++]&63,_<65536)w+=String.fromCharCode(_);else{var k=_-65536;w+=String.fromCharCode(55296|k>>10,56320|k&1023)}}return w}function ue(a,s){return a?Ce(Ye,a,s):""}function ge(a,s,c,h){if(!(h>0))return 0;for(var v=c,w=c+h-1,_=0;_<a.length;++_){var b=a.charCodeAt(_);if(b>=55296&&b<=57343){var E=a.charCodeAt(++_);b=65536+((b&1023)<<10)|E&1023}if(b<=127){if(c>=w)break;s[c++]=b}else if(b<=2047){if(c+1>=w)break;s[c++]=192|b>>6,s[c++]=128|b&63}else if(b<=65535){if(c+2>=w)break;s[c++]=224|b>>12,s[c++]=128|b>>6&63,s[c++]=128|b&63}else{if(c+3>=w)break;s[c++]=240|b>>18,s[c++]=128|b>>12&63,s[c++]=128|b>>6&63,s[c++]=128|b&63}}return s[c]=0,c-v}function Pe(a,s,c){return ge(a,Ye,s,c)}function ve(a){for(var s=0,c=0;c<a.length;++c){var h=a.charCodeAt(c);h>=55296&&h<=57343&&(h=65536+((h&1023)<<10)|a.charCodeAt(++c)&1023),h<=127?++s:h<=2047?s+=2:h<=65535?s+=3:s+=4}return s}var we=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function ke(a,s){for(var c=a,h=c>>1,v=h+s/2;!(h>=v)&&Dt[h];)++h;if(c=h<<1,c-a>32&&we)return we.decode(Ye.subarray(a,c));for(var w="",_=0;!(_>=s/2);++_){var b=ct[a+_*2>>1];if(b==0)break;w+=String.fromCharCode(b)}return w}function Ge(a,s,c){if(c===void 0&&(c=2147483647),c<2)return 0;c-=2;for(var h=s,v=c<a.length*2?c/2:a.length,w=0;w<v;++w){var _=a.charCodeAt(w);ct[s>>1]=_,s+=2}return ct[s>>1]=0,s-h}function _e(a){return a.length*2}function De(a,s){for(var c=0,h="";!(c>=s/4);){var v=L[a+c*4>>2];if(v==0)break;if(++c,v>=65536){var w=v-65536;h+=String.fromCharCode(55296|w>>10,56320|w&1023)}else h+=String.fromCharCode(v)}return h}function $t(a,s,c){if(c===void 0&&(c=2147483647),c<4)return 0;for(var h=s,v=h+c-4,w=0;w<a.length;++w){var _=a.charCodeAt(w);if(_>=55296&&_<=57343){var b=a.charCodeAt(++w);_=65536+((_&1023)<<10)|b&1023}if(L[s>>2]=_,s+=4,s+4>v)break}return L[s>>2]=0,s-h}function rt(a){for(var s=0,c=0;c<a.length;++c){var h=a.charCodeAt(c);h>=55296&&h<=57343&&++c,s+=4}return s}function je(a){var s=ve(a)+1,c=Ut(s);return c&&ge(a,Ne,c,s),c}function ut(a,s){Ne.set(a,s)}function Sr(a,s,c){for(var h=0;h<a.length;++h)Ne[s++>>0]=a.charCodeAt(h);c||(Ne[s>>0]=0)}var lt,Ne,Ye,ct,Dt,L,oe,nt,Rn;function dt(a){lt=a,r.HEAP8=Ne=new Int8Array(a),r.HEAP16=ct=new Int16Array(a),r.HEAP32=L=new Int32Array(a),r.HEAPU8=Ye=new Uint8Array(a),r.HEAPU16=Dt=new Uint16Array(a),r.HEAPU32=oe=new Uint32Array(a),r.HEAPF32=nt=new Float32Array(a),r.HEAPF64=Rn=new Float64Array(a)}r.INITIAL_MEMORY;var Mt,Dn=[],Mn=[],Yr=[];function Zr(){return ee}function Fn(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Qo(r.preRun.shift());Er(Dn)}function Bn(){!r.noFSInit&&!g.init.initialized&&g.init(),g.ignorePermissions=!1,Er(Mn)}function Ln(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)Jo(r.postRun.shift());Er(Yr)}function Qo(a){Dn.unshift(a)}function Un(a){Mn.unshift(a)}function Jo(a){Yr.unshift(a)}var vt=0,ur=null;function Ea(a){return a}function lr(a){vt++,r.monitorRunDependencies&&r.monitorRunDependencies(vt)}function Tr(a){if(vt--,r.monitorRunDependencies&&r.monitorRunDependencies(vt),vt==0&&ur){var s=ur;ur=null,s()}}function Ct(a){r.onAbort&&r.onAbort(a),a="Aborted("+a+")",z(a),Te=!0,a+=". Build with -sASSERTIONS for more info.";var s=new WebAssembly.RuntimeError(a);throw o(s),s}var qr="data:application/octet-stream;base64,";function In(a){return a.startsWith(qr)}function Gn(a){return a.startsWith("file://")}var He;He="replicad_single.wasm",In(He)||(He=m(He));function Yt(a){try{if(a==He&&re)return new Uint8Array(re);if(x)return x(a);throw"both async and sync fetching of the wasm failed"}catch(s){Ct(s)}}function ei(){if(!re&&(f||p)){if(typeof fetch=="function"&&!Gn(He))return fetch(He,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+He+"'";return a.arrayBuffer()}).catch(function(){return Yt(He)});if(T)return new Promise(function(a,s){T(He,function(c){a(new Uint8Array(c))},s)})}return Promise.resolve().then(function(){return Yt(He)})}function ti(){var a={a:Tf};function s(_,b){var E=_.exports;r.asm=E,de=r.asm.oa,dt(de.buffer),Mt=r.asm.va,Un(r.asm.pa),Tr()}lr();function c(_){s(_.instance)}function h(_){return ei().then(function(b){return WebAssembly.instantiate(b,a)}).then(function(b){return b}).then(_,function(b){z("failed to asynchronously prepare wasm: "+b),Ct(b)})}function v(){return!re&&typeof WebAssembly.instantiateStreaming=="function"&&!In(He)&&!Gn(He)&&!d&&typeof fetch=="function"?fetch(He,{credentials:"same-origin"}).then(function(_){var b=WebAssembly.instantiateStreaming(_,a);return b.then(c,function(E){return z("wasm streaming compile failed: "+E),z("falling back to ArrayBuffer instantiation"),h(c)})}):h(c)}if(r.instantiateWasm)try{var w=r.instantiateWasm(a,s);return w}catch(_){return z("Module.instantiateWasm callback failed with error: "+_),!1}return v().catch(o),{}}var Ie,gt;function Nn(){return r.HEAP8.length}function Er(a){for(;a.length>0;){var s=a.shift();if(typeof s=="function"){s(r);continue}var c=s.func;typeof c=="number"?s.arg===void 0?Cr(c)():Cr(c)(s.arg):c(s.arg===void 0?null:s.arg)}}var xr=[];function Cr(a){var s=xr[a];return s||(a>=xr.length&&(xr.length=a+1),xr[a]=s=Mt.get(a)),s}function Hn(a,s,c,h){Ct("Assertion failed: "+ue(a)+", at: "+[s?ue(s):"unknown filename",c,h?ue(h):"unknown function"])}function Vn(a){return Ut(a+24)+24}function ri(a){this.excPtr=a,this.ptr=a-24,this.set_type=function(s){oe[this.ptr+4>>2]=s},this.get_type=function(){return oe[this.ptr+4>>2]},this.set_destructor=function(s){oe[this.ptr+8>>2]=s},this.get_destructor=function(){return oe[this.ptr+8>>2]},this.set_refcount=function(s){L[this.ptr>>2]=s},this.set_caught=function(s){s=s?1:0,Ne[this.ptr+12>>0]=s},this.get_caught=function(){return Ne[this.ptr+12>>0]!=0},this.set_rethrown=function(s){s=s?1:0,Ne[this.ptr+13>>0]=s},this.get_rethrown=function(){return Ne[this.ptr+13>>0]!=0},this.init=function(s,c){this.set_adjusted_ptr(0),this.set_type(s),this.set_destructor(c),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var s=L[this.ptr>>2];L[this.ptr>>2]=s+1},this.release_ref=function(){var s=L[this.ptr>>2];return L[this.ptr>>2]=s-1,s===1},this.set_adjusted_ptr=function(s){oe[this.ptr+16>>2]=s},this.get_adjusted_ptr=function(){return oe[this.ptr+16>>2]},this.get_exception_ptr=function(){var s=Ya(this.get_type());if(s)return oe[this.excPtr>>2];var c=this.get_adjusted_ptr();return c!==0?c:this.excPtr}}function ni(a,s,c){var h=new ri(a);throw h.init(s,c),a}var le={isAbs:a=>a.charAt(0)==="/",splitPath:a=>{var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return s.exec(a).slice(1)},normalizeArray:(a,s)=>{for(var c=0,h=a.length-1;h>=0;h--){var v=a[h];v==="."?a.splice(h,1):v===".."?(a.splice(h,1),c++):c&&(a.splice(h,1),c--)}if(s)for(;c;c--)a.unshift("..");return a},normalize:a=>{var s=le.isAbs(a),c=a.substr(-1)==="/";return a=le.normalizeArray(a.split("/").filter(h=>!!h),!s).join("/"),!a&&!s&&(a="."),a&&c&&(a+="/"),(s?"/":"")+a},dirname:a=>{var s=le.splitPath(a),c=s[0],h=s[1];return!c&&!h?".":(h&&(h=h.substr(0,h.length-1)),c+h)},basename:a=>{if(a==="/")return"/";a=le.normalize(a),a=a.replace(/\/$/,"");var s=a.lastIndexOf("/");return s===-1?a:a.substr(s+1)},join:function(){var a=Array.prototype.slice.call(arguments,0);return le.normalize(a.join("/"))},join2:(a,s)=>le.normalize(a+"/"+s)};function Pr(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var a=new Uint8Array(1);return function(){return crypto.getRandomValues(a),a[0]}}else if(d)try{var s=require("crypto");return function(){return s.randomBytes(1)[0]}}catch{}return function(){Ct("randomDevice")}}var it={resolve:function(){for(var a="",s=!1,c=arguments.length-1;c>=-1&&!s;c--){var h=c>=0?arguments[c]:g.cwd();if(typeof h!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!h)return"";a=h+"/"+a,s=le.isAbs(h)}return a=le.normalizeArray(a.split("/").filter(v=>!!v),!s).join("/"),(s?"/":"")+a||"."},relative:(a,s)=>{a=it.resolve(a).substr(1),s=it.resolve(s).substr(1);function c(k){for(var U=0;U<k.length&&k[U]==="";U++);for(var I=k.length-1;I>=0&&k[I]==="";I--);return U>I?[]:k.slice(U,I-U+1)}for(var h=c(a.split("/")),v=c(s.split("/")),w=Math.min(h.length,v.length),_=w,b=0;b<w;b++)if(h[b]!==v[b]){_=b;break}for(var E=[],b=_;b<h.length;b++)E.push("..");return E=E.concat(v.slice(_)),E.join("/")}},Ft={ttys:[],init:function(){},shutdown:function(){},register:function(a,s){Ft.ttys[a]={input:[],output:[],ops:s},g.registerDevice(a,Ft.stream_ops)},stream_ops:{open:function(a){var s=Ft.ttys[a.node.rdev];if(!s)throw new g.ErrnoError(43);a.tty=s,a.seekable=!1},close:function(a){a.tty.ops.flush(a.tty)},flush:function(a){a.tty.ops.flush(a.tty)},read:function(a,s,c,h,v){if(!a.tty||!a.tty.ops.get_char)throw new g.ErrnoError(60);for(var w=0,_=0;_<h;_++){var b;try{b=a.tty.ops.get_char(a.tty)}catch{throw new g.ErrnoError(29)}if(b===void 0&&w===0)throw new g.ErrnoError(6);if(b==null)break;w++,s[c+_]=b}return w&&(a.node.timestamp=Date.now()),w},write:function(a,s,c,h,v){if(!a.tty||!a.tty.ops.put_char)throw new g.ErrnoError(60);try{for(var w=0;w<h;w++)a.tty.ops.put_char(a.tty,s[c+w])}catch{throw new g.ErrnoError(29)}return h&&(a.node.timestamp=Date.now()),w}},default_tty_ops:{get_char:function(a){if(!a.input.length){var s=null;if(d){var c=256,h=Buffer.alloc(c),v=0;try{v=A.readSync(process.stdin.fd,h,0,c,-1)}catch(w){if(w.toString().includes("EOF"))v=0;else throw w}v>0?s=h.slice(0,v).toString("utf-8"):s=null}else typeof window<"u"&&typeof window.prompt=="function"?(s=window.prompt("Input: "),s!==null&&(s+=`
`)):typeof readline=="function"&&(s=readline(),s!==null&&(s+=`
`));if(!s)return null;a.input=uo(s,!0)}return a.input.shift()},put_char:function(a,s){s===null||s===10?(q(Ce(a.output,0)),a.output=[]):s!=0&&a.output.push(s)},flush:function(a){a.output&&a.output.length>0&&(q(Ce(a.output,0)),a.output=[])}},default_tty1_ops:{put_char:function(a,s){s===null||s===10?(z(Ce(a.output,0)),a.output=[]):s!=0&&a.output.push(s)},flush:function(a){a.output&&a.output.length>0&&(z(Ce(a.output,0)),a.output=[])}}};function jr(a,s){Ye.fill(0,a,a+s)}function Kr(a,s){return Math.ceil(a/s)*s}function kr(a){a=Kr(a,65536);var s=$a(65536,a);return s?(jr(s,a),s):0}var K={ops_table:null,mount:function(a){return K.createNode(null,"/",16895,0)},createNode:function(a,s,c,h){if(g.isBlkdev(c)||g.isFIFO(c))throw new g.ErrnoError(63);K.ops_table||(K.ops_table={dir:{node:{getattr:K.node_ops.getattr,setattr:K.node_ops.setattr,lookup:K.node_ops.lookup,mknod:K.node_ops.mknod,rename:K.node_ops.rename,unlink:K.node_ops.unlink,rmdir:K.node_ops.rmdir,readdir:K.node_ops.readdir,symlink:K.node_ops.symlink},stream:{llseek:K.stream_ops.llseek}},file:{node:{getattr:K.node_ops.getattr,setattr:K.node_ops.setattr},stream:{llseek:K.stream_ops.llseek,read:K.stream_ops.read,write:K.stream_ops.write,allocate:K.stream_ops.allocate,mmap:K.stream_ops.mmap,msync:K.stream_ops.msync}},link:{node:{getattr:K.node_ops.getattr,setattr:K.node_ops.setattr,readlink:K.node_ops.readlink},stream:{}},chrdev:{node:{getattr:K.node_ops.getattr,setattr:K.node_ops.setattr},stream:g.chrdev_stream_ops}});var v=g.createNode(a,s,c,h);return g.isDir(v.mode)?(v.node_ops=K.ops_table.dir.node,v.stream_ops=K.ops_table.dir.stream,v.contents={}):g.isFile(v.mode)?(v.node_ops=K.ops_table.file.node,v.stream_ops=K.ops_table.file.stream,v.usedBytes=0,v.contents=null):g.isLink(v.mode)?(v.node_ops=K.ops_table.link.node,v.stream_ops=K.ops_table.link.stream):g.isChrdev(v.mode)&&(v.node_ops=K.ops_table.chrdev.node,v.stream_ops=K.ops_table.chrdev.stream),v.timestamp=Date.now(),a&&(a.contents[s]=v,a.timestamp=v.timestamp),v},getFileDataAsTypedArray:function(a){return a.contents?a.contents.subarray?a.contents.subarray(0,a.usedBytes):new Uint8Array(a.contents):new Uint8Array(0)},expandFileStorage:function(a,s){var c=a.contents?a.contents.length:0;if(!(c>=s)){var h=1024*1024;s=Math.max(s,c*(c<h?2:1.125)>>>0),c!=0&&(s=Math.max(s,256));var v=a.contents;a.contents=new Uint8Array(s),a.usedBytes>0&&a.contents.set(v.subarray(0,a.usedBytes),0)}},resizeFileStorage:function(a,s){if(a.usedBytes!=s)if(s==0)a.contents=null,a.usedBytes=0;else{var c=a.contents;a.contents=new Uint8Array(s),c&&a.contents.set(c.subarray(0,Math.min(s,a.usedBytes))),a.usedBytes=s}},node_ops:{getattr:function(a){var s={};return s.dev=g.isChrdev(a.mode)?a.id:1,s.ino=a.id,s.mode=a.mode,s.nlink=1,s.uid=0,s.gid=0,s.rdev=a.rdev,g.isDir(a.mode)?s.size=4096:g.isFile(a.mode)?s.size=a.usedBytes:g.isLink(a.mode)?s.size=a.link.length:s.size=0,s.atime=new Date(a.timestamp),s.mtime=new Date(a.timestamp),s.ctime=new Date(a.timestamp),s.blksize=4096,s.blocks=Math.ceil(s.size/s.blksize),s},setattr:function(a,s){s.mode!==void 0&&(a.mode=s.mode),s.timestamp!==void 0&&(a.timestamp=s.timestamp),s.size!==void 0&&K.resizeFileStorage(a,s.size)},lookup:function(a,s){throw g.genericErrors[44]},mknod:function(a,s,c,h){return K.createNode(a,s,c,h)},rename:function(a,s,c){if(g.isDir(a.mode)){var h;try{h=g.lookupNode(s,c)}catch{}if(h)for(var v in h.contents)throw new g.ErrnoError(55)}delete a.parent.contents[a.name],a.parent.timestamp=Date.now(),a.name=c,s.contents[c]=a,s.timestamp=a.parent.timestamp,a.parent=s},unlink:function(a,s){delete a.contents[s],a.timestamp=Date.now()},rmdir:function(a,s){var c=g.lookupNode(a,s);for(var h in c.contents)throw new g.ErrnoError(55);delete a.contents[s],a.timestamp=Date.now()},readdir:function(a){var s=[".",".."];for(var c in a.contents)a.contents.hasOwnProperty(c)&&s.push(c);return s},symlink:function(a,s,c){var h=K.createNode(a,s,41471,0);return h.link=c,h},readlink:function(a){if(!g.isLink(a.mode))throw new g.ErrnoError(28);return a.link}},stream_ops:{read:function(a,s,c,h,v){var w=a.node.contents;if(v>=a.node.usedBytes)return 0;var _=Math.min(a.node.usedBytes-v,h);if(_>8&&w.subarray)s.set(w.subarray(v,v+_),c);else for(var b=0;b<_;b++)s[c+b]=w[v+b];return _},write:function(a,s,c,h,v,w){if(s.buffer===Ne.buffer&&(w=!1),!h)return 0;var _=a.node;if(_.timestamp=Date.now(),s.subarray&&(!_.contents||_.contents.subarray)){if(w)return _.contents=s.subarray(c,c+h),_.usedBytes=h,h;if(_.usedBytes===0&&v===0)return _.contents=s.slice(c,c+h),_.usedBytes=h,h;if(v+h<=_.usedBytes)return _.contents.set(s.subarray(c,c+h),v),h}if(K.expandFileStorage(_,v+h),_.contents.subarray&&s.subarray)_.contents.set(s.subarray(c,c+h),v);else for(var b=0;b<h;b++)_.contents[v+b]=s[c+b];return _.usedBytes=Math.max(_.usedBytes,v+h),h},llseek:function(a,s,c){var h=s;if(c===1?h+=a.position:c===2&&g.isFile(a.node.mode)&&(h+=a.node.usedBytes),h<0)throw new g.ErrnoError(28);return h},allocate:function(a,s,c){K.expandFileStorage(a.node,s+c),a.node.usedBytes=Math.max(a.node.usedBytes,s+c)},mmap:function(a,s,c,h,v){if(!g.isFile(a.node.mode))throw new g.ErrnoError(43);var w,_,b=a.node.contents;if(!(v&2)&&b.buffer===lt)_=!1,w=b.byteOffset;else{if((c>0||c+s<b.length)&&(b.subarray?b=b.subarray(c,c+s):b=Array.prototype.slice.call(b,c,c+s)),_=!0,w=kr(s),!w)throw new g.ErrnoError(48);Ne.set(b,w)}return{ptr:w,allocated:_}},msync:function(a,s,c,h,v){if(!g.isFile(a.node.mode))throw new g.ErrnoError(43);return v&2||K.stream_ops.write(a,s,0,h,c,!1),0}}};function oi(a,s,c,h){var v=h?"":"al "+a;T(a,function(w){Oe(w,'Loading data file "'+a+'" failed (no arrayBuffer).'),s(new Uint8Array(w)),v&&Tr()},function(w){if(c)c();else throw'Loading data file "'+a+'" failed.'}),v&&lr()}var g={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(a,s={})=>{if(a=it.resolve(g.cwd(),a),!a)return{path:"",node:null};var c={follow_mount:!0,recurse_count:0};if(s=Object.assign(c,s),s.recurse_count>8)throw new g.ErrnoError(32);for(var h=le.normalizeArray(a.split("/").filter(I=>!!I),!1),v=g.root,w="/",_=0;_<h.length;_++){var b=_===h.length-1;if(b&&s.parent)break;if(v=g.lookupNode(v,h[_]),w=le.join2(w,h[_]),g.isMountpoint(v)&&(!b||b&&s.follow_mount)&&(v=v.mounted.root),!b||s.follow)for(var E=0;g.isLink(v.mode);){var k=g.readlink(w);w=it.resolve(le.dirname(w),k);var U=g.lookupPath(w,{recurse_count:s.recurse_count+1});if(v=U.node,E++>40)throw new g.ErrnoError(32)}}return{path:w,node:v}},getPath:a=>{for(var s;;){if(g.isRoot(a)){var c=a.mount.mountpoint;return s?c[c.length-1]!=="/"?c+"/"+s:c+s:c}s=s?a.name+"/"+s:a.name,a=a.parent}},hashName:(a,s)=>{for(var c=0,h=0;h<s.length;h++)c=(c<<5)-c+s.charCodeAt(h)|0;return(a+c>>>0)%g.nameTable.length},hashAddNode:a=>{var s=g.hashName(a.parent.id,a.name);a.name_next=g.nameTable[s],g.nameTable[s]=a},hashRemoveNode:a=>{var s=g.hashName(a.parent.id,a.name);if(g.nameTable[s]===a)g.nameTable[s]=a.name_next;else for(var c=g.nameTable[s];c;){if(c.name_next===a){c.name_next=a.name_next;break}c=c.name_next}},lookupNode:(a,s)=>{var c=g.mayLookup(a);if(c)throw new g.ErrnoError(c,a);for(var h=g.hashName(a.id,s),v=g.nameTable[h];v;v=v.name_next){var w=v.name;if(v.parent.id===a.id&&w===s)return v}return g.lookup(a,s)},createNode:(a,s,c,h)=>{var v=new g.FSNode(a,s,c,h);return g.hashAddNode(v),v},destroyNode:a=>{g.hashRemoveNode(a)},isRoot:a=>a===a.parent,isMountpoint:a=>!!a.mounted,isFile:a=>(a&61440)===32768,isDir:a=>(a&61440)===16384,isLink:a=>(a&61440)===40960,isChrdev:a=>(a&61440)===8192,isBlkdev:a=>(a&61440)===24576,isFIFO:a=>(a&61440)===4096,isSocket:a=>(a&49152)===49152,flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:a=>{var s=g.flagModes[a];if(typeof s>"u")throw new Error("Unknown file open mode: "+a);return s},flagsToPermissionString:a=>{var s=["r","w","rw"][a&3];return a&512&&(s+="w"),s},nodePermissions:(a,s)=>g.ignorePermissions?0:s.includes("r")&&!(a.mode&292)||s.includes("w")&&!(a.mode&146)||s.includes("x")&&!(a.mode&73)?2:0,mayLookup:a=>{var s=g.nodePermissions(a,"x");return s||(a.node_ops.lookup?0:2)},mayCreate:(a,s)=>{try{var c=g.lookupNode(a,s);return 20}catch{}return g.nodePermissions(a,"wx")},mayDelete:(a,s,c)=>{var h;try{h=g.lookupNode(a,s)}catch(w){return w.errno}var v=g.nodePermissions(a,"wx");if(v)return v;if(c){if(!g.isDir(h.mode))return 54;if(g.isRoot(h)||g.getPath(h)===g.cwd())return 10}else if(g.isDir(h.mode))return 31;return 0},mayOpen:(a,s)=>a?g.isLink(a.mode)?32:g.isDir(a.mode)&&(g.flagsToPermissionString(s)!=="r"||s&512)?31:g.nodePermissions(a,g.flagsToPermissionString(s)):44,MAX_OPEN_FDS:4096,nextfd:(a=0,s=g.MAX_OPEN_FDS)=>{for(var c=a;c<=s;c++)if(!g.streams[c])return c;throw new g.ErrnoError(33)},getStream:a=>g.streams[a],createStream:(a,s,c)=>{g.FSStream||(g.FSStream=function(){this.shared={}},g.FSStream.prototype={},Object.defineProperties(g.FSStream.prototype,{object:{get:function(){return this.node},set:function(v){this.node=v}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(v){this.shared.flags=v}},position:{get:function(){return this.shared.position},set:function(v){this.shared.position=v}}})),a=Object.assign(new g.FSStream,a);var h=g.nextfd(s,c);return a.fd=h,g.streams[h]=a,a},closeStream:a=>{g.streams[a]=null},chrdev_stream_ops:{open:a=>{var s=g.getDevice(a.node.rdev);a.stream_ops=s.stream_ops,a.stream_ops.open&&a.stream_ops.open(a)},llseek:()=>{throw new g.ErrnoError(70)}},major:a=>a>>8,minor:a=>a&255,makedev:(a,s)=>a<<8|s,registerDevice:(a,s)=>{g.devices[a]={stream_ops:s}},getDevice:a=>g.devices[a],getMounts:a=>{for(var s=[],c=[a];c.length;){var h=c.pop();s.push(h),c.push.apply(c,h.mounts)}return s},syncfs:(a,s)=>{typeof a=="function"&&(s=a,a=!1),g.syncFSRequests++,g.syncFSRequests>1&&z("warning: "+g.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var c=g.getMounts(g.root.mount),h=0;function v(_){return g.syncFSRequests--,s(_)}function w(_){if(_)return w.errored?void 0:(w.errored=!0,v(_));++h>=c.length&&v(null)}c.forEach(_=>{if(!_.type.syncfs)return w(null);_.type.syncfs(_,a,w)})},mount:(a,s,c)=>{var h=c==="/",v=!c,w;if(h&&g.root)throw new g.ErrnoError(10);if(!h&&!v){var _=g.lookupPath(c,{follow_mount:!1});if(c=_.path,w=_.node,g.isMountpoint(w))throw new g.ErrnoError(10);if(!g.isDir(w.mode))throw new g.ErrnoError(54)}var b={type:a,opts:s,mountpoint:c,mounts:[]},E=a.mount(b);return E.mount=b,b.root=E,h?g.root=E:w&&(w.mounted=b,w.mount&&w.mount.mounts.push(b)),E},unmount:a=>{var s=g.lookupPath(a,{follow_mount:!1});if(!g.isMountpoint(s.node))throw new g.ErrnoError(28);var c=s.node,h=c.mounted,v=g.getMounts(h);Object.keys(g.nameTable).forEach(_=>{for(var b=g.nameTable[_];b;){var E=b.name_next;v.includes(b.mount)&&g.destroyNode(b),b=E}}),c.mounted=null;var w=c.mount.mounts.indexOf(h);c.mount.mounts.splice(w,1)},lookup:(a,s)=>a.node_ops.lookup(a,s),mknod:(a,s,c)=>{var h=g.lookupPath(a,{parent:!0}),v=h.node,w=le.basename(a);if(!w||w==="."||w==="..")throw new g.ErrnoError(28);var _=g.mayCreate(v,w);if(_)throw new g.ErrnoError(_);if(!v.node_ops.mknod)throw new g.ErrnoError(63);return v.node_ops.mknod(v,w,s,c)},create:(a,s)=>(s=s!==void 0?s:438,s&=4095,s|=32768,g.mknod(a,s,0)),mkdir:(a,s)=>(s=s!==void 0?s:511,s&=1023,s|=16384,g.mknod(a,s,0)),mkdirTree:(a,s)=>{for(var c=a.split("/"),h="",v=0;v<c.length;++v)if(c[v]){h+="/"+c[v];try{g.mkdir(h,s)}catch(w){if(w.errno!=20)throw w}}},mkdev:(a,s,c)=>(typeof c>"u"&&(c=s,s=438),s|=8192,g.mknod(a,s,c)),symlink:(a,s)=>{if(!it.resolve(a))throw new g.ErrnoError(44);var c=g.lookupPath(s,{parent:!0}),h=c.node;if(!h)throw new g.ErrnoError(44);var v=le.basename(s),w=g.mayCreate(h,v);if(w)throw new g.ErrnoError(w);if(!h.node_ops.symlink)throw new g.ErrnoError(63);return h.node_ops.symlink(h,v,a)},rename:(a,s)=>{var c=le.dirname(a),h=le.dirname(s),v=le.basename(a),w=le.basename(s),_,b,E;if(_=g.lookupPath(a,{parent:!0}),b=_.node,_=g.lookupPath(s,{parent:!0}),E=_.node,!b||!E)throw new g.ErrnoError(44);if(b.mount!==E.mount)throw new g.ErrnoError(75);var k=g.lookupNode(b,v),U=it.relative(a,h);if(U.charAt(0)!==".")throw new g.ErrnoError(28);if(U=it.relative(s,c),U.charAt(0)!==".")throw new g.ErrnoError(55);var I;try{I=g.lookupNode(E,w)}catch{}if(k!==I){var D=g.isDir(k.mode),H=g.mayDelete(b,v,D);if(H)throw new g.ErrnoError(H);if(H=I?g.mayDelete(E,w,D):g.mayCreate(E,w),H)throw new g.ErrnoError(H);if(!b.node_ops.rename)throw new g.ErrnoError(63);if(g.isMountpoint(k)||I&&g.isMountpoint(I))throw new g.ErrnoError(10);if(E!==b&&(H=g.nodePermissions(b,"w"),H))throw new g.ErrnoError(H);g.hashRemoveNode(k);try{b.node_ops.rename(k,E,w)}catch(Z){throw Z}finally{g.hashAddNode(k)}}},rmdir:a=>{var s=g.lookupPath(a,{parent:!0}),c=s.node,h=le.basename(a),v=g.lookupNode(c,h),w=g.mayDelete(c,h,!0);if(w)throw new g.ErrnoError(w);if(!c.node_ops.rmdir)throw new g.ErrnoError(63);if(g.isMountpoint(v))throw new g.ErrnoError(10);c.node_ops.rmdir(c,h),g.destroyNode(v)},readdir:a=>{var s=g.lookupPath(a,{follow:!0}),c=s.node;if(!c.node_ops.readdir)throw new g.ErrnoError(54);return c.node_ops.readdir(c)},unlink:a=>{var s=g.lookupPath(a,{parent:!0}),c=s.node;if(!c)throw new g.ErrnoError(44);var h=le.basename(a),v=g.lookupNode(c,h),w=g.mayDelete(c,h,!1);if(w)throw new g.ErrnoError(w);if(!c.node_ops.unlink)throw new g.ErrnoError(63);if(g.isMountpoint(v))throw new g.ErrnoError(10);c.node_ops.unlink(c,h),g.destroyNode(v)},readlink:a=>{var s=g.lookupPath(a),c=s.node;if(!c)throw new g.ErrnoError(44);if(!c.node_ops.readlink)throw new g.ErrnoError(28);return it.resolve(g.getPath(c.parent),c.node_ops.readlink(c))},stat:(a,s)=>{var c=g.lookupPath(a,{follow:!s}),h=c.node;if(!h)throw new g.ErrnoError(44);if(!h.node_ops.getattr)throw new g.ErrnoError(63);return h.node_ops.getattr(h)},lstat:a=>g.stat(a,!0),chmod:(a,s,c)=>{var h;if(typeof a=="string"){var v=g.lookupPath(a,{follow:!c});h=v.node}else h=a;if(!h.node_ops.setattr)throw new g.ErrnoError(63);h.node_ops.setattr(h,{mode:s&4095|h.mode&-4096,timestamp:Date.now()})},lchmod:(a,s)=>{g.chmod(a,s,!0)},fchmod:(a,s)=>{var c=g.getStream(a);if(!c)throw new g.ErrnoError(8);g.chmod(c.node,s)},chown:(a,s,c,h)=>{var v;if(typeof a=="string"){var w=g.lookupPath(a,{follow:!h});v=w.node}else v=a;if(!v.node_ops.setattr)throw new g.ErrnoError(63);v.node_ops.setattr(v,{timestamp:Date.now()})},lchown:(a,s,c)=>{g.chown(a,s,c,!0)},fchown:(a,s,c)=>{var h=g.getStream(a);if(!h)throw new g.ErrnoError(8);g.chown(h.node,s,c)},truncate:(a,s)=>{if(s<0)throw new g.ErrnoError(28);var c;if(typeof a=="string"){var h=g.lookupPath(a,{follow:!0});c=h.node}else c=a;if(!c.node_ops.setattr)throw new g.ErrnoError(63);if(g.isDir(c.mode))throw new g.ErrnoError(31);if(!g.isFile(c.mode))throw new g.ErrnoError(28);var v=g.nodePermissions(c,"w");if(v)throw new g.ErrnoError(v);c.node_ops.setattr(c,{size:s,timestamp:Date.now()})},ftruncate:(a,s)=>{var c=g.getStream(a);if(!c)throw new g.ErrnoError(8);if(!(c.flags&2097155))throw new g.ErrnoError(28);g.truncate(c.node,s)},utime:(a,s,c)=>{var h=g.lookupPath(a,{follow:!0}),v=h.node;v.node_ops.setattr(v,{timestamp:Math.max(s,c)})},open:(a,s,c)=>{if(a==="")throw new g.ErrnoError(44);s=typeof s=="string"?g.modeStringToFlags(s):s,c=typeof c>"u"?438:c,s&64?c=c&4095|32768:c=0;var h;if(typeof a=="object")h=a;else{a=le.normalize(a);try{var v=g.lookupPath(a,{follow:!(s&131072)});h=v.node}catch{}}var w=!1;if(s&64)if(h){if(s&128)throw new g.ErrnoError(20)}else h=g.mknod(a,c,0),w=!0;if(!h)throw new g.ErrnoError(44);if(g.isChrdev(h.mode)&&(s&=-513),s&65536&&!g.isDir(h.mode))throw new g.ErrnoError(54);if(!w){var _=g.mayOpen(h,s);if(_)throw new g.ErrnoError(_)}s&512&&!w&&g.truncate(h,0),s&=-131713;var b=g.createStream({node:h,path:g.getPath(h),flags:s,seekable:!0,position:0,stream_ops:h.stream_ops,ungotten:[],error:!1});return b.stream_ops.open&&b.stream_ops.open(b),r.logReadFiles&&!(s&1)&&(g.readFiles||(g.readFiles={}),a in g.readFiles||(g.readFiles[a]=1)),b},close:a=>{if(g.isClosed(a))throw new g.ErrnoError(8);a.getdents&&(a.getdents=null);try{a.stream_ops.close&&a.stream_ops.close(a)}catch(s){throw s}finally{g.closeStream(a.fd)}a.fd=null},isClosed:a=>a.fd===null,llseek:(a,s,c)=>{if(g.isClosed(a))throw new g.ErrnoError(8);if(!a.seekable||!a.stream_ops.llseek)throw new g.ErrnoError(70);if(c!=0&&c!=1&&c!=2)throw new g.ErrnoError(28);return a.position=a.stream_ops.llseek(a,s,c),a.ungotten=[],a.position},read:(a,s,c,h,v)=>{if(h<0||v<0)throw new g.ErrnoError(28);if(g.isClosed(a))throw new g.ErrnoError(8);if((a.flags&2097155)===1)throw new g.ErrnoError(8);if(g.isDir(a.node.mode))throw new g.ErrnoError(31);if(!a.stream_ops.read)throw new g.ErrnoError(28);var w=typeof v<"u";if(!w)v=a.position;else if(!a.seekable)throw new g.ErrnoError(70);var _=a.stream_ops.read(a,s,c,h,v);return w||(a.position+=_),_},write:(a,s,c,h,v,w)=>{if(h<0||v<0)throw new g.ErrnoError(28);if(g.isClosed(a))throw new g.ErrnoError(8);if(!(a.flags&2097155))throw new g.ErrnoError(8);if(g.isDir(a.node.mode))throw new g.ErrnoError(31);if(!a.stream_ops.write)throw new g.ErrnoError(28);a.seekable&&a.flags&1024&&g.llseek(a,0,2);var _=typeof v<"u";if(!_)v=a.position;else if(!a.seekable)throw new g.ErrnoError(70);var b=a.stream_ops.write(a,s,c,h,v,w);return _||(a.position+=b),b},allocate:(a,s,c)=>{if(g.isClosed(a))throw new g.ErrnoError(8);if(s<0||c<=0)throw new g.ErrnoError(28);if(!(a.flags&2097155))throw new g.ErrnoError(8);if(!g.isFile(a.node.mode)&&!g.isDir(a.node.mode))throw new g.ErrnoError(43);if(!a.stream_ops.allocate)throw new g.ErrnoError(138);a.stream_ops.allocate(a,s,c)},mmap:(a,s,c,h,v)=>{if(h&2&&!(v&2)&&(a.flags&2097155)!==2)throw new g.ErrnoError(2);if((a.flags&2097155)===1)throw new g.ErrnoError(2);if(!a.stream_ops.mmap)throw new g.ErrnoError(43);return a.stream_ops.mmap(a,s,c,h,v)},msync:(a,s,c,h,v)=>!a||!a.stream_ops.msync?0:a.stream_ops.msync(a,s,c,h,v),munmap:a=>0,ioctl:(a,s,c)=>{if(!a.stream_ops.ioctl)throw new g.ErrnoError(59);return a.stream_ops.ioctl(a,s,c)},readFile:(a,s={})=>{if(s.flags=s.flags||0,s.encoding=s.encoding||"binary",s.encoding!=="utf8"&&s.encoding!=="binary")throw new Error('Invalid encoding type "'+s.encoding+'"');var c,h=g.open(a,s.flags),v=g.stat(a),w=v.size,_=new Uint8Array(w);return g.read(h,_,0,w,0),s.encoding==="utf8"?c=Ce(_,0):s.encoding==="binary"&&(c=_),g.close(h),c},writeFile:(a,s,c={})=>{c.flags=c.flags||577;var h=g.open(a,c.flags,c.mode);if(typeof s=="string"){var v=new Uint8Array(ve(s)+1),w=ge(s,v,0,v.length);g.write(h,v,0,w,void 0,c.canOwn)}else if(ArrayBuffer.isView(s))g.write(h,s,0,s.byteLength,void 0,c.canOwn);else throw new Error("Unsupported data type");g.close(h)},cwd:()=>g.currentPath,chdir:a=>{var s=g.lookupPath(a,{follow:!0});if(s.node===null)throw new g.ErrnoError(44);if(!g.isDir(s.node.mode))throw new g.ErrnoError(54);var c=g.nodePermissions(s.node,"x");if(c)throw new g.ErrnoError(c);g.currentPath=s.path},createDefaultDirectories:()=>{g.mkdir("/tmp"),g.mkdir("/home"),g.mkdir("/home/web_user")},createDefaultDevices:()=>{g.mkdir("/dev"),g.registerDevice(g.makedev(1,3),{read:()=>0,write:(s,c,h,v,w)=>v}),g.mkdev("/dev/null",g.makedev(1,3)),Ft.register(g.makedev(5,0),Ft.default_tty_ops),Ft.register(g.makedev(6,0),Ft.default_tty1_ops),g.mkdev("/dev/tty",g.makedev(5,0)),g.mkdev("/dev/tty1",g.makedev(6,0));var a=Pr();g.createDevice("/dev","random",a),g.createDevice("/dev","urandom",a),g.mkdir("/dev/shm"),g.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{g.mkdir("/proc");var a=g.mkdir("/proc/self");g.mkdir("/proc/self/fd"),g.mount({mount:()=>{var s=g.createNode(a,"fd",16895,73);return s.node_ops={lookup:(c,h)=>{var v=+h,w=g.getStream(v);if(!w)throw new g.ErrnoError(8);var _={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>w.path}};return _.parent=_,_}},s}},{},"/proc/self/fd")},createStandardStreams:()=>{r.stdin?g.createDevice("/dev","stdin",r.stdin):g.symlink("/dev/tty","/dev/stdin"),r.stdout?g.createDevice("/dev","stdout",null,r.stdout):g.symlink("/dev/tty","/dev/stdout"),r.stderr?g.createDevice("/dev","stderr",null,r.stderr):g.symlink("/dev/tty1","/dev/stderr"),g.open("/dev/stdin",0),g.open("/dev/stdout",1),g.open("/dev/stderr",1)},ensureErrnoError:()=>{g.ErrnoError||(g.ErrnoError=function(s,c){this.node=c,this.setErrno=function(h){this.errno=h},this.setErrno(s),this.message="FS error"},g.ErrnoError.prototype=new Error,g.ErrnoError.prototype.constructor=g.ErrnoError,[44].forEach(a=>{g.genericErrors[a]=new g.ErrnoError(a),g.genericErrors[a].stack="<generic error, no stack>"}))},staticInit:()=>{g.ensureErrnoError(),g.nameTable=new Array(4096),g.mount(K,{},"/"),g.createDefaultDirectories(),g.createDefaultDevices(),g.createSpecialDirectories(),g.filesystems={MEMFS:K}},init:(a,s,c)=>{g.init.initialized=!0,g.ensureErrnoError(),r.stdin=a||r.stdin,r.stdout=s||r.stdout,r.stderr=c||r.stderr,g.createStandardStreams()},quit:()=>{g.init.initialized=!1;for(var a=0;a<g.streams.length;a++){var s=g.streams[a];s&&g.close(s)}},getMode:(a,s)=>{var c=0;return a&&(c|=365),s&&(c|=146),c},findObject:(a,s)=>{var c=g.analyzePath(a,s);return c.exists?c.object:null},analyzePath:(a,s)=>{try{var c=g.lookupPath(a,{follow:!s});a=c.path}catch{}var h={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var c=g.lookupPath(a,{parent:!0});h.parentExists=!0,h.parentPath=c.path,h.parentObject=c.node,h.name=le.basename(a),c=g.lookupPath(a,{follow:!s}),h.exists=!0,h.path=c.path,h.object=c.node,h.name=c.node.name,h.isRoot=c.path==="/"}catch(v){h.error=v.errno}return h},createPath:(a,s,c,h)=>{a=typeof a=="string"?a:g.getPath(a);for(var v=s.split("/").reverse();v.length;){var w=v.pop();if(w){var _=le.join2(a,w);try{g.mkdir(_)}catch{}a=_}}return _},createFile:(a,s,c,h,v)=>{var w=le.join2(typeof a=="string"?a:g.getPath(a),s),_=g.getMode(h,v);return g.create(w,_)},createDataFile:(a,s,c,h,v,w)=>{var _=s;a&&(a=typeof a=="string"?a:g.getPath(a),_=s?le.join2(a,s):a);var b=g.getMode(h,v),E=g.create(_,b);if(c){if(typeof c=="string"){for(var k=new Array(c.length),U=0,I=c.length;U<I;++U)k[U]=c.charCodeAt(U);c=k}g.chmod(E,b|146);var D=g.open(E,577);g.write(D,c,0,c.length,0,w),g.close(D),g.chmod(E,b)}return E},createDevice:(a,s,c,h)=>{var v=le.join2(typeof a=="string"?a:g.getPath(a),s),w=g.getMode(!!c,!!h);g.createDevice.major||(g.createDevice.major=64);var _=g.makedev(g.createDevice.major++,0);return g.registerDevice(_,{open:b=>{b.seekable=!1},close:b=>{h&&h.buffer&&h.buffer.length&&h(10)},read:(b,E,k,U,I)=>{for(var D=0,H=0;H<U;H++){var Z;try{Z=c()}catch{throw new g.ErrnoError(29)}if(Z===void 0&&D===0)throw new g.ErrnoError(6);if(Z==null)break;D++,E[k+H]=Z}return D&&(b.node.timestamp=Date.now()),D},write:(b,E,k,U,I)=>{for(var D=0;D<U;D++)try{h(E[k+D])}catch{throw new g.ErrnoError(29)}return U&&(b.node.timestamp=Date.now()),D}}),g.mkdev(v,w,_)},forceLoadFile:a=>{if(a.isDevice||a.isFolder||a.link||a.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(S)try{a.contents=uo(S(a.url),!0),a.usedBytes=a.contents.length}catch{throw new g.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:(a,s,c,h,v)=>{function w(){this.lengthKnown=!1,this.chunks=[]}if(w.prototype.get=function(H){if(!(H>this.length-1||H<0)){var Z=H%this.chunkSize,pe=H/this.chunkSize|0;return this.getter(pe)[Z]}},w.prototype.setDataGetter=function(H){this.getter=H},w.prototype.cacheLength=function(){var H=new XMLHttpRequest;if(H.open("HEAD",c,!1),H.send(null),!(H.status>=200&&H.status<300||H.status===304))throw new Error("Couldn't load "+c+". Status: "+H.status);var Z=Number(H.getResponseHeader("Content-length")),pe,Me=(pe=H.getResponseHeader("Accept-Ranges"))&&pe==="bytes",Fe=(pe=H.getResponseHeader("Content-Encoding"))&&pe==="gzip",R=1024*1024;Me||(R=Z);var $=(be,ot)=>{if(be>ot)throw new Error("invalid range ("+be+", "+ot+") or no bytes requested!");if(ot>Z-1)throw new Error("only "+Z+" bytes available! programmer error!");var Be=new XMLHttpRequest;if(Be.open("GET",c,!1),Z!==R&&Be.setRequestHeader("Range","bytes="+be+"-"+ot),Be.responseType="arraybuffer",Be.overrideMimeType&&Be.overrideMimeType("text/plain; charset=x-user-defined"),Be.send(null),!(Be.status>=200&&Be.status<300||Be.status===304))throw new Error("Couldn't load "+c+". Status: "+Be.status);return Be.response!==void 0?new Uint8Array(Be.response||[]):uo(Be.responseText||"",!0)},ze=this;ze.setDataGetter(be=>{var ot=be*R,Be=(be+1)*R-1;if(Be=Math.min(Be,Z-1),typeof ze.chunks[be]>"u"&&(ze.chunks[be]=$(ot,Be)),typeof ze.chunks[be]>"u")throw new Error("doXHR failed!");return ze.chunks[be]}),(Fe||!Z)&&(R=Z=1,Z=this.getter(0).length,R=Z,q("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=Z,this._chunkSize=R,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!p)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var _=new w;Object.defineProperties(_,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var b={isDevice:!1,contents:_}}else var b={isDevice:!1,url:c};var E=g.createFile(a,s,b,h,v);b.contents?E.contents=b.contents:b.url&&(E.contents=null,E.url=b.url),Object.defineProperties(E,{usedBytes:{get:function(){return this.contents.length}}});var k={},U=Object.keys(E.stream_ops);U.forEach(D=>{var H=E.stream_ops[D];k[D]=function(){return g.forceLoadFile(E),H.apply(null,arguments)}});function I(D,H,Z,pe,Me){var Fe=D.node.contents;if(Me>=Fe.length)return 0;var R=Math.min(Fe.length-Me,pe);if(Fe.slice)for(var $=0;$<R;$++)H[Z+$]=Fe[Me+$];else for(var $=0;$<R;$++)H[Z+$]=Fe.get(Me+$);return R}return k.read=(D,H,Z,pe,Me)=>(g.forceLoadFile(E),I(D,H,Z,pe,Me)),k.mmap=(D,H,Z,pe,Me)=>{g.forceLoadFile(E);var Fe=kr(H);if(!Fe)throw new g.ErrnoError(48);return I(D,Ne,Fe,H,Z),{ptr:Fe,allocated:!0}},E.stream_ops=k,E},createPreloadedFile:(a,s,c,h,v,w,_,b,E,k)=>{var U=s?it.resolve(le.join2(a,s)):a;function I(D){function H(Z){k&&k(),b||g.createDataFile(a,s,Z,h,v,E),w&&w(),Tr()}Browser.handledByPreloadPlugin(D,U,H,()=>{_&&_(),Tr()})||H(D)}lr(),typeof c=="string"?oi(c,D=>I(D),_):I(c)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(a,s,c)=>{s=s||(()=>{}),c=c||(()=>{});var h=g.indexedDB();try{var v=h.open(g.DB_NAME(),g.DB_VERSION)}catch(w){return c(w)}v.onupgradeneeded=()=>{q("creating db");var w=v.result;w.createObjectStore(g.DB_STORE_NAME)},v.onsuccess=()=>{var w=v.result,_=w.transaction([g.DB_STORE_NAME],"readwrite"),b=_.objectStore(g.DB_STORE_NAME),E=0,k=0,U=a.length;function I(){k==0?s():c()}a.forEach(D=>{var H=b.put(g.analyzePath(D).object.contents,D);H.onsuccess=()=>{E++,E+k==U&&I()},H.onerror=()=>{k++,E+k==U&&I()}}),_.onerror=c},v.onerror=c},loadFilesFromDB:(a,s,c)=>{s=s||(()=>{}),c=c||(()=>{});var h=g.indexedDB();try{var v=h.open(g.DB_NAME(),g.DB_VERSION)}catch(w){return c(w)}v.onupgradeneeded=c,v.onsuccess=()=>{var w=v.result;try{var _=w.transaction([g.DB_STORE_NAME],"readonly")}catch(D){c(D);return}var b=_.objectStore(g.DB_STORE_NAME),E=0,k=0,U=a.length;function I(){k==0?s():c()}a.forEach(D=>{var H=b.get(D);H.onsuccess=()=>{g.analyzePath(D).exists&&g.unlink(D),g.createDataFile(le.dirname(D),le.basename(D),H.result,!0,!0,!0),E++,E+k==U&&I()},H.onerror=()=>{k++,E+k==U&&I()}}),_.onerror=c},v.onerror=c}},ce={DEFAULT_POLLMASK:5,calculateAt:function(a,s,c){if(le.isAbs(s))return s;var h;if(a===-100)h=g.cwd();else{var v=g.getStream(a);if(!v)throw new g.ErrnoError(8);h=v.path}if(s.length==0){if(!c)throw new g.ErrnoError(44);return h}return le.join2(h,s)},doStat:function(a,s,c){try{var h=a(s)}catch(v){if(v&&v.node&&le.normalize(s)!==le.normalize(g.getPath(v.node)))return-54;throw v}return L[c>>2]=h.dev,L[c+4>>2]=0,L[c+8>>2]=h.ino,L[c+12>>2]=h.mode,L[c+16>>2]=h.nlink,L[c+20>>2]=h.uid,L[c+24>>2]=h.gid,L[c+28>>2]=h.rdev,L[c+32>>2]=0,gt=[h.size>>>0,(Ie=h.size,+Math.abs(Ie)>=1?Ie>0?(Math.min(+Math.floor(Ie/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Ie-+(~~Ie>>>0))/4294967296)>>>0:0)],L[c+40>>2]=gt[0],L[c+44>>2]=gt[1],L[c+48>>2]=4096,L[c+52>>2]=h.blocks,L[c+56>>2]=h.atime.getTime()/1e3|0,L[c+60>>2]=0,L[c+64>>2]=h.mtime.getTime()/1e3|0,L[c+68>>2]=0,L[c+72>>2]=h.ctime.getTime()/1e3|0,L[c+76>>2]=0,gt=[h.ino>>>0,(Ie=h.ino,+Math.abs(Ie)>=1?Ie>0?(Math.min(+Math.floor(Ie/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Ie-+(~~Ie>>>0))/4294967296)>>>0:0)],L[c+80>>2]=gt[0],L[c+84>>2]=gt[1],0},doMsync:function(a,s,c,h,v){var w=Ye.slice(a,a+c);g.msync(s,w,v,c,h)},varargs:void 0,get:function(){ce.varargs+=4;var a=L[ce.varargs-4>>2];return a},getStr:function(a){var s=ue(a);return s},getStreamFromFD:function(a){var s=g.getStream(a);if(!s)throw new g.ErrnoError(8);return s}};function ii(a,s){try{return a=ce.getStr(a),g.chmod(a,s),0}catch(c){if(typeof g>"u"||!(c instanceof g.ErrnoError))throw c;return-c.errno}}function ai(a,s,c,h){try{if(s=ce.getStr(s),s=ce.calculateAt(a,s),c&-8)return-28;var v=g.lookupPath(s,{follow:!0}),w=v.node;if(!w)return-44;var _="";return c&4&&(_+="r"),c&2&&(_+="w"),c&1&&(_+="x"),_&&g.nodePermissions(w,_)?-2:0}catch(b){if(typeof g>"u"||!(b instanceof g.ErrnoError))throw b;return-b.errno}}function zn(a){return L[za()>>2]=a,a}function Wn(a,s,c){ce.varargs=c;try{var h=ce.getStreamFromFD(a);switch(s){case 0:{var v=ce.get();if(v<0)return-28;var w;return w=g.createStream(h,v),w.fd}case 1:case 2:return 0;case 3:return h.flags;case 4:{var v=ce.get();return h.flags|=v,0}case 5:{var v=ce.get(),_=0;return ct[v+_>>1]=2,0}case 6:case 7:return 0;case 16:case 8:return-28;case 9:return zn(28),-1;default:return-28}}catch(b){if(typeof g>"u"||!(b instanceof g.ErrnoError))throw b;return-b.errno}}function Xn(a,s){try{var c=ce.getStreamFromFD(a);return ce.doStat(g.stat,c.path,s)}catch(h){if(typeof g>"u"||!(h instanceof g.ErrnoError))throw h;return-h.errno}}function $n(a,s,c){ce.varargs=c;try{var h=ce.getStreamFromFD(a);switch(s){case 21509:case 21505:return h.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return h.tty?0:-59;case 21519:{if(!h.tty)return-59;var v=ce.get();return L[v>>2]=0,0}case 21520:return h.tty?-28:-59;case 21531:{var v=ce.get();return g.ioctl(h,s,v)}case 21523:return h.tty?0:-59;case 21524:return h.tty?0:-59;default:Ct("bad ioctl syscall "+s)}}catch(w){if(typeof g>"u"||!(w instanceof g.ErrnoError))throw w;return-w.errno}}function Yn(a,s){try{return a=ce.getStr(a),ce.doStat(g.lstat,a,s)}catch(c){if(typeof g>"u"||!(c instanceof g.ErrnoError))throw c;return-c.errno}}function Zn(a,s,c,h){try{s=ce.getStr(s);var v=h&256,w=h&4096;return h=h&-4353,s=ce.calculateAt(a,s,w),ce.doStat(v?g.lstat:g.stat,s,c)}catch(_){if(typeof g>"u"||!(_ instanceof g.ErrnoError))throw _;return-_.errno}}function si(a,s,c,h){ce.varargs=h;try{s=ce.getStr(s),s=ce.calculateAt(a,s);var v=h?ce.get():0;return g.open(s,c,v).fd}catch(w){if(typeof g>"u"||!(w instanceof g.ErrnoError))throw w;return-w.errno}}function ui(a,s){try{return a=ce.getStr(a),ce.doStat(g.stat,a,s)}catch(c){if(typeof g>"u"||!(c instanceof g.ErrnoError))throw c;return-c.errno}}function li(a,s,c,h,v){}function Ar(a){switch(a){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+a)}}function ci(){for(var a=new Array(256),s=0;s<256;++s)a[s]=String.fromCharCode(s);Or=a}var Or=void 0;function G(a){for(var s="",c=a;Ye[c];)s+=Or[Ye[c++]];return s}var Y={},Je={},qn={},_l=48,bl=57;function jn(a){if(a===void 0)return"_unknown";a=a.replace(/[^a-zA-Z0-9_]/g,"$");var s=a.charCodeAt(0);return s>=_l&&s<=bl?"_"+a:a}function Kn(a,s){return a=jn(a),new Function("body","return function "+a+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(s)}function fi(a,s){var c=Kn(s,function(h){this.name=s,this.message=h;var v=new Error(h).stack;v!==void 0&&(this.stack=this.toString()+`
`+v.replace(/^Error(:[^\n]*)?\n/,""))});return c.prototype=Object.create(a.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},c}var Rr=void 0;function he(a){throw new Rr(a)}var xa=void 0;function Qn(a){throw new xa(a)}function cr(a,s,c){a.forEach(function(b){qn[b]=s});function h(b){var E=c(b);E.length!==a.length&&Qn("Mismatched type converter count");for(var k=0;k<a.length;++k)Pt(a[k],E[k])}var v=new Array(s.length),w=[],_=0;s.forEach((b,E)=>{Je.hasOwnProperty(b)?v[E]=Je[b]:(w.push(b),Y.hasOwnProperty(b)||(Y[b]=[]),Y[b].push(()=>{v[E]=Je[b],++_,_===w.length&&h(v)}))}),w.length===0&&h(v)}function Pt(a,s,c={}){if(!("argPackAdvance"in s))throw new TypeError("registerType registeredInstance requires argPackAdvance");var h=s.name;if(a||he('type "'+h+'" must have a positive integer typeid pointer'),Je.hasOwnProperty(a)){if(c.ignoreDuplicateRegistrations)return;he("Cannot register type '"+h+"' twice")}if(Je[a]=s,delete qn[a],Y.hasOwnProperty(a)){var v=Y[a];delete Y[a],v.forEach(w=>w())}}function Sl(a,s,c,h,v){var w=Ar(c);s=G(s),Pt(a,{name:s,fromWireType:function(_){return!!_},toWireType:function(_,b){return b?h:v},argPackAdvance:8,readValueFromPointer:function(_){var b;if(c===1)b=Ne;else if(c===2)b=ct;else if(c===4)b=L;else throw new TypeError("Unknown boolean type size: "+s);return this.fromWireType(b[_>>w])},destructorFunction:null})}function Tl(a){if(!(this instanceof Zt)||!(a instanceof Zt))return!1;for(var s=this.$$.ptrType.registeredClass,c=this.$$.ptr,h=a.$$.ptrType.registeredClass,v=a.$$.ptr;s.baseClass;)c=s.upcast(c),s=s.baseClass;for(;h.baseClass;)v=h.upcast(v),h=h.baseClass;return s===h&&c===v}function El(a){return{count:a.count,deleteScheduled:a.deleteScheduled,preservePointerOnDelete:a.preservePointerOnDelete,ptr:a.ptr,ptrType:a.ptrType,smartPtr:a.smartPtr,smartPtrType:a.smartPtrType}}function hi(a){function s(c){return c.$$.ptrType.registeredClass.name}he(s(a)+" instance already deleted")}var pi=!1;function Ca(a){}function xl(a){a.smartPtr?a.smartPtrType.rawDestructor(a.smartPtr):a.ptrType.registeredClass.rawDestructor(a.ptr)}function Pa(a){a.count.value-=1;var s=a.count.value===0;s&&xl(a)}function ka(a,s,c){if(s===c)return a;if(c.baseClass===void 0)return null;var h=ka(a,s,c.baseClass);return h===null?null:c.downcast(h)}var Aa={};function Cl(){return Object.keys(en).length}function Pl(){var a=[];for(var s in en)en.hasOwnProperty(s)&&a.push(en[s]);return a}var Qr=[];function di(){for(;Qr.length;){var a=Qr.pop();a.$$.deleteScheduled=!1,a.delete()}}var Jr=void 0;function kl(a){Jr=a,Qr.length&&Jr&&Jr(di)}function Al(){r.getInheritedInstanceCount=Cl,r.getLiveInheritedInstances=Pl,r.flushPendingDeletes=di,r.setDelayFunction=kl}var en={};function Ol(a,s){for(s===void 0&&he("ptr should not be undefined");a.baseClass;)s=a.upcast(s),a=a.baseClass;return s}function Rl(a,s){return s=Ol(a,s),en[s]}function Jn(a,s){(!s.ptrType||!s.ptr)&&Qn("makeClassHandle requires ptr and ptrType");var c=!!s.smartPtrType,h=!!s.smartPtr;return c!==h&&Qn("Both smartPtrType and smartPtr must be specified"),s.count={value:1},tn(Object.create(a,{$$:{value:s}}))}function Dl(a){var s=this.getPointee(a);if(!s)return this.destructor(a),null;var c=Rl(this.registeredClass,s);if(c!==void 0){if(c.$$.count.value===0)return c.$$.ptr=s,c.$$.smartPtr=a,c.clone();var h=c.clone();return this.destructor(a),h}function v(){return this.isSmartPointer?Jn(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:s,smartPtrType:this,smartPtr:a}):Jn(this.registeredClass.instancePrototype,{ptrType:this,ptr:a})}var w=this.registeredClass.getActualType(s),_=Aa[w];if(!_)return v.call(this);var b;this.isConst?b=_.constPointerType:b=_.pointerType;var E=ka(s,this.registeredClass,b.registeredClass);return E===null?v.call(this):this.isSmartPointer?Jn(b.registeredClass.instancePrototype,{ptrType:b,ptr:E,smartPtrType:this,smartPtr:a}):Jn(b.registeredClass.instancePrototype,{ptrType:b,ptr:E})}function tn(a){return typeof FinalizationRegistry>"u"?(tn=s=>s,a):(pi=new FinalizationRegistry(s=>{Pa(s.$$)}),tn=s=>{var c=s.$$,h=!!c.smartPtr;if(h){var v={$$:c};pi.register(s,v,s)}return s},Ca=s=>pi.unregister(s),tn(a))}function Ml(){if(this.$$.ptr||hi(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var a=tn(Object.create(Object.getPrototypeOf(this),{$$:{value:El(this.$$)}}));return a.$$.count.value+=1,a.$$.deleteScheduled=!1,a}function Fl(){this.$$.ptr||hi(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&he("Object already scheduled for deletion"),Ca(this),Pa(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Bl(){return!this.$$.ptr}function Ll(){return this.$$.ptr||hi(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&he("Object already scheduled for deletion"),Qr.push(this),Qr.length===1&&Jr&&Jr(di),this.$$.deleteScheduled=!0,this}function Ul(){Zt.prototype.isAliasOf=Tl,Zt.prototype.clone=Ml,Zt.prototype.delete=Fl,Zt.prototype.isDeleted=Bl,Zt.prototype.deleteLater=Ll}function Zt(){}function vi(a,s,c){if(a[s].overloadTable===void 0){var h=a[s];a[s]=function(){return a[s].overloadTable.hasOwnProperty(arguments.length)||he("Function '"+c+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+a[s].overloadTable+")!"),a[s].overloadTable[arguments.length].apply(this,arguments)},a[s].overloadTable=[],a[s].overloadTable[h.argCount]=h}}function Oa(a,s,c){r.hasOwnProperty(a)?((c===void 0||r[a].overloadTable!==void 0&&r[a].overloadTable[c]!==void 0)&&he("Cannot register public name '"+a+"' twice"),vi(r,a,a),r.hasOwnProperty(c)&&he("Cannot register multiple overloads of a function with the same number of arguments ("+c+")!"),r[a].overloadTable[c]=s):(r[a]=s,c!==void 0&&(r[a].numArguments=c))}function Il(a,s,c,h,v,w,_,b){this.name=a,this.constructor=s,this.instancePrototype=c,this.rawDestructor=h,this.baseClass=v,this.getActualType=w,this.upcast=_,this.downcast=b,this.pureVirtualFunctions=[]}function gi(a,s,c){for(;s!==c;)s.upcast||he("Expected null or instance of "+c.name+", got an instance of "+s.name),a=s.upcast(a),s=s.baseClass;return a}function Gl(a,s){if(s===null)return this.isReference&&he("null is not a valid "+this.name),0;s.$$||he('Cannot pass "'+bi(s)+'" as a '+this.name),s.$$.ptr||he("Cannot pass deleted object as a pointer of type "+this.name);var c=s.$$.ptrType.registeredClass,h=gi(s.$$.ptr,c,this.registeredClass);return h}function Nl(a,s){var c;if(s===null)return this.isReference&&he("null is not a valid "+this.name),this.isSmartPointer?(c=this.rawConstructor(),a!==null&&a.push(this.rawDestructor,c),c):0;s.$$||he('Cannot pass "'+bi(s)+'" as a '+this.name),s.$$.ptr||he("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&s.$$.ptrType.isConst&&he("Cannot convert argument of type "+(s.$$.smartPtrType?s.$$.smartPtrType.name:s.$$.ptrType.name)+" to parameter type "+this.name);var h=s.$$.ptrType.registeredClass;if(c=gi(s.$$.ptr,h,this.registeredClass),this.isSmartPointer)switch(s.$$.smartPtr===void 0&&he("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:s.$$.smartPtrType===this?c=s.$$.smartPtr:he("Cannot convert argument of type "+(s.$$.smartPtrType?s.$$.smartPtrType.name:s.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:c=s.$$.smartPtr;break;case 2:if(s.$$.smartPtrType===this)c=s.$$.smartPtr;else{var v=s.clone();c=this.rawShare(c,Ve.toHandle(function(){v.delete()})),a!==null&&a.push(this.rawDestructor,c)}break;default:he("Unsupporting sharing policy")}return c}function Hl(a,s){if(s===null)return this.isReference&&he("null is not a valid "+this.name),0;s.$$||he('Cannot pass "'+bi(s)+'" as a '+this.name),s.$$.ptr||he("Cannot pass deleted object as a pointer of type "+this.name),s.$$.ptrType.isConst&&he("Cannot convert argument of type "+s.$$.ptrType.name+" to parameter type "+this.name);var c=s.$$.ptrType.registeredClass,h=gi(s.$$.ptr,c,this.registeredClass);return h}function eo(a){return this.fromWireType(oe[a>>2])}function Vl(a){return this.rawGetPointee&&(a=this.rawGetPointee(a)),a}function zl(a){this.rawDestructor&&this.rawDestructor(a)}function Wl(a){a!==null&&a.delete()}function Xl(){Bt.prototype.getPointee=Vl,Bt.prototype.destructor=zl,Bt.prototype.argPackAdvance=8,Bt.prototype.readValueFromPointer=eo,Bt.prototype.deleteObject=Wl,Bt.prototype.fromWireType=Dl}function Bt(a,s,c,h,v,w,_,b,E,k,U){this.name=a,this.registeredClass=s,this.isReference=c,this.isConst=h,this.isSmartPointer=v,this.pointeeType=w,this.sharingPolicy=_,this.rawGetPointee=b,this.rawConstructor=E,this.rawShare=k,this.rawDestructor=U,!v&&s.baseClass===void 0?h?(this.toWireType=Gl,this.destructorFunction=null):(this.toWireType=Hl,this.destructorFunction=null):this.toWireType=Nl}function $l(a,s,c){r.hasOwnProperty(a)||Qn("Replacing nonexistant public symbol"),r[a].overloadTable!==void 0&&c!==void 0?r[a].overloadTable[c]=s:(r[a]=s,r[a].argCount=c)}function Yl(a,s,c){var h=r["dynCall_"+a];return c&&c.length?h.apply(null,[s].concat(c)):h.call(null,s)}function Zl(a,s,c){return a.includes("j")?Yl(a,s,c):Cr(s).apply(null,c)}function ql(a,s){var c=[];return function(){return c.length=0,Object.assign(c,arguments),Zl(a,s,c)}}function fr(a,s){a=G(a);function c(){return a.includes("j")?ql(a,s):Cr(s)}var h=c();return typeof h!="function"&&he("unknown function pointer with signature "+a+": "+s),h}var Ra=void 0;function Da(a){var s=Wa(a),c=G(s);return It(s),c}function to(a,s){var c=[],h={};function v(w){if(!h[w]&&!Je[w]){if(qn[w]){qn[w].forEach(v);return}c.push(w),h[w]=!0}}throw s.forEach(v),new Ra(a+": "+c.map(Da).join([", "]))}function jl(a,s,c,h,v,w,_,b,E,k,U,I,D){U=G(U),w=fr(v,w),b&&(b=fr(_,b)),k&&(k=fr(E,k)),D=fr(I,D);var H=jn(U);Oa(H,function(){to("Cannot construct "+U+" due to unbound types",[h])}),cr([a,s,c],h?[h]:[],function(Z){Z=Z[0];var pe,Me;h?(pe=Z.registeredClass,Me=pe.instancePrototype):Me=Zt.prototype;var Fe=Kn(H,function(){if(Object.getPrototypeOf(this)!==R)throw new Rr("Use 'new' to construct "+U);if($.constructor_body===void 0)throw new Rr(U+" has no accessible constructor");var Be=$.constructor_body[arguments.length];if(Be===void 0)throw new Rr("Tried to invoke ctor of "+U+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys($.constructor_body).toString()+") parameters instead!");return Be.apply(this,arguments)}),R=Object.create(Me,{constructor:{value:Fe}});Fe.prototype=R;var $=new Il(U,Fe,R,D,pe,w,b,k),ze=new Bt(U,$,!0,!1,!1),be=new Bt(U+"*",$,!1,!1,!1),ot=new Bt(U+" const*",$,!1,!0,!1);return Aa[a]={pointerType:be,constPointerType:ot},$l(H,Fe),[ze,be,ot]})}function Ma(a,s){if(!(a instanceof Function))throw new TypeError("new_ called with constructor type "+typeof a+" which is not a function");var c=Kn(a.name||"unknownFunctionName",function(){});c.prototype=a.prototype;var h=new c,v=a.apply(h,s);return v instanceof Object?v:h}function Fa(a){for(;a.length;){var s=a.pop(),c=a.pop();c(s)}}function mi(a,s,c,h,v){var w=s.length;w<2&&he("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var _=s[1]!==null&&c!==null,b=!1,E=1;E<s.length;++E)if(s[E]!==null&&s[E].destructorFunction===void 0){b=!0;break}for(var k=s[0].name!=="void",U="",I="",E=0;E<w-2;++E)U+=(E!==0?", ":"")+"arg"+E,I+=(E!==0?", ":"")+"arg"+E+"Wired";var D="return function "+jn(a)+"("+U+`) {
if (arguments.length !== `+(w-2)+`) {
throwBindingError('function `+a+" called with ' + arguments.length + ' arguments, expected "+(w-2)+` args!');
}
`;b&&(D+=`var destructors = [];
`);var H=b?"destructors":"null",Z=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],pe=[he,h,v,Fa,s[0],s[1]];_&&(D+="var thisWired = classParam.toWireType("+H+`, this);
`);for(var E=0;E<w-2;++E)D+="var arg"+E+"Wired = argType"+E+".toWireType("+H+", arg"+E+"); // "+s[E+2].name+`
`,Z.push("argType"+E),pe.push(s[E+2]);if(_&&(I="thisWired"+(I.length>0?", ":"")+I),D+=(k?"var rv = ":"")+"invoker(fn"+(I.length>0?", ":"")+I+`);
`,b)D+=`runDestructors(destructors);
`;else for(var E=_?1:2;E<s.length;++E){var Me=E===1?"thisWired":"arg"+(E-2)+"Wired";s[E].destructorFunction!==null&&(D+=Me+"_dtor("+Me+"); // "+s[E].name+`
`,Z.push(Me+"_dtor"),pe.push(s[E].destructorFunction))}k&&(D+=`var ret = retType.fromWireType(rv);
return ret;
`),D+=`}
`,Z.push(D);var Fe=Ma(Function,Z).apply(null,pe);return Fe}function yi(a,s){for(var c=[],h=0;h<a;h++)c.push(L[(s>>2)+h]);return c}function Kl(a,s,c,h,v,w,_){var b=yi(c,h);s=G(s),w=fr(v,w),cr([],[a],function(E){E=E[0];var k=E.name+"."+s;function U(){to("Cannot call "+k+" due to unbound types",b)}s.startsWith("@@")&&(s=Symbol[s.substring(2)]);var I=E.registeredClass.constructor;return I[s]===void 0?(U.argCount=c-1,I[s]=U):(vi(I,s,k),I[s].overloadTable[c-1]=U),cr([],b,function(D){var H=[D[0],null].concat(D.slice(1)),Z=mi(k,H,null,w,_);return I[s].overloadTable===void 0?(Z.argCount=c-1,I[s]=Z):I[s].overloadTable[c-1]=Z,[]}),[]})}function Ql(a,s,c,h,v,w){Oe(s>0);var _=yi(s,c);v=fr(h,v),cr([],[a],function(b){b=b[0];var E="constructor "+b.name;if(b.registeredClass.constructor_body===void 0&&(b.registeredClass.constructor_body=[]),b.registeredClass.constructor_body[s-1]!==void 0)throw new Rr("Cannot register multiple constructors with identical number of parameters ("+(s-1)+") for class '"+b.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return b.registeredClass.constructor_body[s-1]=()=>{to("Cannot construct "+b.name+" due to unbound types",_)},cr([],_,function(k){return k.splice(1,0,null),b.registeredClass.constructor_body[s-1]=mi(E,k,null,v,w),[]}),[]})}function Jl(a,s,c,h,v,w,_,b){var E=yi(c,h);s=G(s),w=fr(v,w),cr([],[a],function(k){k=k[0];var U=k.name+"."+s;s.startsWith("@@")&&(s=Symbol[s.substring(2)]),b&&k.registeredClass.pureVirtualFunctions.push(s);function I(){to("Cannot call "+U+" due to unbound types",E)}var D=k.registeredClass.instancePrototype,H=D[s];return H===void 0||H.overloadTable===void 0&&H.className!==k.name&&H.argCount===c-2?(I.argCount=c-2,I.className=k.name,D[s]=I):(vi(D,s,U),D[s].overloadTable[c-2]=I),cr([],E,function(Z){var pe=mi(U,Z,k,w,_);return D[s].overloadTable===void 0?(pe.argCount=c-2,D[s]=pe):D[s].overloadTable[c-2]=pe,[]}),[]})}var wi=[],mt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function _i(a){a>4&&--mt[a].refcount===0&&(mt[a]=void 0,wi.push(a))}function ec(){for(var a=0,s=5;s<mt.length;++s)mt[s]!==void 0&&++a;return a}function tc(){for(var a=5;a<mt.length;++a)if(mt[a]!==void 0)return mt[a];return null}function rc(){r.count_emval_handles=ec,r.get_first_emval=tc}var Ve={toValue:a=>(a||he("Cannot use deleted val. handle = "+a),mt[a].value),toHandle:a=>{switch(a){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var s=wi.length?wi.pop():mt.length;return mt[s]={refcount:1,value:a},s}}}};function nc(a,s){s=G(s),Pt(a,{name:s,fromWireType:function(c){var h=Ve.toValue(c);return _i(c),h},toWireType:function(c,h){return Ve.toHandle(h)},argPackAdvance:8,readValueFromPointer:eo,destructorFunction:null})}function oc(a,s,c){switch(s){case 0:return function(h){var v=c?Ne:Ye;return this.fromWireType(v[h])};case 1:return function(h){var v=c?ct:Dt;return this.fromWireType(v[h>>1])};case 2:return function(h){var v=c?L:oe;return this.fromWireType(v[h>>2])};default:throw new TypeError("Unknown integer type: "+a)}}function ic(a,s,c,h){var v=Ar(c);s=G(s);function w(){}w.values={},Pt(a,{name:s,constructor:w,fromWireType:function(_){return this.constructor.values[_]},toWireType:function(_,b){return b.value},argPackAdvance:8,readValueFromPointer:oc(s,v,h),destructorFunction:null}),Oa(s,w)}function ro(a,s){var c=Je[a];return c===void 0&&he(s+" has unknown type "+Da(a)),c}function ac(a,s,c){var h=ro(a,"enum");s=G(s);var v=h.constructor,w=Object.create(h.constructor.prototype,{value:{value:c},constructor:{value:Kn(h.name+"_"+s,function(){})}});v.values[c]=w,v[s]=w}function bi(a){if(a===null)return"null";var s=typeof a;return s==="object"||s==="array"||s==="function"?a.toString():""+a}function sc(a,s){switch(s){case 2:return function(c){return this.fromWireType(nt[c>>2])};case 3:return function(c){return this.fromWireType(Rn[c>>3])};default:throw new TypeError("Unknown float type: "+a)}}function uc(a,s,c){var h=Ar(c);s=G(s),Pt(a,{name:s,fromWireType:function(v){return v},toWireType:function(v,w){return w},argPackAdvance:8,readValueFromPointer:sc(s,h),destructorFunction:null})}function lc(a,s,c){switch(s){case 0:return c?function(v){return Ne[v]}:function(v){return Ye[v]};case 1:return c?function(v){return ct[v>>1]}:function(v){return Dt[v>>1]};case 2:return c?function(v){return L[v>>2]}:function(v){return oe[v>>2]};default:throw new TypeError("Unknown integer type: "+a)}}function cc(a,s,c,h,v){s=G(s);var w=Ar(c),_=I=>I;if(h===0){var b=32-8*c;_=I=>I<<b>>>b}var E=s.includes("unsigned"),k=(I,D)=>{},U;E?U=function(I,D){return k(D,this.name),D>>>0}:U=function(I,D){return k(D,this.name),D},Pt(a,{name:s,fromWireType:_,toWireType:U,argPackAdvance:8,readValueFromPointer:lc(s,w,h!==0),destructorFunction:null})}function fc(a,s,c){var h=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],v=h[s];function w(_){_=_>>2;var b=oe,E=b[_],k=b[_+1];return new v(lt,k,E)}c=G(c),Pt(a,{name:c,fromWireType:w,argPackAdvance:8,readValueFromPointer:w},{ignoreDuplicateRegistrations:!0})}function hc(a,s){s=G(s);var c=s==="std::string";Pt(a,{name:s,fromWireType:function(h){var v=oe[h>>2],w;if(c)for(var _=h+4,b=0;b<=v;++b){var E=h+4+b;if(b==v||Ye[E]==0){var k=E-_,U=ue(_,k);w===void 0?w=U:(w+=String.fromCharCode(0),w+=U),_=E+1}}else{for(var I=new Array(v),b=0;b<v;++b)I[b]=String.fromCharCode(Ye[h+4+b]);w=I.join("")}return It(h),w},toWireType:function(h,v){v instanceof ArrayBuffer&&(v=new Uint8Array(v));var w,_=typeof v=="string";_||v instanceof Uint8Array||v instanceof Uint8ClampedArray||v instanceof Int8Array||he("Cannot pass non-string to std::string"),c&&_?w=()=>ve(v):w=()=>v.length;var b=w(),E=Ut(4+b+1);if(oe[E>>2]=b,c&&_)Pe(v,E+4,b+1);else if(_)for(var k=0;k<b;++k){var U=v.charCodeAt(k);U>255&&(It(E),he("String has UTF-16 code units that do not fit in 8 bits")),Ye[E+4+k]=U}else for(var k=0;k<b;++k)Ye[E+4+k]=v[k];return h!==null&&h.push(It,E),E},argPackAdvance:8,readValueFromPointer:eo,destructorFunction:function(h){It(h)}})}function pc(a,s,c){c=G(c);var h,v,w,_,b;s===2?(h=ke,v=Ge,_=_e,w=()=>Dt,b=1):s===4&&(h=De,v=$t,_=rt,w=()=>oe,b=2),Pt(a,{name:c,fromWireType:function(E){for(var k=oe[E>>2],U=w(),I,D=E+4,H=0;H<=k;++H){var Z=E+4+H*s;if(H==k||U[Z>>b]==0){var pe=Z-D,Me=h(D,pe);I===void 0?I=Me:(I+=String.fromCharCode(0),I+=Me),D=Z+s}}return It(E),I},toWireType:function(E,k){typeof k!="string"&&he("Cannot pass non-string to C++ string type "+c);var U=_(k),I=Ut(4+U+s);return oe[I>>2]=U>>b,v(k,I+4,U+s),E!==null&&E.push(It,I),I},argPackAdvance:8,readValueFromPointer:eo,destructorFunction:function(E){It(E)}})}function dc(a,s){s=G(s),Pt(a,{isVoid:!0,name:s,argPackAdvance:0,fromWireType:function(){},toWireType:function(c,h){}})}function vc(){return Date.now()}var gc=!0;function mc(){return gc}function yc(a,s,c){a=Ve.toValue(a),s=ro(s,"emval::as");var h=[],v=Ve.toHandle(h);return L[c>>2]=v,s.toWireType(h,a)}function wc(a){var s=[];return L[a>>2]=Ve.toHandle(s),s}var _c={};function Si(a){var s=_c[a];return s===void 0?G(a):s}var Ti=[];function bc(a,s,c,h,v){return a=Ti[a],s=Ve.toValue(s),c=Si(c),a(s,c,wc(h),v)}function Ba(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Sc(a){return a===0?Ve.toHandle(Ba()):(a=Si(a),Ve.toHandle(Ba()[a]))}function Tc(a){var s=Ti.length;return Ti.push(a),s}function Ec(a,s){for(var c=new Array(a),h=0;h<a;++h)c[h]=ro(oe[s+h*ie>>2],"parameter "+h);return c}var La=[];function xc(a,s){var c=Ec(a,s),h=c[0],v=h.name+"_$"+c.slice(1).map(function(Z){return Z.name}).join("_")+"$",w=La[v];if(w!==void 0)return w;for(var _=["retType"],b=[h],E="",k=0;k<a-1;++k)E+=(k!==0?", ":"")+"arg"+k,_.push("argType"+k),b.push(c[1+k]);for(var U=jn("methodCaller_"+v),I="return function "+U+`(handle, name, destructors, args) {
`,D=0,k=0;k<a-1;++k)I+="    var arg"+k+" = argType"+k+".readValueFromPointer(args"+(D?"+"+D:"")+`);
`,D+=c[k+1].argPackAdvance;I+="    var rv = handle[name]("+E+`);
`;for(var k=0;k<a-1;++k)c[k+1].deleteObject&&(I+="    argType"+k+".deleteObject(arg"+k+`);
`);h.isVoid||(I+=`    return retType.toWireType(destructors, rv);
`),I+=`};
`,_.push(I);var H=Ma(Function,_).apply(null,b);return w=Tc(H),La[v]=w,w}function Cc(a,s){return a=Ve.toValue(a),s=Ve.toValue(s),Ve.toHandle(a[s])}function Pc(a){a>4&&(mt[a].refcount+=1)}function kc(a){return Ve.toHandle(Si(a))}function Ac(a){var s=Ve.toValue(a);Fa(s),_i(a)}function Oc(a,s,c){a=Ve.toValue(a),s=Ve.toValue(s),c=Ve.toValue(c),a[s]=c}function Rc(a,s){a=ro(a,"_emval_take_value");var c=a.readValueFromPointer(s);return Ve.toHandle(c)}function Dc(a){return a=Ve.toValue(a),Ve.toHandle(typeof a)}function Mc(a,s){var c=new Date(L[a>>2]*1e3);L[s>>2]=c.getSeconds(),L[s+4>>2]=c.getMinutes(),L[s+8>>2]=c.getHours(),L[s+12>>2]=c.getDate(),L[s+16>>2]=c.getMonth(),L[s+20>>2]=c.getFullYear()-1900,L[s+24>>2]=c.getDay();var h=new Date(c.getFullYear(),0,1),v=(c.getTime()-h.getTime())/(1e3*60*60*24)|0;L[s+28>>2]=v,L[s+36>>2]=-(c.getTimezoneOffset()*60);var w=new Date(c.getFullYear(),6,1).getTimezoneOffset(),_=h.getTimezoneOffset(),b=(w!=_&&c.getTimezoneOffset()==Math.min(_,w))|0;L[s+32>>2]=b}function Fc(a,s,c,h,v,w){try{var _=g.getStream(v);_&&(c&2&&ce.doMsync(a,_,s,h,w),g.munmap(_))}catch(b){if(typeof g>"u"||!(b instanceof g.ErrnoError))throw b;return-b.errno}}function Bc(a,s,c){var h=new Date().getFullYear(),v=new Date(h,0,1),w=new Date(h,6,1),_=v.getTimezoneOffset(),b=w.getTimezoneOffset(),E=Math.max(_,b);L[a>>2]=E*60,L[s>>2]=Number(_!=b);function k(Z){var pe=Z.toTimeString().match(/\(([A-Za-z ]+)\)$/);return pe?pe[1]:"GMT"}var U=k(v),I=k(w),D=je(U),H=je(I);b<_?(oe[c>>2]=D,oe[c+4>>2]=H):(oe[c>>2]=H,oe[c+4>>2]=D)}function Ei(a,s,c){Ei.called||(Ei.called=!0,Bc(a,s,c))}function Lc(){Ct("")}function Ua(){return 2147483648}function Uc(){return Ua()}function Ic(a,s,c){Ye.copyWithin(a,s,s+c)}function Gc(a){try{return de.grow(a-lt.byteLength+65535>>>16),dt(de.buffer),1}catch{}}function Nc(a){var s=Ye.length;a=a>>>0;var c=Ua();if(a>c)return!1;let h=(E,k)=>E+(k-E%k)%k;for(var v=1;v<=4;v*=2){var w=s*(1+.2/v);w=Math.min(w,a+100663296);var _=Math.min(c,h(Math.max(a,w),65536)),b=Gc(_);if(b)return!0}return!1}var xi={};function Hc(){return u||"./this.program"}function rn(){if(!rn.strings){var a=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",s={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:a,_:Hc()};for(var c in xi)xi[c]===void 0?delete s[c]:s[c]=xi[c];var h=[];for(var c in s)h.push(c+"="+s[c]);rn.strings=h}return rn.strings}function Vc(a,s){var c=0;return rn().forEach(function(h,v){var w=s+c;oe[a+v*4>>2]=w,Sr(h,w),c+=h.length+1}),0}function zc(a,s){var c=rn();oe[a>>2]=c.length;var h=0;return c.forEach(function(v){h+=v.length+1}),oe[s>>2]=h,0}function Wc(a){Ef(a)}function Xc(a){try{var s=ce.getStreamFromFD(a);return g.close(s),0}catch(c){if(typeof g>"u"||!(c instanceof g.ErrnoError))throw c;return c.errno}}function $c(a,s,c,h){for(var v=0,w=0;w<c;w++){var _=oe[s>>2],b=oe[s+4>>2];s+=8;var E=g.read(a,Ne,_,b,h);if(E<0)return-1;if(v+=E,E<b)break}return v}function Yc(a,s,c,h){try{var v=ce.getStreamFromFD(a),w=$c(v,s,c);return L[h>>2]=w,0}catch(_){if(typeof g>"u"||!(_ instanceof g.ErrnoError))throw _;return _.errno}}function Zc(a,s){return s+2097152>>>0<4194305-!!a?(a>>>0)+s*4294967296:NaN}function qc(a,s,c,h,v){try{var w=Zc(s,c);if(isNaN(w))return 61;var _=ce.getStreamFromFD(a);return g.llseek(_,w,h),gt=[_.position>>>0,(Ie=_.position,+Math.abs(Ie)>=1?Ie>0?(Math.min(+Math.floor(Ie/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Ie-+(~~Ie>>>0))/4294967296)>>>0:0)],L[v>>2]=gt[0],L[v+4>>2]=gt[1],_.getdents&&w===0&&h===0&&(_.getdents=null),0}catch(b){if(typeof g>"u"||!(b instanceof g.ErrnoError))throw b;return b.errno}}function jc(a,s,c,h){for(var v=0,w=0;w<c;w++){var _=oe[s>>2],b=oe[s+4>>2];s+=8;var E=g.write(a,Ne,_,b,h);if(E<0)return-1;v+=E}return v}function Kc(a,s,c,h){try{var v=ce.getStreamFromFD(a),w=jc(v,s,c);return oe[h>>2]=w,0}catch(_){if(typeof g>"u"||!(_ instanceof g.ErrnoError))throw _;return _.errno}}function Ia(a){for(var s=a.split("."),c=0;c<4;c++){var h=Number(s[c]);if(isNaN(h))return null;s[c]=h}return(s[0]|s[1]<<8|s[2]<<16|s[3]<<24)>>>0}function nn(a){return parseInt(a)}function Qc(a){var s,c,h,v,w=/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,_=[];if(!w.test(a))return null;if(a==="::")return[0,0,0,0,0,0,0,0];for(a.startsWith("::")?a=a.replace("::","Z:"):a=a.replace("::",":Z:"),a.indexOf(".")>0?(a=a.replace(new RegExp("[.]","g"),":"),s=a.split(":"),s[s.length-4]=nn(s[s.length-4])+nn(s[s.length-3])*256,s[s.length-3]=nn(s[s.length-2])+nn(s[s.length-1])*256,s=s.slice(0,s.length-2)):s=a.split(":"),h=0,v=0,c=0;c<s.length;c++)if(typeof s[c]=="string")if(s[c]==="Z"){for(v=0;v<8-s.length+1;v++)_[c+v]=0;h=v-1}else _[c+h]=Xa(parseInt(s[c],16));else _[c+h]=s[c];return[_[1]<<16|_[0],_[3]<<16|_[2],_[5]<<16|_[4],_[7]<<16|_[6]]}var qt={address_map:{id:1,addrs:{},names:{}},lookup_name:function(a){var s=Ia(a);if(s!==null||(s=Qc(a),s!==null))return a;var c;if(qt.address_map.addrs[a])c=qt.address_map.addrs[a];else{var h=qt.address_map.id++;Oe(h<65535,"exceeded max address mappings of 65535"),c="172.29."+(h&255)+"."+(h&65280),qt.address_map.names[c]=a,qt.address_map.addrs[a]=c}return c},lookup_addr:function(a){return qt.address_map.names[a]?qt.address_map.names[a]:null}};function Jc(a){var s=Ut(20),c=Ut(a.length+1);Pe(a,c,a.length+1),oe[s>>2]=c;var h=Ut(4);oe[h>>2]=0,oe[s+4>>2]=h;var v=2;L[s+8>>2]=v,L[s+12>>2]=4;var w=Ut(12);return oe[w>>2]=w+8,oe[w+4>>2]=0,L[w+8>>2]=Ia(qt.lookup_name(a)),oe[s+16>>2]=w,s}function ef(a){return Jc(ue(a))}function tf(a){var s=a.getExtension("ANGLE_instanced_arrays");if(s)return a.vertexAttribDivisor=function(c,h){s.vertexAttribDivisorANGLE(c,h)},a.drawArraysInstanced=function(c,h,v,w){s.drawArraysInstancedANGLE(c,h,v,w)},a.drawElementsInstanced=function(c,h,v,w,_){s.drawElementsInstancedANGLE(c,h,v,w,_)},1}function rf(a){var s=a.getExtension("OES_vertex_array_object");if(s)return a.createVertexArray=function(){return s.createVertexArrayOES()},a.deleteVertexArray=function(c){s.deleteVertexArrayOES(c)},a.bindVertexArray=function(c){s.bindVertexArrayOES(c)},a.isVertexArray=function(c){return s.isVertexArrayOES(c)},1}function nf(a){var s=a.getExtension("WEBGL_draw_buffers");if(s)return a.drawBuffers=function(c,h){s.drawBuffersWEBGL(c,h)},1}function of(a){return!!(a.multiDrawWebgl=a.getExtension("WEBGL_multi_draw"))}var Ee={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:[],offscreenCanvases:{},queries:[],stringCache:{},unpackAlignment:4,recordError:function(s){Ee.lastError||(Ee.lastError=s)},getNewId:function(a){for(var s=Ee.counter++,c=a.length;c<s;c++)a[c]=null;return s},getSource:function(a,s,c,h){for(var v="",w=0;w<s;++w){var _=h?L[h+w*4>>2]:-1;v+=ue(L[c+w*4>>2],_<0?void 0:_)}return v},createContext:function(a,s){if(!a.getContextSafariWebGL2Fixed){let w=function(_,b){var E=a.getContextSafariWebGL2Fixed(_,b);return _=="webgl"==E instanceof WebGLRenderingContext?E:null};var v=w;a.getContextSafariWebGL2Fixed=a.getContext,a.getContext=w}var c=a.getContext("webgl",s);if(!c)return 0;var h=Ee.registerContext(c,s);return h},registerContext:function(a,s){var c=Ee.getNewId(Ee.contexts),h={handle:c,attributes:s,version:s.majorVersion,GLctx:a};return a.canvas&&(a.canvas.GLctxObject=h),Ee.contexts[c]=h,(typeof s.enableExtensionsByDefault>"u"||s.enableExtensionsByDefault)&&Ee.initExtensions(h),c},makeContextCurrent:function(a){return Ee.currentContext=Ee.contexts[a],r.ctx=et=Ee.currentContext&&Ee.currentContext.GLctx,!(a&&!et)},getContext:function(a){return Ee.contexts[a]},deleteContext:function(a){Ee.currentContext===Ee.contexts[a]&&(Ee.currentContext=null),typeof JSEvents=="object"&&JSEvents.removeAllHandlersOnTarget(Ee.contexts[a].GLctx.canvas),Ee.contexts[a]&&Ee.contexts[a].GLctx.canvas&&(Ee.contexts[a].GLctx.canvas.GLctxObject=void 0),Ee.contexts[a]=null},initExtensions:function(a){if(a||(a=Ee.currentContext),!a.initExtensionsDone){a.initExtensionsDone=!0;var s=a.GLctx;tf(s),rf(s),nf(s),s.disjointTimerQueryExt=s.getExtension("EXT_disjoint_timer_query"),of(s);var c=s.getSupportedExtensions()||[];c.forEach(function(h){!h.includes("lose_context")&&!h.includes("debug")&&s.getExtension(h)})}}};function Ga(a){return a.slice(-1)=="]"&&a.lastIndexOf("[")}function af(a){var s=a.uniformLocsById,c=a.uniformSizeAndIdsByName,h,v;if(!s)for(a.uniformLocsById=s={},a.uniformArrayNamesById={},h=0;h<et.getProgramParameter(a,35718);++h){var w=et.getActiveUniform(a,h),_=w.name,b=w.size,E=Ga(_),k=E>0?_.slice(0,E):_,U=a.uniformIdCounter;for(a.uniformIdCounter+=b,c[k]=[b,U],v=0;v<b;++v)s[U]=v,a.uniformArrayNamesById[U++]=k}}function sf(a,s){if(s=ue(s),a=Ee.programs[a]){af(a);var c=a.uniformLocsById,h=0,v=s,w=Ga(s);w>0&&(h=nn(s.slice(w+1))>>>0,v=s.slice(0,w));var _=a.uniformSizeAndIdsByName[v];if(_&&h<_[0]&&(h+=_[1],c[h]=c[h]||et.getUniformLocation(a,s)))return h}else Ee.recordError(1281);return-1}function jt(a){var s=et.currentProgram;if(s){var c=s.uniformLocsById[a];return typeof c=="number"&&(s.uniformLocsById[a]=c=et.getUniformLocation(s,s.uniformArrayNamesById[a]+(c>0?"["+c+"]":""))),c}else Ee.recordError(1282)}function uf(a,s){et.uniform1f(jt(a),s)}function lf(a,s){et.uniform1i(jt(a),s)}var no=[];function cf(a,s,c){if(s<=144)for(var h=no[2*s-1],v=0;v<2*s;v+=2)h[v]=nt[c+4*v>>2],h[v+1]=nt[c+(4*v+4)>>2];else var h=nt.subarray(c>>2,c+s*8>>2);et.uniform2fv(jt(a),h)}var oo=[];function ff(a,s,c){if(s<=144)for(var h=oo[2*s-1],v=0;v<2*s;v+=2)h[v]=L[c+4*v>>2],h[v+1]=L[c+(4*v+4)>>2];else var h=L.subarray(c>>2,c+s*8>>2);et.uniform2iv(jt(a),h)}function hf(a,s,c){if(s<=96)for(var h=no[3*s-1],v=0;v<3*s;v+=3)h[v]=nt[c+4*v>>2],h[v+1]=nt[c+(4*v+4)>>2],h[v+2]=nt[c+(4*v+8)>>2];else var h=nt.subarray(c>>2,c+s*12>>2);et.uniform3fv(jt(a),h)}function pf(a,s,c){if(s<=96)for(var h=oo[3*s-1],v=0;v<3*s;v+=3)h[v]=L[c+4*v>>2],h[v+1]=L[c+(4*v+4)>>2],h[v+2]=L[c+(4*v+8)>>2];else var h=L.subarray(c>>2,c+s*12>>2);et.uniform3iv(jt(a),h)}function df(a,s,c){if(s<=72){var h=no[4*s-1],v=nt;c>>=2;for(var w=0;w<4*s;w+=4){var _=c+w;h[w]=v[_],h[w+1]=v[_+1],h[w+2]=v[_+2],h[w+3]=v[_+3]}}else var h=nt.subarray(c>>2,c+s*16>>2);et.uniform4fv(jt(a),h)}function vf(a,s,c){if(s<=72)for(var h=oo[4*s-1],v=0;v<4*s;v+=4)h[v]=L[c+4*v>>2],h[v+1]=L[c+(4*v+4)>>2],h[v+2]=L[c+(4*v+8)>>2],h[v+3]=L[c+(4*v+12)>>2];else var h=L.subarray(c>>2,c+s*16>>2);et.uniform4iv(jt(a),h)}function gf(a){}function io(a){return a%4===0&&(a%100!==0||a%400===0)}function mf(a,s){for(var c=0,h=0;h<=s;c+=a[h++]);return c}var Na=[31,29,31,30,31,30,31,31,30,31,30,31],Ha=[31,28,31,30,31,30,31,31,30,31,30,31];function yf(a,s){for(var c=new Date(a.getTime());s>0;){var h=io(c.getFullYear()),v=c.getMonth(),w=(h?Na:Ha)[v];if(s>w-c.getDate())s-=w-c.getDate()+1,c.setDate(1),v<11?c.setMonth(v+1):(c.setMonth(0),c.setFullYear(c.getFullYear()+1));else return c.setDate(c.getDate()+s),c}return c}function wf(a,s,c,h){var v=L[h+40>>2],w={tm_sec:L[h>>2],tm_min:L[h+4>>2],tm_hour:L[h+8>>2],tm_mday:L[h+12>>2],tm_mon:L[h+16>>2],tm_year:L[h+20>>2],tm_wday:L[h+24>>2],tm_yday:L[h+28>>2],tm_isdst:L[h+32>>2],tm_gmtoff:L[h+36>>2],tm_zone:v?ue(v):""},_=ue(c),b={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var E in b)_=_.replace(new RegExp(E,"g"),b[E]);var k=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],U=["January","February","March","April","May","June","July","August","September","October","November","December"];function I(R,$,ze){for(var be=typeof R=="number"?R.toString():R||"";be.length<$;)be=ze[0]+be;return be}function D(R,$){return I(R,$,"0")}function H(R,$){function ze(ot){return ot<0?-1:ot>0?1:0}var be;return(be=ze(R.getFullYear()-$.getFullYear()))===0&&(be=ze(R.getMonth()-$.getMonth()))===0&&(be=ze(R.getDate()-$.getDate())),be}function Z(R){switch(R.getDay()){case 0:return new Date(R.getFullYear()-1,11,29);case 1:return R;case 2:return new Date(R.getFullYear(),0,3);case 3:return new Date(R.getFullYear(),0,2);case 4:return new Date(R.getFullYear(),0,1);case 5:return new Date(R.getFullYear()-1,11,31);case 6:return new Date(R.getFullYear()-1,11,30)}}function pe(R){var $=yf(new Date(R.tm_year+1900,0,1),R.tm_yday),ze=new Date($.getFullYear(),0,4),be=new Date($.getFullYear()+1,0,4),ot=Z(ze),Be=Z(be);return H(ot,$)<=0?H(Be,$)<=0?$.getFullYear()+1:$.getFullYear():$.getFullYear()-1}var Me={"%a":function(R){return k[R.tm_wday].substring(0,3)},"%A":function(R){return k[R.tm_wday]},"%b":function(R){return U[R.tm_mon].substring(0,3)},"%B":function(R){return U[R.tm_mon]},"%C":function(R){var $=R.tm_year+1900;return D($/100|0,2)},"%d":function(R){return D(R.tm_mday,2)},"%e":function(R){return I(R.tm_mday,2," ")},"%g":function(R){return pe(R).toString().substring(2)},"%G":function(R){return pe(R)},"%H":function(R){return D(R.tm_hour,2)},"%I":function(R){var $=R.tm_hour;return $==0?$=12:$>12&&($-=12),D($,2)},"%j":function(R){return D(R.tm_mday+mf(io(R.tm_year+1900)?Na:Ha,R.tm_mon-1),3)},"%m":function(R){return D(R.tm_mon+1,2)},"%M":function(R){return D(R.tm_min,2)},"%n":function(){return`
`},"%p":function(R){return R.tm_hour>=0&&R.tm_hour<12?"AM":"PM"},"%S":function(R){return D(R.tm_sec,2)},"%t":function(){return"	"},"%u":function(R){return R.tm_wday||7},"%U":function(R){var $=R.tm_yday+7-R.tm_wday;return D(Math.floor($/7),2)},"%V":function(R){var $=Math.floor((R.tm_yday+7-(R.tm_wday+6)%7)/7);if((R.tm_wday+371-R.tm_yday-2)%7<=2&&$++,$){if($==53){var be=(R.tm_wday+371-R.tm_yday)%7;be!=4&&(be!=3||!io(R.tm_year))&&($=1)}}else{$=52;var ze=(R.tm_wday+7-R.tm_yday-1)%7;(ze==4||ze==5&&io(R.tm_year%400-1))&&$++}return D($,2)},"%w":function(R){return R.tm_wday},"%W":function(R){var $=R.tm_yday+7-(R.tm_wday+6)%7;return D(Math.floor($/7),2)},"%y":function(R){return(R.tm_year+1900).toString().substring(2)},"%Y":function(R){return R.tm_year+1900},"%z":function(R){var $=R.tm_gmtoff,ze=$>=0;return $=Math.abs($)/60,$=$/60*100+$%60,(ze?"+":"-")+String("0000"+$).slice(-4)},"%Z":function(R){return R.tm_zone},"%%":function(){return"%"}};_=_.replace(/%%/g,"\0\0");for(var E in Me)_.includes(E)&&(_=_.replace(new RegExp(E,"g"),Me[E](w)));_=_.replace(/\0\0/g,"%");var Fe=uo(_,!1);return Fe.length>s?0:(ut(Fe,a),Fe.length-1)}function _f(a,s,c,h){return wf(a,s,c,h)}var Va=function(a,s,c,h){a||(a=this),this.parent=a,this.mount=a.mount,this.mounted=null,this.id=g.nextInode++,this.name=s,this.mode=c,this.node_ops={},this.stream_ops={},this.rdev=h},ao=365,so=146;Object.defineProperties(Va.prototype,{read:{get:function(){return(this.mode&ao)===ao},set:function(a){a?this.mode|=ao:this.mode&=~ao}},write:{get:function(){return(this.mode&so)===so},set:function(a){a?this.mode|=so:this.mode&=~so}},isFolder:{get:function(){return g.isDir(this.mode)}},isDevice:{get:function(){return g.isChrdev(this.mode)}}}),g.FSNode=Va,g.staticInit(),ci(),Rr=r.BindingError=fi(Error,"BindingError"),xa=r.InternalError=fi(Error,"InternalError"),Ul(),Al(),Xl(),Ra=r.UnboundTypeError=fi(Error,"UnboundTypeError"),rc();for(var et,bf=new Float32Array(288),Lt=0;Lt<288;++Lt)no[Lt]=bf.subarray(0,Lt+1);for(var Sf=new Int32Array(288),Lt=0;Lt<288;++Lt)oo[Lt]=Sf.subarray(0,Lt+1);function uo(a,s,c){var h=c>0?c:ve(a)+1,v=new Array(h),w=ge(a,v,0,v.length);return s&&(v.length=w),v}var Tf={ga:Nn,k:Hn,b:Vn,c:ni,Q:ii,R:ai,q:Wn,K:Xn,U:$n,I:Yn,H:Zn,u:si,J:ui,z:li,W:Sl,d:jl,f:Kl,e:Ql,a:Jl,V:nc,g:ic,h:ac,v:uc,j:cc,i:fc,w:hc,r:pc,X:dc,N:vc,M:mc,m:yc,ka:bc,x:_i,la:Sc,ja:xc,s:Cc,E:Pc,ia:kc,ma:Ac,n:Oc,l:Rc,na:Dc,O:Mc,D:Fc,P:Ei,t:Lc,C:Uc,L:Ic,o:Nc,F:Vc,G:zc,fa:Wc,p:Xc,T:Yc,y:qc,S:Kc,ha:ef,ea:sf,ca:uf,da:lf,_:cf,ba:ff,Z:hf,aa:pf,Y:df,$:vf,A:gf,B:_f};ti(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.pa).apply(null,arguments)};var Ut=r._malloc=function(){return(Ut=r._malloc=r.asm.qa).apply(null,arguments)},It=r._free=function(){return(It=r._free=r.asm.ra).apply(null,arguments)},za=r.___errno_location=function(){return(za=r.___errno_location=r.asm.sa).apply(null,arguments)},Wa=r.___getTypeName=function(){return(Wa=r.___getTypeName=r.asm.ta).apply(null,arguments)};r.___embind_register_native_and_builtin_types=function(){return(r.___embind_register_native_and_builtin_types=r.asm.ua).apply(null,arguments)};var Xa=r._htons=function(){return(Xa=r._htons=r.asm.wa).apply(null,arguments)},$a=r._emscripten_builtin_memalign=function(){return($a=r._emscripten_builtin_memalign=r.asm.xa).apply(null,arguments)},Ya=r.___cxa_is_pointer_type=function(){return(Ya=r.___cxa_is_pointer_type=r.asm.ya).apply(null,arguments)};r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.za).apply(null,arguments)},r.dynCall_viiiiji=function(){return(r.dynCall_viiiiji=r.asm.Aa).apply(null,arguments)},r.dynCall_viijii=function(){return(r.dynCall_viijii=r.asm.Ba).apply(null,arguments)},r.dynCall_iiiiij=function(){return(r.dynCall_iiiiij=r.asm.Ca).apply(null,arguments)},r.dynCall_iiiiijj=function(){return(r.dynCall_iiiiijj=r.asm.Da).apply(null,arguments)},r.dynCall_iiiiiijj=function(){return(r.dynCall_iiiiiijj=r.asm.Ea).apply(null,arguments)},r.FS=g;var lo;function Ci(a){this.name="ExitStatus",this.message="Program terminated with exit("+a+")",this.status=a}ur=function a(){lo||Pi(),lo||(ur=a)};function Pi(a){if(vt>0||(Fn(),vt>0))return;function s(){lo||(lo=!0,r.calledRun=!0,!Te&&(Bn(),n(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),Ln()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),s()},1)):s()}r.run=Pi;function Ef(a,s){xf(a)}function xf(a){Zr()||(r.onExit&&r.onExit(a),Te=!0),l(a,new Ci(a))}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return Pi(),r.ready}})(),kf="/cad-os/assets/replicad_single-b4564eab.wasm";const zi={library:null},Af=t=>{zi.library=t},N=()=>{if(!zi.library)throw new Error("oppencascade has not been loaded");return zi.library};globalThis.FinalizationRegistry||(console.log("Garbage collection will not work"),globalThis.FinalizationRegistry=()=>({register:()=>null,unregister:()=>null}));const an=new globalThis.FinalizationRegistry(t=>{try{t.delete()}catch(e){console.error(e)}});class ht{constructor(e){this.oc=N(),e&&an.register(this,e,e),this._wrapped=e}get wrapped(){if(this._wrapped===null)throw new Error("This object has been deleted");return this._wrapped}set wrapped(e){this._wrapped&&(an.unregister(this._wrapped),this._wrapped.delete()),an.register(this,e,e),this._wrapped=e}delete(){var e;an.unregister(this.wrapped),(e=this.wrapped)==null||e.delete(),this._wrapped=null}}const xe=()=>{function t(e){return an.register(t,e),e}return t},Xe=t=>{const e=new Set;return[r=>(e.add(r),r),()=>{[...e.values()].forEach(r=>r.delete()),e.clear()},t?e:void 0]},tu=2147483647,wt=Math.PI/180,ln=180/Math.PI,ki=t=>Math.round(t*1e3)/1e3,pn=(t,e,r)=>{const n=N(),o=ft(t),i=Gr(e);let u;if(r){const l=Gr(r);u=new n.gp_Ax3_3(o,i,l),l.delete()}else u=new n.gp_Ax3_4(o,i);return o.delete(),i.delete(),u},Xo=(t,e,r)=>{const n=N(),o=ft(t),i=Gr(e);let u;if(r){const l=Gr(r);u=new n.gp_Ax2_2(o,i,l),l.delete()}else u=new n.gp_Ax2_3(o,i);return o.delete(),i.delete(),u},cn=(t,e)=>{const r=N(),n=ft(t),o=Gr(e),i=new r.gp_Ax1_2(n,o);return n.delete(),o.delete(),i},Of=(t=[0,0,0])=>{const e=N();if(Array.isArray(t)){if(t.length===3)return new e.gp_Vec_4(...t);if(t.length===2)return new e.gp_Vec_4(...t,0)}else{if(t instanceof M)return new e.gp_Vec_3(t.wrapped.XYZ());if(t.XYZ)return new e.gp_Vec_3(t.XYZ())}return new e.gp_Vec_4(0,0,0)};class M extends ht{constructor(e=[0,0,0]){super(Of(e))}get repr(){return`x: ${ki(this.x)}, y: ${ki(this.y)}, z: ${ki(this.z)}`}get x(){return this.wrapped.X()}get y(){return this.wrapped.Y()}get z(){return this.wrapped.Z()}get Length(){return this.wrapped.Magnitude()}toTuple(){return[this.x,this.y,this.z]}cross(e){return new M(this.wrapped.Crossed(e.wrapped))}dot(e){return this.wrapped.Dot(e.wrapped)}sub(e){return new M(this.wrapped.Subtracted(e.wrapped))}add(e){return new M(this.wrapped.Added(e.wrapped))}multiply(e){return new M(this.wrapped.Multiplied(e))}normalized(){return new M(this.wrapped.Normalized())}normalize(){return this.wrapped.Normalize(),this}getCenter(){return this}getAngle(e){return this.wrapped.Angle(e.wrapped)*ln}projectToPlane(e){const r=e.origin,n=e.zDir,o=this.sub(r),i=n.multiply(o.dot(n)/n.Length**2),u=this.sub(i);return o.delete(),i.delete(),u}equals(e){return this.wrapped.IsEqual(e.wrapped,1e-5,1e-5)}toPnt(){return new this.oc.gp_Pnt_2(this.wrapped.XYZ())}toDir(){return new this.oc.gp_Dir_3(this.wrapped.XYZ())}rotate(e,r=[0,0,0],n=[0,0,1]){const o=cn(r,n);return this.wrapped.Rotate(o,e*wt),o.delete(),this}}const Rf={X:[1,0,0],Y:[0,1,0],Z:[0,0,1]};function Df(t){return t==="X"||t==="Y"||t==="Z"?Rf[t]:t}function ft(t){const e=new M(t),r=e.toPnt();return e.delete(),r}function Gr(t){const e=new M(t),r=e.toDir();return e.delete(),r}class yr extends ht{constructor(e){const r=N();super(e||new r.gp_Trsf_1)}translate(e,r=0,n=0){const o=new M(typeof e=="number"?[e,r,n]:e);return this.wrapped.SetTranslation_1(o.wrapped),this}rotate(e,r=[0,0,0],n=[0,0,1]){const o=Gr(n),i=ft(r),u=new this.oc.gp_Ax1_2(i,o);return this.wrapped.SetRotation_1(u,e*wt),u.delete(),o.delete(),i.delete(),this}mirror(e="YZ",r){const n=xe();let o,i;if(typeof e=="string"){const l=n(ru(e,r));o=l.origin,i=l.zDir}else e instanceof tt?(o=r||e.origin,i=e.zDir):(o=r||[0,0,0],i=e);const u=n(Xo(o,i));return this.wrapped.SetMirror_3(u),this}scale(e,r){const n=ft(e);return this.wrapped.SetScale(n,r),n.delete(),this}coordSystemChange(e,r){const n=xe(),o=n(e==="reference"?new this.oc.gp_Ax3_1:pn(e.origin,e.zDir,e.xDir)),i=n(r==="reference"?new this.oc.gp_Ax3_1:pn(r.origin,r.zDir,r.xDir));return this.wrapped.SetTransformation_1(o,i),this}transformPoint(e){const r=ft(e),n=r.Transformed(this.wrapped);return r.delete(),n}transform(e){return new this.oc.BRepBuilderAPI_Transform_2(e,this.wrapped,!0).ModifiedShape(e)}}class tt{constructor(e,r=null,n=[0,0,1]){this.oc=N();const o=new M(n);if(o.Length===0)throw new Error("normal should be non null");this.zDir=o.normalize();let i;if(r)i=new M(r);else{const u=pn(e,o);i=new M(u.XDirection()),u.delete()}if(i.Length===0)throw new Error("xDir should be non null");this.xDir=i.normalize(),this.yDir=this.zDir.cross(this.xDir).normalize(),this.origin=new M(e)}delete(){this.localToGlobal.delete(),this.xDir.delete(),this.yDir.delete(),this.zDir.delete(),this._origin.delete()}clone(){return new tt(this.origin,this.xDir,this.zDir)}get origin(){return this._origin}set origin(e){this._origin=e,this._calcTransforms()}translateTo(e){const r=this.clone();return r.origin=new M(e),r}translate(e,r=0,n=0){const o=new M(typeof e=="number"?[e,r,n]:e);return this.translateTo(this.origin.add(o))}translateX(e){return this.translate(e,0,0)}translateY(e){return this.translate(0,e,0)}translateZ(e){return this.translate(0,0,e)}pivot(e,r=[1,0,0]){const n=Df(r),o=new M(this.zDir).rotate(e,[0,0,0],n),i=new M(this.xDir).rotate(e,[0,0,0],n);return new tt(this.origin,i,o)}rotate2DAxes(e){const r=new M(this.xDir).rotate(e,[0,0,0],this.zDir);return new tt(this.origin,r,this.zDir)}_calcTransforms(){const e=new this.oc.gp_Ax3_1,r=pn(this.origin,this.zDir,this.xDir);new this.oc.gp_Trsf_1().SetTransformation_1(e,r),this.globalToLocal=new yr,this.globalToLocal.coordSystemChange("reference",{origin:this.origin,zDir:this.zDir,xDir:this.xDir}),this.localToGlobal=new yr,this.localToGlobal.coordSystemChange({origin:this.origin,zDir:this.zDir,xDir:this.xDir},"reference")}setOrigin2d(e,r){this.origin=this.toWorldCoords([e,r])}toLocalCoords(e){const r=this.globalToLocal.transformPoint(e),n=new M(r);return r.delete(),n}toWorldCoords(e){const r=this.localToGlobal.transformPoint(e),n=new M(r);return r.delete(),n}}const Mf={XY:{xDir:[1,0,0],normal:[0,0,1]},YZ:{xDir:[0,1,0],normal:[1,0,0]},ZX:{xDir:[0,0,1],normal:[0,1,0]},XZ:{xDir:[1,0,0],normal:[0,-1,0]},YX:{xDir:[0,1,0],normal:[0,0,-1]},ZY:{xDir:[0,0,1],normal:[-1,0,0]},front:{xDir:[1,0,0],normal:[0,0,1]},back:{xDir:[-1,0,0],normal:[0,0,-1]},left:{xDir:[0,0,1],normal:[-1,0,0]},right:{xDir:[0,0,-1],normal:[1,0,0]},top:{xDir:[1,0,0],normal:[0,1,0]},bottom:{xDir:[1,0,0],normal:[0,-1,0]}},ru=(t,e=[0,0,0])=>{const r=Mf[t];if(!r)throw new Error(`Could not find plane ${t}`);let n;return typeof e=="number"?n=r.normal.map(o=>o*e):n=e,new tt(n,r.xDir,r.normal)};let Ff=class extends ht{constructor(e){const r=N();let n=e;n||(n=new r.Bnd_Box_1),super(n)}get repr(){const[e,r]=this.bounds;return`${new M(e).repr} - ${new M(r).repr}`}get bounds(){const e={current:0},r={current:0},n={current:0},o={current:0},i={current:0},u={current:0};return this.wrapped.Get(e,r,n,o,i,u),[[e.current,r.current,n.current],[o.current,i.current,u.current]]}get center(){const[[e,r,n],[o,i,u]]=this.bounds;return[e+(o-e)/2,r+(i-r)/2,n+(u-n)/2]}get width(){const[[e],[r]]=this.bounds;return Math.abs(r-e)}get height(){const[[,e],[,r]]=this.bounds;return Math.abs(r-e)}get depth(){const[[,,e],[,,r]]=this.bounds;return Math.abs(r-e)}add(e){this.wrapped.Add_1(e.wrapped)}isOut(e){return this.wrapped.IsOut_4(e.wrapped)}};function or(t="XY",e=[0,0,0]){return t instanceof tt?t.clone():ru(t,e)}function Bf(t,e,r=[0,0,0],n=[0,0,1]){const o=new yr;o.rotate(e,r,n);const i=o.transform(t);return o.delete(),i}function Lf(t,e){const r=new yr;r.translate(e);const n=r.transform(t);return r.delete(),n}function Uf(t,e,r){const n=new yr;n.mirror(e,r);const o=n.transform(t);return n.delete(),o}function If(t,e,r){const n=new yr;n.scale(e,r);const o=n.transform(t);return n.delete(),o}function Co(t){return Array.isArray(t)&&t.length===2}let co=null;const Za=t=>{if(co&&!t)return co;const r=N().GeomAbs_CurveType;return co=new Map([[r.GeomAbs_Line,"LINE"],[r.GeomAbs_Circle,"CIRCLE"],[r.GeomAbs_Ellipse,"ELLIPSE"],[r.GeomAbs_Hyperbola,"HYPERBOLA"],[r.GeomAbs_Parabola,"PARABOLA"],[r.GeomAbs_BezierCurve,"BEZIER_CURVE"],[r.GeomAbs_BSplineCurve,"BSPLINE_CURVE"],[r.GeomAbs_OffsetCurve,"OFFSET_CURVE"],[r.GeomAbs_OtherCurve,"OTHER_CURVE"]]),co},_n=t=>{let e=Za().get(t);if(e||(e=Za(!0).get(t)),!e)throw new Error("unknown type");return e};function Gf(t,e){const r=Math.pow(10,e),n=e<0?t:.01/r+t;return Math.round(n*r)/r}function Nf(t){return Array.from(Array(t).keys())}function Lr(t){const e=Math.min(...t.map(r=>r.length));return Nf(e).map(r=>t.map(n=>n[r]))}function Po(t){return Math.round(t*100)/100}const fn=([t,e])=>`(${Po(t)},${Po(e)})`,qa=(t,e=1e-9)=>{let r=t;return Math.abs(t)<e&&(r=0),r.toFixed(-Math.log10(e))},nu=(t,e=1e-9)=>Array.from(new Map(t.map(([r,n])=>[`[${qa(r,e)},${qa(n,e)}]`,[r,n]])).values()),qe=([t,e])=>{const r=N();return new r.gp_Pnt2d_3(t,e)},Hf=([t,e])=>{const r=N();return new r.gp_Dir2d_4(t,e)},ou=([t,e])=>{const r=N();return new r.gp_Vec2d_4(t,e)},Nr=(t,e)=>{const r=N(),[n,o]=Xe(),i=new r.gp_Ax2d_2(n(qe(t)),n(Hf(e)));return o(),i};class bn extends ht{constructor(e){const r=N();let n=e;n||(n=new r.Bnd_Box2d),super(n)}get repr(){const[e,r]=this.bounds;return`${fn(e)} - ${fn(r)}`}get bounds(){const e={current:0},r={current:0},n={current:0},o={current:0};return this.wrapped.Get(e,r,n,o),[[e.current,r.current],[n.current,o.current]]}get center(){const[[e,r],[n,o]]=this.bounds;return[e+(n-e)/2,r+(o-r)/2]}get width(){const[[e],[r]]=this.bounds;return Math.abs(r-e)}get height(){const[[,e],[,r]]=this.bounds;return Math.abs(r-e)}outsidePoint(e=1){const[r,n]=this.bounds,o=n[0]-r[0],i=n[1]-r[1];return[n[0]+o/100*e,n[1]+i/100*e*.9]}add(e){this.wrapped.Add_1(e.wrapped)}isOut(e){return this.wrapped.IsOut_4(e.wrapped)}containsPoint(e){const n=xe()(qe(e));return!this.wrapped.IsOut_1(n)}}const Qe=([t,e],[r,n],o=1e-6)=>Math.abs(t-r)<=o&&Math.abs(e-n)<=o,Hr=([t,e],[r,n])=>[t+r,e+n],aa=([t,e],[r,n])=>[t-r,e-n],Wi=([t,e],r)=>[t*r,e*r],kt=([t,e],[r,n]=[0,0])=>Math.sqrt((t-r)**2+(e-n)**2),Vf=([t,e],[r,n]=[0,0])=>(t-r)**2+(e-n)**2;function zf([t,e],[r,n]){return t*n-e*r}const Wf=([t,e],[r,n]=[0,0])=>Math.atan2(n*t-e*r,t*r+e*n),Xf=([t,e],[r,n]=[0,0])=>Math.atan2(n-e,r-t),er=([t,e])=>{const r=kt([t,e]);return[t/r,e/r]},$f=(t,e,r=[0,0])=>{const[n,o]=t,[i,u]=r,l=n-i,f=o-u,p=Math.sin(e),d=Math.cos(e),y=l*d-f*p,m=l*p+f*d;return[y+i,m+u]},Fr=(t,e)=>{const r=Math.cos(e)*t,n=Math.sin(e)*t;return[r,n]},Yf=([t,e])=>{const r=kt([t,e]),n=Math.atan2(e,t);return[r,n]};class Le extends ht{constructor(e){const r=N(),n=e.get();super(new r.Handle_Geom2d_Curve_2(n)),this._boundingBox=null}get boundingBox(){if(this._boundingBox)return this._boundingBox;const e=N(),r=new e.Bnd_Box2d;return e.BndLib_Add2dCurve.Add_3(this.wrapped,1e-6,r),this._boundingBox=new bn(r),this._boundingBox}get repr(){return`${this.geomType} ${fn(this.firstPoint)} - ${fn(this.lastPoint)}`}get innerCurve(){return this.wrapped.get()}value(e){const r=this.innerCurve.Value(e),n=[r.X(),r.Y()];return r.delete(),n}get firstPoint(){return this.value(this.firstParameter)}get lastPoint(){return this.value(this.lastParameter)}get firstParameter(){return this.innerCurve.FirstParameter()}get lastParameter(){return this.innerCurve.LastParameter()}adaptor(){const e=N();return new e.Geom2dAdaptor_Curve_2(this.wrapped)}get geomType(){const e=this.adaptor(),r=_n(e.GetType());return e.delete(),r}clone(){return new Le(this.innerCurve.Copy())}reverse(){this.innerCurve.Reverse()}distanceFromPoint(e){const r=N(),n=xe(),o=n(new r.Geom2dAPI_ProjectPointOnCurve_2(n(qe(e)),this.wrapped));let i=1/0;try{i=o.LowerDistance()}catch{i=1/0}return Math.min(i,kt(e,this.firstPoint),kt(e,this.lastPoint))}distanceFromCurve(e){const r=N(),n=xe();let o=1/0;const i=n(new r.Geom2dAPI_ExtremaCurveCurve(this.wrapped,e.wrapped,this.firstParameter,this.lastParameter,e.firstParameter,e.lastParameter));try{o=i.LowerDistance()}catch{o=1/0}return Math.min(o,this.distanceFromPoint(e.firstPoint),this.distanceFromPoint(e.lastPoint),e.distanceFromPoint(this.firstPoint),e.distanceFromPoint(this.lastPoint))}distanceFrom(e){return Co(e)?this.distanceFromPoint(e):this.distanceFromCurve(e)}isOnCurve(e){return this.distanceFromPoint(e)<1e-9}parameter(e,r=1e-9){const n=N(),o=xe();let i,u;try{const l=o(new n.Geom2dAPI_ProjectPointOnCurve_2(o(qe(e)),this.wrapped));i=l.LowerDistance(),u=l.LowerDistanceParameter()}catch{if(Qe(e,this.firstPoint,r))return this.firstParameter;if(Qe(e,this.lastPoint,r))return this.lastParameter;throw new Error("Failed to find parameter")}if(i>r)throw new Error(`Point ${fn(e)} not on curve ${this.repr}, ${i.toFixed(9)}`);return u}tangentAt(e){const r=N(),[n,o]=Xe();let i;Array.isArray(e)?i=this.parameter(e):i=(this.innerCurve.LastParameter()-this.innerCurve.FirstParameter())*e+this.innerCurve.FirstParameter();const u=n(new r.gp_Pnt2d_1),l=n(new r.gp_Vec2d_1);this.innerCurve.D1(i,u,l);const f=[l.X(),l.Y()];return o(),f}splitAt(e,r=1e-9){const n=N(),o=xe();let i=e.map(f=>Co(f)?this.parameter(f,r):f);i=Array.from(new Map(i.map(f=>[Gf(f,-Math.log10(r)),f])).values()).sort((f,p)=>f-p);const u=this.firstParameter,l=this.lastParameter;return u>l&&i.reverse(),Math.abs(i[0]-u)<r*100&&(i=i.slice(1)),i.length?(Math.abs(i[i.length-1]-l)<r*100&&(i=i.slice(0,-1)),i.length?Lr([[u,...i],[...i,l]]).map(([f,p])=>{try{if(this.geomType==="BEZIER_CURVE"){const y=new n.Geom2d_BezierCurve_1(o(this.adaptor()).Bezier().get().Poles_2());return y.Segment(f,p),new Le(new n.Handle_Geom2d_Curve_2(y))}if(this.geomType==="BSPLINE_CURVE"){const y=o(this.adaptor()).BSpline().get(),m=new n.Geom2d_BSplineCurve_1(y.Poles_2(),y.Knots_2(),y.Multiplicities_2(),y.Degree(),y.IsPeriodic());return m.Segment(f,p,r),new Le(new n.Handle_Geom2d_Curve_2(m))}const d=new n.Geom2d_TrimmedCurve(this.wrapped,f,p,!0,!0);return new Le(new n.Handle_Geom2d_Curve_2(d))}catch{throw new Error("Failed to split the curve")}}):[this]):[this]}}const iu=(t,e=1e-4,r="C0",n=200)=>{const o=N(),i=xe(),u={C0:o.GeomAbs_Shape.GeomAbs_C0,C1:o.GeomAbs_Shape.GeomAbs_C1,C2:o.GeomAbs_Shape.GeomAbs_C2,C3:o.GeomAbs_Shape.GeomAbs_C3},l=i(new o.Geom2dConvert_ApproxCurve_2(t.ShallowCopy(),e,u[r],n,3));return new Le(l.Curve())},ja=t=>{if(_n(t.GetType())!=="BSPLINE_CURVE")throw new Error("You can only convert a Bspline");const e=t.BSpline(),r=N(),n=new r.Geom2dConvert_BSplineCurveToBezierCurve_1(e);function*o(){const u=n.NbArcs();if(u)for(let l=1;l<=u;l++){const f=n.Arc(l);yield new Le(f)}}const i=Array.from(o());return n.delete(),i};function ko(t,e={tolerance:1e-4,continuity:"C0",maxSegments:300}){const r=xe();return t.flatMap(n=>{const o=r(n.adaptor()),i=_n(o.GetType());if(i==="ELLIPSE"||i==="CIRCLE"&&Qe(n.firstPoint,n.lastPoint))return n.splitAt([.5]);if(["LINE","ELLIPSE","CIRCLE"].includes(i))return n;if(i==="BEZIER_CURVE"){const f=o.Bezier().get().Degree();if([1,2,3].includes(f))return n}if(i==="BSPLINE_CURVE"){const l=ja(o);return ko(l,e)}const u=iu(o,e.tolerance,e.continuity,e.maxSegments);return ko(ja(r(u.adaptor())),e)})}function*au(t){const e=t.NbPoints();if(e)for(let r=1;r<=e;r++){const n=t.Point(r);yield[n.X(),n.Y()]}}function*Zf(t){const e=t.NbSegments();if(!e)return;const r=N();for(let n=1;n<=e;n++){const o=new r.Handle_Geom2d_Curve_1,i=new r.Handle_Geom2d_Curve_1;try{t.Segment(n,o,i)}catch{continue}yield new Le(o),i.delete()}}const Sn=(t,e,r=1e-9)=>{if(t.boundingBox.isOut(e.boundingBox))return{intersections:[],commonSegments:[],commonSegmentsPoints:[]};const n=N(),o=new n.Geom2dAPI_InterCurveCurve_1;let i,u;try{o.Init_1(t.wrapped,e.wrapped,r),i=Array.from(au(o)),u=Array.from(Zf(o))}catch(p){throw console.error(t,e,p),new Error("Intersections failed between curves")}finally{o.delete()}const l=u.filter(p=>Qe(p.firstPoint,p.lastPoint,r)).map(p=>p.firstPoint);l.length&&(i.push(...l),u=u.filter(p=>!Qe(p.firstPoint,p.lastPoint,r)));const f=u.flatMap(p=>[p.firstPoint,p.lastPoint]);return{intersections:i,commonSegments:u,commonSegmentsPoints:f}},qf=(t,e=1e-9)=>{const r=N(),n=new r.Geom2dAPI_InterCurveCurve_1;let o;try{n.Init_1(t.wrapped,t.wrapped,e),o=Array.from(au(n))}catch{throw new Error("Self intersection failed")}finally{n.delete()}return o},Tn=(t,e)=>{const r=N(),[n,o]=Xe(),i=n(new r.GCE2d_MakeSegment_1(n(qe(t)),n(qe(e)))).Value(),u=new Le(i);return Qe(u.firstPoint,t)||u.reverse(),o(),u},Xi=(t,e,r)=>{const n=N(),[o,i]=Xe(),u=o(new n.GCE2d_MakeArcOfCircle_4(o(qe(t)),o(qe(e)),o(qe(r)))).Value();i();const l=new Le(u);return Qe(l.firstPoint,t)||l.wrapped.get().SetTrim(l.lastParameter,l.firstParameter,!0,!0),l},jf=(t,e,r)=>{const n=N(),[o,i]=Xe(),u=o(new n.GCE2d_MakeArcOfCircle_5(o(qe(t)),o(ou(e)),o(qe(r)))).Value();i();const l=new Le(u);return Qe(l.firstPoint,t)||l.wrapped.get().SetTrim(l.lastParameter,l.firstParameter,!0,!0),l},Kf=(t,e,r,n,o=[0,0],i,u=!0)=>{const l=N(),[f,p]=Xe(),d=f(new l.gp_Elips2d_2(f(Nr(o,i)),t,e,!0)),y=f(new l.GCE2d_MakeArcOfEllipse_1(d,r,n,u)).Value();return p(),new Le(y)},Qf=(t,e,r)=>{const n=N(),[o,i]=Xe(),u=o(new n.TColgp_Array1OfPnt2d_2(1,e.length+2));u.SetValue(1,o(qe(t))),e.forEach((f,p)=>{u.SetValue(p+2,o(qe(f)))}),u.SetValue(e.length+2,o(qe(r)));const l=new n.Geom2d_BezierCurve_1(u);return i(),new Le(new n.Handle_Geom2d_Curve_2(l))},su=(t,e,r)=>{const n=Wi(Hr(t,e),.5),o=kt(r,t),i=er(aa(n,r));return Xi(t,Hr(Wi(i,o),r),e)},Jf=(t,e,r)=>{const n=er(aa(e,t)),o=[n[1],-n[0]],i=[o[0]*r,o[1]*r];return{firstPoint:Hr(t,i),lastPoint:Hr(e,i)}},$i=(t,e)=>{const r=xe(),n=t.geomType;if(n==="CIRCLE"){const f=r(r(t.adaptor()).Circle()),p=f.Radius(),d=f.IsDirect()?1:-1,y=e*d,m=p+y;if(m<1e-10){const A=r(f.Location()),B=[A.X(),A.Y()],F=q=>{const[z,ie]=er(aa(q,B));return Hr(q,[y*z,y*ie])};return{collapsed:!0,firstPoint:F(t.firstPoint),lastPoint:F(t.lastPoint)}}const S=N(),T=new S.gp_Circ2d_3(f.Axis(),m),x=new S.Geom2d_Circle_1(T),C=new S.Geom2d_TrimmedCurve(new S.Handle_Geom2d_Curve_2(x),t.firstParameter,t.lastParameter,!0,!0);return new Le(new S.Handle_Geom2d_Curve_2(C))}if(n==="LINE"){const{firstPoint:f,lastPoint:p}=Jf(t.firstPoint,t.lastPoint,e);return Tn(f,p)}const o=N(),i=new Le(new o.Handle_Geom2d_Curve_2(new o.Geom2d_OffsetCurve(t.wrapped,e,!0))),u=iu(i.adaptor());return qf(u).length?{collapsed:!0,firstPoint:u.firstPoint,lastPoint:u.lastPoint}:u};function uu(t,e,r){const n=zf(t.tangentAt(1),e.tangentAt(0));if(Math.abs(n)<1e-10)return null;const o=n>0?-1:1,i=Math.abs(r)*o,u=$i(t,i),l=$i(e,i);if(!(u instanceof Le)||!(l instanceof Le))return null;let f;try{const{intersections:S}=Sn(u,l,1e-9);f=S.at(-1)}catch{return null}if(!Co(f))return null;const p=f,d=(S,T)=>{const[x,C]=T.tangentAt(p),A=er([-C,x]),B=Hr(p,Wi(A,i)),F=S.parameter(B,1e-6);return S.splitAt([F])},[y]=d(t,u),[,m]=d(e,l);return{first:y,second:m,center:p}}function Yi(t,e,r){const n=uu(t,e,r);if(!n)return console.warn("Cannot fillet between curves",t.repr,e.repr),[t,e];const{first:o,second:i,center:u}=n;return[o,su(o.lastPoint,i.firstPoint,u),i]}function Zi(t,e,r){const n=uu(t,e,r);if(!n)return console.warn("Cannot chamfer between curves",t.repr,e.repr),[t,e];const{first:o,second:i}=n;return[o,Tn(o.lastPoint,i.firstPoint),i]}class eh{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(e,r){let n=this.length++;for(;n>0;){const o=n-1>>1,i=this.values[o];if(r>=i)break;this.ids[n]=this.ids[o],this.values[n]=i,n=o}this.ids[n]=e,this.values[n]=r}pop(){if(this.length===0)return;const e=this.ids[0];if(this.length--,this.length>0){const r=this.ids[0]=this.ids[this.length],n=this.values[0]=this.values[this.length],o=this.length>>1;let i=0;for(;i<o;){let u=(i<<1)+1;const l=u+1;let f=this.ids[u],p=this.values[u];const d=this.values[l];if(l<this.length&&d<p&&(u=l,f=this.ids[l],p=d),p>=n)break;this.ids[i]=f,this.values[i]=p,i=u}this.ids[i]=r,this.values[i]=n}return e}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const Ka=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Ai=3;class sa{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,n]=new Uint8Array(e,0,2);if(r!==251)throw new Error("Data does not appear to be in a Flatbush format.");if(n>>4!==Ai)throw new Error(`Got v${n>>4} data when expected v${Ai}.`);const[o]=new Uint16Array(e,2,1),[i]=new Uint32Array(e,4,1);return new sa(i,o,Ka[n&15],e)}constructor(e,r=16,n=Float64Array,o){if(e===void 0)throw new Error("Missing required argument: numItems.");if(isNaN(e)||e<=0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535);let i=e,u=i;this._levelBounds=[i*4];do i=Math.ceil(i/this.nodeSize),u+=i,this._levelBounds.push(u*4);while(i!==1);this.ArrayType=n||Float64Array,this.IndexArrayType=u<16384?Uint16Array:Uint32Array;const l=Ka.indexOf(this.ArrayType),f=u*4*this.ArrayType.BYTES_PER_ELEMENT;if(l<0)throw new Error(`Unexpected typed array class: ${n}.`);o&&o instanceof ArrayBuffer?(this.data=o,this._boxes=new this.ArrayType(this.data,8,u*4),this._indices=new this.IndexArrayType(this.data,8+f,u),this._pos=u*4,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new ArrayBuffer(8+f+u*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,u*4),this._indices=new this.IndexArrayType(this.data,8+f,u),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,(Ai<<4)+l]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e),this._queue=new eh}add(e,r,n,o){const i=this._pos>>2;return this._indices[i]=i,this._boxes[this._pos++]=e,this._boxes[this._pos++]=r,this._boxes[this._pos++]=n,this._boxes[this._pos++]=o,e<this.minX&&(this.minX=e),r<this.minY&&(this.minY=r),n>this.maxX&&(this.maxX=n),o>this.maxY&&(this.maxY=o),i}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);if(this.numItems<=this.nodeSize){this._boxes[this._pos++]=this.minX,this._boxes[this._pos++]=this.minY,this._boxes[this._pos++]=this.maxX,this._boxes[this._pos++]=this.maxY;return}const e=this.maxX-this.minX||1,r=this.maxY-this.minY||1,n=new Uint32Array(this.numItems),o=(1<<16)-1;for(let i=0;i<this.numItems;i++){let u=4*i;const l=this._boxes[u++],f=this._boxes[u++],p=this._boxes[u++],d=this._boxes[u++],y=Math.floor(o*((l+p)/2-this.minX)/e),m=Math.floor(o*((f+d)/2-this.minY)/r);n[i]=rh(y,m)}qi(n,this._boxes,this._indices,0,this.numItems-1,this.nodeSize);for(let i=0,u=0;i<this._levelBounds.length-1;i++){const l=this._levelBounds[i];for(;u<l;){const f=u;let p=1/0,d=1/0,y=-1/0,m=-1/0;for(let S=0;S<this.nodeSize&&u<l;S++)p=Math.min(p,this._boxes[u++]),d=Math.min(d,this._boxes[u++]),y=Math.max(y,this._boxes[u++]),m=Math.max(m,this._boxes[u++]);this._indices[this._pos>>2]=f,this._boxes[this._pos++]=p,this._boxes[this._pos++]=d,this._boxes[this._pos++]=y,this._boxes[this._pos++]=m}}}search(e,r,n,o,i){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const l=[],f=[];for(;u!==void 0;){const p=Math.min(u+this.nodeSize*4,Ja(u,this._levelBounds));for(let d=u;d<p;d+=4){if(n<this._boxes[d]||o<this._boxes[d+1]||e>this._boxes[d+2]||r>this._boxes[d+3])continue;const y=this._indices[d>>2]|0;u<this.numItems*4?(i===void 0||i(y))&&f.push(y):l.push(y)}u=l.pop()}return f}neighbors(e,r,n=1/0,o=1/0,i){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let u=this._boxes.length-4;const l=this._queue,f=[],p=o*o;for(;u!==void 0;){const d=Math.min(u+this.nodeSize*4,Ja(u,this._levelBounds));for(let y=u;y<d;y+=4){const m=this._indices[y>>2]|0,S=Qa(e,this._boxes[y],this._boxes[y+2]),T=Qa(r,this._boxes[y+1],this._boxes[y+3]),x=S*S+T*T;u<this.numItems*4?(i===void 0||i(m))&&l.push((m<<1)+1,x):l.push(m<<1,x)}for(;l.length&&l.peek()&1;)if(l.peekValue()>p||(f.push(l.pop()>>1),f.length===n))return l.clear(),f;u=l.pop()>>1}return l.clear(),f}}function Qa(t,e,r){return t<e?e-t:t<=r?0:t-r}function Ja(t,e){let r=0,n=e.length-1;for(;r<n;){const o=r+n>>1;e[o]>t?n=o:r=o+1}return e[r]}function qi(t,e,r,n,o,i){if(Math.floor(n/i)>=Math.floor(o/i))return;const u=t[n+o>>1];let l=n-1,f=o+1;for(;;){do l++;while(t[l]<u);do f--;while(t[f]>u);if(l>=f)break;th(t,e,r,l,f)}qi(t,e,r,n,f,i),qi(t,e,r,f+1,o,i)}function th(t,e,r,n,o){const i=t[n];t[n]=t[o],t[o]=i;const u=4*n,l=4*o,f=e[u],p=e[u+1],d=e[u+2],y=e[u+3];e[u]=e[l],e[u+1]=e[l+1],e[u+2]=e[l+2],e[u+3]=e[l+3],e[l]=f,e[l+1]=p,e[l+2]=d,e[l+3]=y;const m=r[n];r[n]=r[o],r[o]=m}function rh(t,e){let r=t^e,n=65535^r,o=65535^(t|e),i=t&(e^65535),u=r|n>>1,l=r>>1^r,f=o>>1^n&i>>1^o,p=r&o>>1^i>>1^i;r=u,n=l,o=f,i=p,u=r&r>>2^n&n>>2,l=r&n>>2^n&(r^n)>>2,f^=r&o>>2^n&i>>2,p^=n&o>>2^(r^n)&i>>2,r=u,n=l,o=f,i=p,u=r&r>>4^n&n>>4,l=r&n>>4^n&(r^n)>>4,f^=r&o>>4^n&i>>4,p^=n&o>>4^(r^n)&i>>4,r=u,n=l,o=f,i=p,f^=r&o>>8^n&i>>8,p^=n&o>>8^(r^n)&i>>8,r=f^f>>1,n=p^p>>1;let d=t^e,y=n|65535^(d|r);return d=(d|d<<8)&16711935,d=(d|d<<4)&252645135,d=(d|d<<2)&858993459,d=(d|d<<1)&1431655765,y=(y|y<<8)&16711935,y=(y|y<<4)&252645135,y=(y|y<<2)&858993459,y=(y|y<<1)&1431655765,(y<<1|d)>>>0}const nh=(t,e=1e-7)=>{const r=new sa(t.length);t.forEach(i=>{const[u,l]=i.firstPoint;r.add(u-e,l-e,u+e,l+e)}),r.finish();const n=[],o=new Set;return t.forEach((i,u)=>{if(o.has(u))return;const l=[i];let f=u;o.add(u);let p=t.length;for(;;){if(p--<0)throw new Error("Infinite loop detected");const d=l[l.length-1].lastPoint,[y,m]=d,S=r.search(y-e,m-e,y+e,m+e),T=B=>Math.abs((f-B)%t.length),x=S.filter(B=>!o.has(B)).map(B=>[t[B],B,T(B)]).sort(([,,B],[,,F])=>T(B)-T(F));if(x.length===0){n.push(l);break}const[C,A]=x[0];l.push(C),o.add(A),f=A}}),n};function yt(t){return Math.round(t*1e5)/1e5}const Oi=t=>`${Po(t.X())} ${Po(t.Y())}`,oh=(t,e)=>{const r=N(),n=_n(t.GetType()),[o,i]=e,u=`${yt(o)} ${yt(i)}`;if(n==="LINE")return`L ${u}`;if(n==="BEZIER_CURVE"){const l=t.Bezier().get(),f=l.Degree();if(f===1)return`L ${u}`;if(f===2)return`Q ${Oi(l.Pole(2))} ${u}`;if(f===3){const p=Oi(l.Pole(2)),d=Oi(l.Pole(3));return`C ${p} ${d} ${u}`}}if(n==="CIRCLE"){const l=t.Circle(),f=l.Radius(),p=t.FirstParameter(),y=(t.LastParameter()-p)*ln,m=y!==360?u:`${yt(o)} ${yt(i+1e-4)}`;return`A ${f} ${f} 0 ${Math.abs(y)>180?"1":"0"} ${l.IsDirect()?"1":"0"} ${m}`}if(n==="ELLIPSE"){const l=t.Ellipse(),f=l.MajorRadius(),p=l.MinorRadius(),d=t.FirstParameter(),m=(t.LastParameter()-d)*ln,S=m!==360?u:`${yt(o)} ${yt(i+1e-4)}`,T=new r.gp_Dir2d_1,x=180-l.XAxis().Direction().Angle(T)*ln;return T.delete(),`A ${yt(f)} ${yt(p)} ${yt(x)} ${Math.abs(m)>180?"1":"0"} ${l.IsDirect()?"1":"0"} ${S}`}throw new Error(`Unsupported curve type: ${n}`)},ih={X:[1,0,0],Y:[0,1,0],Z:[0,0,1]},Ao={YZ:[1,0,0],XZ:[0,1,0],XY:[0,0,1]};class lu{constructor(){this.filters=[]}delete(){this.filters=[]}and(e){return e.forEach(r=>r(this)),this}not(e){const r=new this.constructor;e(r);const n=({element:o})=>!r.shouldKeep(o);return this.filters.push(n),this}either(e){const r=e.map(o=>{const i=new this.constructor;return o(i),i}),n=({element:o})=>r.some(i=>i.shouldKeep(o));return this.filters.push(n),this}find(e,{unique:r=!1}={}){const n=this.applyFilter(e);if(r){if(n.length!==1)throw console.error(n),new Error("Finder has not found a unique solution");return n[0]}return n}}class ah extends ht{constructor(){const e=N();super(new e.Message_ProgressRange_1)}}class Ri extends ht{constructor(e){const r=N();super(new r.BRepExtrema_DistShapeShape_1),this.wrapped.LoadS1(e.wrapped)}distanceTo(e){this.wrapped.LoadS2(e.wrapped);const r=new ah;return this.wrapped.Perform(r.wrapped),this.wrapped.Value()}}class cu extends lu{when(e){return this.filters.push(e),this}inList(e){const r=({element:n})=>!!e.find(o=>o.isSame(n));return this.filters.push(r),this}atAngleWith(e="Z",r=0){let n;typeof e=="string"?n=new M(ih[e]):n=new M(e);const o=({normal:i})=>{if(!i)return!1;const u=Math.acos(Math.abs(i.dot(n)));return Math.abs(u-wt*r)<1e-6};return this.filters.push(o),this}atDistance(e,r=[0,0,0]){const n=Do(r),o=new Ri(n),i=({element:u})=>Math.abs(o.distanceTo(u)-e)<1e-6;return this.filters.push(i),this}containsPoint(e){return this.atDistance(0,e)}withinDistance(e,r=[0,0,0]){const n=Do(r),o=new Ri(n),i=({element:u})=>o.distanceTo(u)-e<1e-6;return this.filters.push(i),this}inBox(e,r){const n=fe(e,r);return this.inShape(n)}inShape(e){const r=new Ri(e),n=({element:o})=>r.distanceTo(o)<1e-6;return this.filters.push(n),this}}class Oo extends cu{clone(){const e=new Oo;return e.filters=[...this.filters],e}inDirection(e){return this.atAngleWith(e,0)}ofLength(e){const r=({element:n})=>typeof e=="number"?Math.abs(n.length-e)<1e-9:e(n.length);return this.filters.push(r),this}ofCurveType(e){const r=({element:n})=>n.geomType===e;return this.filters.push(r),this}parallelTo(e){if(typeof e=="string"&&Ao[e])return this.atAngleWith(Ao[e],90);if(typeof e!="string"&&e instanceof tt)return this.atAngleWith(e.zDir,90);if(typeof e!="string"&&e.normalAt){const r=e.normalAt();return this.atAngleWith(r,90),this}return this}inPlane(e,r){const n=e instanceof tt?or(e):or(e,r);this.parallelTo(n);const o=({element:i})=>{const u=i.startPoint,l=u.projectToPlane(n);return u.equals(l)};return this.filters.push(o),this}shouldKeep(e){let r=null;try{r=e.tangentAt().normalized()}catch(n){console.error("failed to compute a normal",n)}return this.filters.every(n=>n({normal:r,element:e}))}applyFilter(e){return e.edges.filter(r=>this.shouldKeep(r))}}class ua extends cu{clone(){const e=new ua;return e.filters=[...this.filters],e}parallelTo(e){if(typeof e=="string"&&Ao[e])return this.atAngleWith(Ao[e]);if(typeof e!="string"&&e instanceof tt)return this.atAngleWith(e.zDir);if(typeof e!="string"&&e.normalAt){const r=e.normalAt();return this.atAngleWith(r),this}return this}ofSurfaceType(e){const r=({element:n})=>n.geomType===e;return this.filters.push(r),this}inPlane(e,r){const n=e instanceof tt?or(e):or(e,r);this.parallelTo(n);const o=({element:i})=>{const u=i.center,l=u.projectToPlane(n);return u.equals(l)};return this.filters.push(o),this}shouldKeep(e){const r=e.normalAt();return this.filters.every(o=>o({normal:r,element:e}))}applyFilter(e){return e.faces.filter(r=>this.shouldKeep(r))}}const sh=function(t){return t.curves.map((e,r)=>({firstCurve:e,secondCurve:t.curves[(r+1)%t.curves.length],point:e.lastPoint}))},Di=2*Math.PI,es=t=>{const e=t%Di,r=e<0?e+Di:e;return r<Math.PI?r:r===Math.PI?0:Math.abs(r-Di)};class Ro extends lu{clone(){const e=new Ro;return e.filters=[...this.filters],e}inList(e){const r=({element:n})=>!!e.find(o=>Qe(o,n.point));return this.filters.push(r),this}atDistance(e,r=[0,0]){function n({element:o}){return Math.abs(kt(r,o.point)-e)<1e-9}return this.filters.push(n),this}atPoint(e){function r({element:n}){return Qe(e,n.point)}return this.filters.push(r),this}inBox(e,r){const[n,o]=e,[i,u]=r,l=Math.min(n,i),f=Math.max(n,i),p=Math.min(o,u),d=Math.max(o,u);function y({element:m}){const[S,T]=m.point;return S>=l&&S<=f&&T>=p&&T<=d}return this.filters.push(y),this}ofAngle(e){function r({element:n}){const o=n.firstCurve.tangentAt(1),i=n.secondCurve.tangentAt(0);return Math.abs(es(Wf(o,i))-es(wt*e))<1e-9}return this.filters.push(r),this}shouldKeep(e){return this.filters.every(n=>n({normal:null,element:e}))}applyFilter(e){return sh(e).filter(r=>this.shouldKeep(r))}}const ts=t=>{const e=N();return{vertex:e.TopAbs_ShapeEnum.TopAbs_VERTEX,wire:e.TopAbs_ShapeEnum.TopAbs_WIRE,face:e.TopAbs_ShapeEnum.TopAbs_FACE,shell:e.TopAbs_ShapeEnum.TopAbs_SHELL,solid:e.TopAbs_ShapeEnum.TopAbs_SOLID,solidCompound:e.TopAbs_ShapeEnum.TopAbs_COMPSOLID,compound:e.TopAbs_ShapeEnum.TopAbs_COMPOUND,edge:e.TopAbs_ShapeEnum.TopAbs_EDGE,shape:e.TopAbs_ShapeEnum.TopAbs_SHAPE}[t]},uh=function*(e,r){const n=N(),o=new n.TopExp_Explorer_2(e,ts(r),ts("shape")),i=new Map;for(;o.More();){const u=o.Current(),l=u.HashCode(tu);i.get(l)||(i.set(l,!0),yield u),o.Next()}o.delete()},fu=t=>{if(t.IsNull())throw new Error("This shape has not type, it is null");return t.ShapeType()};class $o extends ht{constructor(e){super(e)}clone(){return new this.constructor(wr(this.wrapped))}get hashCode(){return this.wrapped.HashCode(tu)}get isNull(){return this.wrapped.IsNull()}isSame(e){return this.wrapped.IsSame(e.wrapped)}isEqual(e){return this.wrapped.IsEqual(e.wrapped)}simplify(){const e=N(),r=new e.ShapeUpgrade_UnifySameDomain_2(this.wrapped,!0,!0,!1);r.Build();const n=Ae(r.Shape());if(r.delete(),this.constructor!==n.constructor)throw new Error("unexpected types mismatch");return n}translate(e,r=0,n=0){const o=typeof e=="number"?[e,r,n]:e,i=Ae(Lf(this.wrapped,o));if(this.delete(),this.constructor!==i.constructor)throw new Error("unexpected types mismatch");return i}translateX(e){return this.translate([e,0,0])}translateY(e){return this.translate([0,e,0])}translateZ(e){return this.translate([0,0,e])}rotate(e,r=[0,0,0],n=[0,0,1]){const o=Ae(Bf(this.wrapped,e,r,n));if(this.delete(),this.constructor!==o.constructor)throw new Error("unexpected types mismatch");return o}mirror(e,r){const n=Ae(Uf(this.wrapped,e,r));if(this.delete(),this.constructor!==n.constructor)throw new Error("unexpected types mismatch");return n}scale(e,r=[0,0,0]){const n=Ae(If(this.wrapped,r,e));if(this.delete(),this.constructor!==n.constructor)throw new Error("unexpected types mismatch");return n}_iterTopo(e){return uh(this.wrapped,e)}_listTopo(e){return Array.from(this._iterTopo(e)).map(r=>wr(r))}get edges(){return this._listTopo("edge").map(e=>new ar(e))}get faces(){return this._listTopo("face").map(e=>new Wr(e))}get wires(){return this._listTopo("wire").map(e=>new Wt(e))}get boundingBox(){const e=new Ff;return this.oc.BRepBndLib.Add(this.wrapped,e.wrapped,!0),e}_mesh({tolerance:e=.001,angularTolerance:r=.1}={}){new this.oc.BRepMesh_IncrementalMesh_2(this.wrapped,e,!1,r,!1)}mesh({tolerance:e=.001,angularTolerance:r=.1}={}){this._mesh({tolerance:e,angularTolerance:r});let n=[],o=[],i=[];const u=[];for(const l of this.faces){const f=l.triangulation(o.length/3);if(!f)continue;const{trianglesIndexes:p,vertices:d,verticesNormals:y}=f;u.push({start:n.length,count:p.length,faceId:l.hashCode}),n=n.concat(p),o=o.concat(d),i=i.concat(y)}return{triangles:n,vertices:o,normals:i,faceGroups:u}}meshEdges({tolerance:e=.001,angularTolerance:r=.1}={}){var n;const o=xe(),i=new Set,u=[],l=[],f=()=>{const d=u.length;let y=null;return[m=>{y?(u.push(...y),y=[m.X(),m.Y(),m.Z()],u.push(...y)):y=[m.X(),m.Y(),m.Z()]},m=>{l.push({start:d/3,count:(u.length-d)/3,edgeId:m}),i.add(m)}]},p=o(new this.oc.TopLoc_Location_1);for(const d of this.faces){const y=o(this.oc.BRep_Tool.Triangulation(d.wrapped,p,0));if(y.IsNull())continue;const m=y.get();for(const S of d.edges){if(o(S),i.has(S.hashCode))continue;const T=o(new this.oc.TopLoc_Location_1),x=o(this.oc.BRep_Tool.PolygonOnTriangulation_1(S.wrapped,y,T)),C=(n=x==null?void 0:x.get())==null?void 0:n.Nodes();if(!C)continue;o(C);const[A,B]=f();for(let F=C.Lower();F<=C.Upper();F++){const q=o(o(m.Node(C.Value(F))).Transformed(T.Transformation()));A(q)}B(S.hashCode)}}for(const d of this.edges){o(d);const y=d.hashCode;if(i.has(y))continue;const m=o(new this.oc.BRepAdaptor_Curve_2(d.wrapped)),S=o(new this.oc.GCPnts_TangentialDeflection_2(m,e,r,2,1e-9,1e-7)),[T,x]=f();for(let C=0;C<S.NbPoints();C++){const A=o(S.Value(C+1).Transformed(p.Transformation()));T(A)}x(y)}return{lines:u,edgeGroups:l}}blobSTEP(){const e="blob.step",r=new this.oc.STEPControl_Writer_1;this.oc.Interface_Static.SetIVal("write.step.schema",5),r.Model(!0).delete();const n=new this.oc.Message_ProgressRange_1;r.Transfer(this.wrapped,this.oc.STEPControl_StepModelType.STEPControl_AsIs,!0,n);const o=r.Write(e);if(r.delete(),n.delete(),o===this.oc.IFSelect_ReturnStatus.IFSelect_RetDone){const i=this.oc.FS.readFile("/"+e);return this.oc.FS.unlink("/"+e),new Blob([i],{type:"application/STEP"})}else throw new Error("WRITE STEP FILE FAILED.")}blobSTL({tolerance:e=.001,angularTolerance:r=.1,binary:n=!1}={}){this._mesh({tolerance:e,angularTolerance:r});const o="blob.stl";if(this.oc.StlAPI.Write(this.wrapped,o,!n)){const u=this.oc.FS.readFile("/"+o);return this.oc.FS.unlink("/"+o),new Blob([u],{type:"application/sla"})}else throw new Error("WRITE STL FILE FAILED.")}}class hu extends $o{}class pu extends $o{get repr(){const{startPoint:e,endPoint:r}=this,n=`start: (${this.startPoint.repr}) end:(${this.endPoint.repr})`;return e.delete(),r.delete(),n}get curve(){return new lh(this._geomAdaptor())}get startPoint(){return this.curve.startPoint}get endPoint(){return this.curve.endPoint}tangentAt(e=0){return this.curve.tangentAt(e)}pointAt(e=0){return this.curve.pointAt(e)}get isClosed(){return this.curve.isClosed}get isPeriodic(){return this.curve.isPeriodic}get period(){return this.curve.period}get geomType(){return this.curve.curveType}get length(){const e=new this.oc.GProp_GProps_1;this.oc.BRepGProp.LinearProperties(this.wrapped,e,!0,!1);const r=e.Mass();return e.delete(),r}get orientation(){return this.wrapped.Orientation_1()===this.oc.TopAbs_Orientation.TopAbs_FORWARD?"forward":"backward"}}class lh extends ht{get repr(){const{startPoint:e,endPoint:r}=this,n=`start: (${this.startPoint.repr}) end:(${this.endPoint.repr}}`;return e.delete(),r.delete(),n}get curveType(){const e=this.wrapped.GetType&&this.wrapped.GetType();return _n(e)}get startPoint(){const e=this.wrapped.Value(this.wrapped.FirstParameter());return new M(e)}get endPoint(){const e=this.wrapped.Value(this.wrapped.LastParameter());return new M(e)}_mapParameter(e){const r=this.wrapped.FirstParameter(),n=this.wrapped.LastParameter();return r+(n-r)*e}pointAt(e=.5){return new M(this.wrapped.Value(this._mapParameter(e)))}tangentAt(e=.5){const r=this._mapParameter(e),n=new this.oc.gp_Pnt_1,o=new this.oc.gp_Vec_1;this.wrapped.D1(r,n,o);const i=new M(o);return n.delete(),o.delete(),i}get isClosed(){return this.wrapped.IsClosed()}get isPeriodic(){return this.wrapped.IsPeriodic()}get period(){return this.wrapped.Period()}}class ar extends pu{_geomAdaptor(){return new this.oc.BRepAdaptor_Curve_2(this.wrapped)}}class Wt extends pu{_geomAdaptor(){return new this.oc.BRepAdaptor_CompCurve_2(this.wrapped,!1)}offset2D(e,r="arc"){const n={arc:this.oc.GeomAbs_JoinType.GeomAbs_Arc,intersection:this.oc.GeomAbs_JoinType.GeomAbs_Intersection,tangent:this.oc.GeomAbs_JoinType.GeomAbs_Tangent},o=new this.oc.BRepOffsetAPI_MakeOffset_3(this.wrapped,n[r],!1);o.Perform(e,0);const i=Ae(o.Shape());if(o.delete(),this.delete(),!(i instanceof Wt))throw new Error("Could not offset with a wire");return i}}class ch extends ht{get surfaceType(){const e=this.oc.GeomAbs_SurfaceType,n=new Map([[e.GeomAbs_Plane,"PLANE"],[e.GeomAbs_Cylinder,"CYLINDRE"],[e.GeomAbs_Cone,"CONE"],[e.GeomAbs_Sphere,"SPHERE"],[e.GeomAbs_Torus,"TORUS"],[e.GeomAbs_BezierSurface,"BEZIER_SURFACE"],[e.GeomAbs_BSplineSurface,"BSPLINE_SURFACE"],[e.GeomAbs_SurfaceOfRevolution,"REVOLUTION_SURFACE"],[e.GeomAbs_SurfaceOfExtrusion,"EXTRUSION_SURFACE"],[e.GeomAbs_OffsetSurface,"OFFSET_SURFACE"],[e.GeomAbs_OtherSurface,"OTHER_SURFACE"]]).get(this.wrapped.GetType());if(!n)throw new Error("surface type not found");return n}}class Wr extends $o{_geomAdaptor(){return new this.oc.BRepAdaptor_Surface_2(this.wrapped,!1)}get surface(){return new ch(this._geomAdaptor())}get orientation(){return this.wrapped.Orientation_1()===this.oc.TopAbs_Orientation.TopAbs_FORWARD?"forward":"backward"}get geomType(){const e=this.surface,r=e.surfaceType;return e.delete(),r}get UVBounds(){const e={current:0},r={current:0},n={current:0},o={current:0};return this.oc.BRepTools.UVBounds_1(this.wrapped,e,r,n,o),{uMin:e.current,uMax:r.current,vMin:n.current,vMax:o.current}}pointOnSurface(e,r){const{uMin:n,uMax:o,vMin:i,vMax:u}=this.UVBounds,l=this._geomAdaptor(),f=new this.oc.gp_Pnt_1,p=e*(o-n)+n,d=r*(u-i)+i;l.D0(p,d,f);const y=new M(f);return l.delete(),f.delete(),y}normalAt(e){let r=0,n=0;const o=xe();if(e){const p=o(this.oc.BRep_Tool.Surface_2(this.wrapped)),d=o(new this.oc.GeomAPI_ProjectPointOnSurf_2(o(ft(e)),p,this.oc.Extrema_ExtAlgo.Extrema_ExtAlgo_Grad)),y={current:0},m={current:0};d.LowerDistanceParameters(y,m),r=y.current,n=m.current}else{const{uMin:p,uMax:d,vMin:y,vMax:m}=this.UVBounds;r=.5*(p+d),n=.5*(y+m)}const i=o(new this.oc.gp_Pnt_1),u=o(new this.oc.gp_Vec_1);return o(new this.oc.BRepGProp_Face_2(this.wrapped,!1)).Normal(r,n,i,u),new M(u)}get center(){const e=new this.oc.GProp_GProps_1;this.oc.BRepGProp.SurfaceProperties_2(this.wrapped,e,1e-7,!0);const r=new M(e.CentreOfMass());return e.delete(),r}outerWire(){const e=new Wt(this.oc.BRepTools.OuterWire(this.wrapped));return this.delete(),e}innerWires(){const e=this.clone().outerWire(),r=this.wires.filter(n=>!e.isSame(n));return e.delete(),this.delete(),r}triangulation(e=0){const r=xe(),n=r(new this.oc.TopLoc_Location_1),o=r(this.oc.BRep_Tool.Triangulation(this.wrapped,n,0));if(o.IsNull())return null;const i=r(n.Transformation()),u={vertices:[],trianglesIndexes:[],verticesNormals:[]},l=o.get(),f=l.NbNodes();u.vertices=new Array(f*3);for(let T=1;T<=f;T++){const x=r(r(l.Node(T)).Transformed(i));u.vertices[(T-1)*3+0]=x.X(),u.vertices[(T-1)*3+1]=x.Y(),u.vertices[(T-1)*3+2]=x.Z()}const p=r(new this.oc.TColgp_Array1OfDir_2(1,f)),d=r(new this.oc.Poly_Connect_2(o));this.oc.StdPrs_ToolTriangulatedShape.Normal(this.wrapped,d,p),u.verticesNormals=new Array(p.Length()*3);for(let T=p.Lower();T<=p.Upper();T++){const x=r(r(p.Value(T)).Transformed(i));u.verticesNormals[(T-1)*3+0]=x.X(),u.verticesNormals[(T-1)*3+1]=x.Y(),u.verticesNormals[(T-1)*3+2]=x.Z()}const y=this.orientation,m=l.NbTriangles();u.trianglesIndexes=new Array(m*3);let S=0;for(let T=1;T<=m;T++){const x=r(l.Triangle(T));let C=x.Value(1),A=x.Value(2);const B=x.Value(3);if(y==="backward"){const F=C;C=A,A=F}u.trianglesIndexes[S*3+0]=C-1+e,u.trianglesIndexes[S*3+1]=A-1+e,u.trianglesIndexes[S*3+2]=B-1+e,S++}return u}}class Yo extends $o{fuse(e,{optimisation:r="none"}={}){const n=xe(),o=n(new this.oc.Message_ProgressRange_1),i=n(new this.oc.BRepAlgoAPI_Fuse_3(this.wrapped,e.wrapped,o));r==="commonFace"&&i.SetGlue(this.oc.BOPAlgo_GlueEnum.BOPAlgo_GlueShift),r==="sameFace"&&i.SetGlue(this.oc.BOPAlgo_GlueEnum.BOPAlgo_GlueFull),i.Build(o),i.SimplifyResult(!0,!0,.001);const u=Ae(i.Shape());if(!Gt(u))throw new Error("Could not fuse as a 3d shape");return u}cut(e,{optimisation:r="none"}={}){const n=xe(),o=n(new this.oc.Message_ProgressRange_1),i=n(new this.oc.BRepAlgoAPI_Cut_3(this.wrapped,e.wrapped,o));r==="commonFace"&&i.SetGlue(this.oc.BOPAlgo_GlueEnum.BOPAlgo_GlueShift),r==="sameFace"&&i.SetGlue(this.oc.BOPAlgo_GlueEnum.BOPAlgo_GlueFull),i.Build(o),i.SimplifyResult(!0,!0,.001);const u=Ae(i.Shape());if(!Gt(u))throw new Error("Could not cut as a 3d shape");return u}intersect(e){const r=xe(),n=r(new this.oc.Message_ProgressRange_1),o=r(new this.oc.BRepAlgoAPI_Common_3(this.wrapped,e.wrapped,n));o.Build(n),o.SimplifyResult(!0,!0,.001);const i=Ae(o.Shape());if(!Gt(i))throw new Error("Could not intersect as a 3d shape");return i}shell(e,r=null,n=.001){const o=typeof r=="number"?r:n;let i,u;if(typeof e=="number"){u=e;const S=new ua;i=typeof r=="function"?r(S):S}else u=e.thickness,i=e.filter;const l=xe(),f=i.find(this),p=l(new this.oc.TopTools_ListOfShape_1);f.forEach(S=>{p.Append_1(S.wrapped)});const d=l(new this.oc.Message_ProgressRange_1),y=l(new this.oc.BRepOffsetAPI_MakeThickSolid);y.MakeThickSolidByJoin(this.wrapped,p,-u,o,this.oc.BRepOffset_Mode.BRepOffset_Skin,!1,!1,this.oc.GeomAbs_JoinType.GeomAbs_Arc,!1,d);const m=Ae(y.Shape());if(!Gt(m))throw new Error("Could not shell as a 3d shape");return m}_builderIter(e,r){if(typeof e=="number"){let u=0;for(const l of this._iterTopo("edge"))r(e,wr(l)),u+=1;return u}let n,o=null;typeof e=="function"?n=e:(n=u=>e.filter.shouldKeep(u)?e.radius||1:0,e.filter&&!e.keep&&(o=()=>e.filter.delete()));let i=0;for(const u of this._iterTopo("edge")){const l=wr(u),f=new ar(l),p=n(f);p&&(r(p,l),i+=1),f.delete()}return o&&o(),i}fillet(e,r){const o=xe()(new this.oc.BRepFilletAPI_MakeFillet(this.wrapped,this.oc.ChFi3d_FilletShape.ChFi3d_Rational));let i=e;if(typeof e=="number"&&r&&(i={radius:e,filter:r(new Oo)}),!this._builderIter(i,(f,p)=>o.Add_2(f,p)))throw new Error("Could not fillet, no edge was selected");const l=Ae(o.Shape());if(!Gt(l))throw new Error("Could not fillet as a 3d shape");return l}chamfer(e,r){const o=xe()(new this.oc.BRepFilletAPI_MakeChamfer(this.wrapped));let i=e;if(typeof e=="number"&&r&&(i={radius:e,filter:r(new Oo)}),!this._builderIter(i,(f,p)=>o.Add_2(f,p)))throw new Error("Could not chamfer, no edge was selected");const l=Ae(o.Shape());if(!Gt(l))throw new Error("Could not chamfer as a 3d shape");return l}}class du extends Yo{}class br extends Yo{}class vu extends Yo{}class gu extends Yo{}function Gt(t){return t instanceof du||t instanceof br||t instanceof vu||t instanceof gu}function rs(t){return t instanceof Wt}function wr(t){const e=N(),r=e.TopAbs_ShapeEnum,n=new Map([[r.TopAbs_EDGE,e.TopoDS.Edge_1],[r.TopAbs_WIRE,e.TopoDS.Wire_1],[r.TopAbs_FACE,e.TopoDS.Face_1],[r.TopAbs_SHELL,e.TopoDS.Shell_1],[r.TopAbs_SOLID,e.TopoDS.Solid_1],[r.TopAbs_COMPSOLID,e.TopoDS.CompSolid_1],[r.TopAbs_COMPOUND,e.TopoDS.Compound_1]]),o=fu(t),i=n.get(o);if(!i)throw new Error("Could not find a wrapper for this shape type");return i(t)}function Ae(t){const r=N().TopAbs_ShapeEnum,o=new Map([[r.TopAbs_VERTEX,hu],[r.TopAbs_EDGE,ar],[r.TopAbs_WIRE,Wt],[r.TopAbs_FACE,Wr],[r.TopAbs_SHELL,du],[r.TopAbs_SOLID,br],[r.TopAbs_COMPSOLID,vu],[r.TopAbs_COMPOUND,gu]]).get(fu(t));if(!o)throw new Error("Could not find a wrapper for this shape type");return new o(wr(t))}const mu=(t,e)=>{const r=N();return new ar(new r.BRepBuilderAPI_MakeEdge_3(ft(t),ft(e)).Edge())},fh=(t,e=[0,0,0],r=[0,0,1])=>{const n=N(),[o,i]=Xe(),u=o(Xo(e,r)),l=o(new n.gp_Circ_2(u,t)),f=o(new n.BRepBuilderAPI_MakeEdge_8(l)),p=new ar(f.Edge());return i(),p},hh=(t,e,r,n=[0,0,0],o=[0,0,1],i=!1)=>{const u=N(),[l,f]=Xe();let p=2*Math.PI;i&&(p=-2*Math.PI);const d=l(new u.Geom2d_Line_3(l(new u.gp_Pnt2d_3(0,0)),l(new u.gp_Dir2d_4(p,t)))),y=e/t,m=d.Value(0),S=d.Value(y*Math.sqrt((2*Math.PI)**2+t**2)),T=l(new u.GCE2d_MakeSegment_1(m,S)),x=new u.Geom_CylindricalSurface_1(l(pn(n,o)),r),C=l(new u.BRepBuilderAPI_MakeEdge_30(l(new u.Handle_Geom2d_Curve_2(T.Value().get())),l(new u.Handle_Geom_Surface_2(x)))).Edge(),A=l(new u.BRepBuilderAPI_MakeWire_2(C)).Wire();return u.BRepLib.BuildCurves3d_2(A),f(),new Wt(A)},dn=t=>{const e=N(),r=new e.BRepBuilderAPI_MakeWire_1;t.forEach(u=>{u instanceof ar&&r.Add_1(u.wrapped),u instanceof Wt&&r.Add_2(u.wrapped)});const n=new e.Message_ProgressRange_1;r.Build(n);const o=r.Error();if(o!==e.BRepBuilderAPI_WireError.BRepBuilderAPI_WireDone){const u=new Map([[e.BRepBuilderAPI_WireError.BRepBuilderAPI_EmptyWire,"empty wire"],[e.BRepBuilderAPI_WireError.BRepBuilderAPI_NonManifoldWire,"non manifold wire"],[e.BRepBuilderAPI_WireError.BRepBuilderAPI_DisconnectedWire,"disconnected wire"]]);throw new Error(`Failed to build the wire, ${u.get(o)||"unknown error"}`)}const i=new Wt(r.Wire());return r.delete(),n.delete(),i},_o=(t,e)=>{const r=N(),n=new r.BRepBuilderAPI_MakeFace_15(t.wrapped,!1);if(e==null||e.forEach(i=>{n.Add(i.wrapped)}),!n.IsDone())throw n.delete(),new Error("Failed to build the face. Your wire might be non planar.");const o=n.Face();return n.delete(),new Wr(o)},ph=(t,e)=>{const r=N(),[n,o]=Xe(),i=n(r.BRep_Tool.Surface_2(t.wrapped)),l=n(new r.BRepBuilderAPI_MakeFace_21(i,e.wrapped,!0)).Face();return o(),new Wr(l)},dr=(t,e,r=[0,0,0],n=[0,0,1])=>{const o=N(),i=Xo(r,n),u=new o.BRepPrimAPI_MakeCylinder_3(i,t,e),l=new br(u.Shape());return i.delete(),u.delete(),l},dh=t=>{const e=N(),r=new e.BRepPrimAPI_MakeSphere_1(t),n=new br(r.Shape());return r.delete(),n};class vh extends ht{constructor(e,r,n){const o=N(),i=xe(),u=Math.sqrt(e*r/n),l=e/u,f=r/u,p=new o.gp_GTrsf_1;p.SetAffinity_1(cn([0,0,0],[0,1,0]),l);const d=i(new o.gp_GTrsf_1);d.SetAffinity_1(cn([0,0,0],[0,0,1]),u);const y=i(new o.gp_GTrsf_1);y.SetAffinity_1(cn([0,0,0],[1,0,0]),f),p.Multiply(d),p.Multiply(y),super(p)}applyToPoint(e){const r=N(),o=xe()(e.XYZ());return this.wrapped.Transforms_1(o),new r.gp_Pnt_2(o)}}function gh(t){const e=[];for(let r=t.LowerRow();r<=t.UpperRow();r++){const n=[];e.push(n);for(let o=t.LowerCol();o<=t.UpperCol();o++){const i=t.Value(r,o);n.push(i)}}return e}const mh=(t,e,r)=>{const n=N(),o=xe(),i=o(new n.gp_Sphere_1);i.SetRadius(1);const u=o(new n.Geom_SphericalSurface_2(i)),l=n.GeomConvert.SurfaceToBSplineSurface(u.UReversed()).get(),f=gh(l.Poles_2()),p=new vh(t,e,r);f.forEach((y,m)=>{y.forEach((S,T)=>{const x=p.applyToPoint(S);l.SetPole_1(m+1,T+1,x)})});const d=Ae(o(new n.BRepBuilderAPI_MakeShell_2(l.UReversed(),!1)).Shell());return la([d])},fe=(t,e)=>{const r=N(),n=new r.BRepPrimAPI_MakeBox_4(ft(t),ft(e)),o=new br(n.Solid());return n.delete(),o},Do=t=>{const e=N(),r=ft(t),n=new e.BRepBuilderAPI_MakeVertex(r),o=n.Vertex();return n.delete(),new hu(o)},At=t=>{const e=N(),r=new e.TopoDS_Builder,n=new e.TopoDS_Compound;return r.MakeCompound(n),t.forEach(i=>{r.Add(n,i.wrapped),i.delete()}),Ae(n)},ye=At;function yh(t){const e=N(),r=xe(),n=r(new e.BRepBuilderAPI_Sewing(1e-6,!0,!0,!0,!1));return t.forEach(({wrapped:o})=>{n.Add(o)}),n.Perform(r(new e.Message_ProgressRange_1)),Ae(wr(n.SewedShape()))}function la(t){const e=xe(),r=N(),n=yh(t),o=Ae(e(new r.ShapeFix_Solid_1).SolidFromShell(n.wrapped));if(!(o instanceof br))throw new Error("Could not make a solid of faces and shells");return o}const yu=(t,e)=>{const r=N(),[n,o]=Xe(),i=n(new r.BRepBuilderAPI_MakeFace_2(t.wrapped));e.forEach(p=>{i.Add(p.wrapped)});const u=n(i.Face()),l=n(new r.ShapeFix_Face_2(u));l.FixOrientation_1();const f=l.Face();return o(),new Wr(f)},wh=t=>t==="symmetric"||typeof t=="number"||Array.isArray(t)&&t.length===2,_h=t=>{let e;t?wh(t)?e={endTangent:t}:e={endTangent:0,...t}:e={endTangent:[1,0]};const{endTangent:r,startFactor:n=1,endFactor:o=1,startTangent:i}=e;let u;typeof r=="number"?u=Fr(1,r*wt):u=r;let l;return typeof i=="number"?l=Fr(1,i*wt):l=i,{endTangent:u,startFactor:n,endFactor:o,startTangent:l}};function ns(t,e,r,n){const o=t*r+e*n,i=Math.sqrt((t*t+e*e)*(r*r+n*n));let u=Math.acos(o/i);return t*n-e*r<0&&(u=-u),u}function bh([t,e],[r,n],o,i,u,l,f){const p=Math.PI*2;if(o<0&&(o=-o),i<0&&(i=-i),o==0||i==0)throw Error("rx and ry can not be 0");const d=Math.sin(u),y=Math.cos(u),m=(t-r)/2,S=(e-n)/2,T=(t+r)/2,x=(e+n)/2,C=y*m+d*S,A=y*S-d*m,B=C*C/(o*o)+A*A/(i*i);B>1&&(o=o*Math.sqrt(B),i=i*Math.sqrt(B));const F=o*i,q=o*A,z=i*C,ie=q*q+z*z;if(!ie)throw Error("start point can not be same as end point");let re=Math.sqrt(Math.abs((F*F-ie)/ie));l==f&&(re=-re);const ee=re*q/i,de=-re*z/o,Te=y*ee-d*de+T,Oe=d*ee+y*de+x,Re=(C-ee)/o,Ce=(C+ee)/o,ue=(A-de)/i,ge=(A+de)/i,Pe=ns(1,0,Re,ue);let ve=ns(Re,ue,-Ce,-ge);for(;ve>p;)ve-=p;for(;ve<0;)ve+=p;f||(ve-=p);let we=Pe+ve;for(;we>p;)we-=p;for(;we<0;)we+=p;return{cx:Te,cy:Oe,startAngle:Pe,deltaAngle:ve,endAngle:we,clockwise:!!f,rx:o,ry:i}}const wu=(t,e)=>{const r=N(),n=new r.BRepPrimAPI_MakePrism_1(t.wrapped,e.wrapped,!1,!0),o=new br(wr(n.Shape()));return n.delete(),o},_u=(t,e=[0,0,0],r=[0,0,1],n=360)=>{const o=N(),i=cn(e,r),u=new o.BRepPrimAPI_MakeRevol_1(t.wrapped,i,n*wt,!1),l=Ae(u.Shape());if(i.delete(),u.delete(),!Gt(l))throw new Error("Could not revolve to a 3d shape");return l};function vn(t,e,{frenet:r=!1,auxiliarySpine:n,law:o=null,transitionMode:i="right",withContact:u,support:l,forceProfileSpineOthogonality:f}={},p=!1){const d=N(),y=i==="round"?!0:!!f,m=new d.BRepOffsetAPI_MakePipeShell(e.wrapped);if(i){const x={transformed:d.BRepBuilderAPI_TransitionMode.BRepBuilderAPI_Transformed,round:d.BRepBuilderAPI_TransitionMode.BRepBuilderAPI_RoundCorner,right:d.BRepBuilderAPI_TransitionMode.BRepBuilderAPI_RightCorner}[i];x&&m.SetTransitionMode(x)}l?m.SetMode_4(l):r&&m.SetMode_1(r),n&&m.SetMode_5(n.wrapped,!1,d.BRepFill_TypeOfContact.BRepFill_NoContact),o?m.SetLaw_1(t.wrapped,o,!!u,y):m.Add_1(t.wrapped,!!u,y);const S=new d.Message_ProgressRange_1;m.Build(S),p||m.MakeSolid();const T=Ae(m.Shape());if(!Gt(T))throw new Error("Could not sweep to a 3d shape");if(p){const x=Ae(m.FirstShape()),C=Ae(m.LastShape());if(!rs(x))throw new Error("Could not sweep with one start wire");if(!rs(C))throw new Error("Could not sweep with one end wire");return m.delete(),[T,x,C]}return m.delete(),S.delete(),T}const bu=(t,{profile:e,endFactor:r=1})=>{let n;const o=N();if(e==="s-curve")n=new o.Law_S,n.Set_1(0,1,t,r);else if(e==="linear")n=new o.Law_Linear,n.Set(0,1,t,r);else throw new Error("Could not generate a law function");return n.Trim(0,t,1e-6)};function Su(t,e,r,n,o=!1){const i=new M(e),u=new M(r),l=mu(i,i.add(u)),f=dn([l]),p=n?bu(u.Length,n):null;return o?vn(t,f,{law:p},o):vn(t,f,{law:p},o)}function Tu(t,e,r,n,o,i=!1){const u=new M(r),l=new M(n),f=mu(u,u.add(l)),p=dn([f]),d=360/e*l.Length,y=1,m=hh(d,l.Length,y,r,n),S=o?bu(l.Length,o):null;return i?vn(t,p,{auxiliarySpine:m,law:S},i):vn(t,p,{auxiliarySpine:m,law:S},i)}const Sh=(t,{ruled:e=!0,startPoint:r,endPoint:n}={},o=!1)=>{const i=N(),[u,l]=Xe(),f=u(new i.BRepOffsetAPI_ThruSections(!o,e,1e-6));r&&f.AddVertex(u(Do(r)).wrapped),t.forEach(y=>f.AddWire(y.wrapped)),n&&f.AddVertex(u(Do(n)).wrapped);const p=u(new i.Message_ProgressRange_1);f.Build(p);const d=Ae(f.Shape());if(l(),!Gt(d))throw new Error("Could not loft to a 3d shape");return d};class Vr{constructor(e,{defaultOrigin:r=[0,0,0],defaultDirection:n=[0,0,1]}={}){this.wire=e,this.defaultOrigin=r,this.defaultDirection=n,this.baseFace=null}get baseFace(){return this._baseFace}set baseFace(e){e?this._baseFace=e.clone():this._baseFace=e}delete(){this.wire.delete(),this._defaultOrigin.delete(),this._defaultDirection.delete(),this.baseFace&&this.baseFace.delete()}clone(){const e=new Vr(this.wire.clone(),{defaultOrigin:this.defaultOrigin,defaultDirection:this.defaultDirection});return this.baseFace&&(e.baseFace=this.baseFace.clone()),e}get defaultOrigin(){return this._defaultOrigin}set defaultOrigin(e){this._defaultOrigin=new M(e)}get defaultDirection(){return this._defaultDirection}set defaultDirection(e){this._defaultDirection=new M(e)}face(){let e;return this.baseFace?e=ph(this.baseFace,this.wire):e=_o(this.wire),e}wires(){return this.wire.clone()}faces(){return this.face()}revolve(e,{origin:r}={}){const n=_o(this.wire),o=_u(n,r||this.defaultOrigin,e);return n.delete(),this.delete(),o}extrude(e,{extrusionDirection:r,extrusionProfile:n,twistAngle:o,origin:i}={}){const[u,l]=Xe(),f=u(new M(r||this.defaultDirection).normalized().multiply(e));if(n&&!o){const y=Su(this.wire,i||this.defaultOrigin,f,n);return l(),this.delete(),y}if(o){const y=Tu(this.wire,o,i||this.defaultOrigin,f,n);return l(),this.delete(),y}const p=_o(this.wire),d=wu(p,f);return l(),this.delete(),d}sweepSketch(e,r={}){const n=this.wire.startPoint,o=this.wire.tangentAt(1e-9).multiply(-1).normalize(),i=o.cross(this.defaultDirection).multiply(-1),u=e(new tt(n,i,o),n),l={forceProfileSpineOthogonality:!0,...r};this.baseFace&&(l.support=this.baseFace.wrapped);const f=vn(u.wire,this.wire,l);return this.delete(),f}loftWith(e,r={},n=!1){const o=Array.isArray(e)?[this,...e]:[this,e],i=Sh(o.map(u=>u.wire),r,n);return o.forEach(u=>u.delete()),i}}const Th=t=>{const e=N(),r=new e.Bnd_Box2d;return t.forEach(n=>{e.BndLib_Add2dCurve.Add_3(n.wrapped,1e-6,r)}),new bn(r)};function Eh(t,e){const[r,n]=Xe(),o=r(Xo(e.origin,e.zDir,e.xDir)),i=N(),u=t.map(l=>{const f=i.GeomLib.To3d(o,l.wrapped);return new ar(new i.BRepBuilderAPI_MakeEdge_24(f).Edge())});return n(),u}const xh=(t,e)=>{const[r,n]=Xe(),o=N(),i=t.map(u=>{const l=r(new o.BRepBuilderAPI_MakeEdge_30(u.wrapped,e));return new ar(l.Edge())});return n(),i},Eu=(t,e)=>{const r=N();return t.map(o=>e?new Le(r.GeomLib.GTransform(o.wrapped,e)):o.clone())};class En extends ht{transformCurves(e){return Eu(e,this.wrapped)}}const xu=(t,e,r=[0,0])=>{const n=N(),o=Nr(r,e),i=new n.gp_GTrsf2d_1;return i.SetAffinity(o,t),o.delete(),new En(i)},Ch=t=>{const e=N(),[r,n]=Xe(),o=new e.gp_Trsf2d_1;o.SetTranslation_1(r(ou(t)));const i=new e.gp_GTrsf2d_2(o);return n(),new En(i)},Ph=(t,e=[0,0],r="center")=>{const n=N(),[o,i]=Xe(),u=new n.gp_Trsf2d_1;r==="center"?u.SetMirror_1(o(qe(t))):u.SetMirror_2(o(Nr(e,t)));const l=new n.gp_GTrsf2d_2(u);return i(),new En(l)},kh=(t,e=[0,0])=>{const r=N(),[n,o]=Xe(),i=new r.gp_Trsf2d_1;i.SetRotation(n(qe(e)),t);const u=new r.gp_GTrsf2d_2(i);return o(),new En(u)},Ah=(t,e=[0,0])=>{const r=N(),[n,o]=Xe(),i=new r.gp_Trsf2d_1;i.SetScale(n(qe(e)),t);const u=new r.gp_GTrsf2d_2(i);return o(),new En(u)};function Oh(t,e,r="original"){const[n,o]=Xe(),i=N();let u=n(i.BRep_Tool.Surface_2(e.wrapped));const l=e.UVBounds;let f=null;const p=n(Nr([0,0],[0,1])),d=n(Nr([0,0],[1,0]));if(r==="original"&&e.geomType!=="PLANE"){if(e.geomType!=="CYLINDRE")throw new Error("Only planar and cylidrical faces can be unwrapped for sketching");const S=n(u.get().Cylinder());S.Direct()||(u=u.get().UReversed());const T=S.Radius();f=xu(1/T,[0,1]).wrapped}if(r==="bounds"){if(f=n(new i.gp_GTrsf2d_1),f.SetAffinity(p,l.uMax-l.uMin),l.uMin!==0){const T=n(new i.gp_GTrsf2d_1);T.SetTranslationPart(new i.gp_XY_2(0,-l.uMin)),f.Multiply(T)}const S=n(new i.gp_GTrsf2d_1);if(S.SetAffinity(d,l.vMax-l.vMin),f.Multiply(S),l.vMin!==0){const T=n(new i.gp_GTrsf2d_1);T.SetTranslationPart(n(new i.gp_XY_2(0,-l.vMin))),f.Multiply(T)}}const y=Eu(t,f),m=xh(y,u);return o(),m}const Zo=(t,e=1)=>{const r=t.bounds[0][0]-e,n=-t.bounds[1][1]-e;return`${r} ${n} ${t.width+2*e} ${t.height+2*e}`},ca=(t,e,r=1)=>`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="${Zo(e,r)}" fill="none" stroke="black" stroke-width="0.6%" vector-effect="non-scaling-stroke">
    ${t}
</svg>`;class se{constructor(e){this.curves=e,this._boundingBox=null,this._orientation=null,this._guessedOrientation=null}delete(){this.curves.forEach(e=>e.delete()),this._boundingBox&&this._boundingBox.delete()}clone(){return new se(this.curves)}get repr(){return["Blueprint",...this.curves.map(e=>e.repr)].join(`
`)}get boundingBox(){return this._boundingBox||(this._boundingBox=Th(this.curves)),this._boundingBox}get orientation(){if(this._orientation)return this._orientation;if(this._guessedOrientation)return this._guessedOrientation;const e=this.curves.flatMap(n=>n.geomType!=="LINE"?[n.firstPoint,n.value(.5)]:[n.firstPoint]),r=e.map((n,o)=>{const i=e[(o+1)%e.length];return(i[0]-n[0])*(i[1]+n[1])}).reduce((n,o)=>n+o,0);return this._guessedOrientation=r>0?"clockwise":"counterClockwise",this._guessedOrientation}stretch(e,r,n=[0,0]){const o=xu(e,r,n).transformCurves(this.curves);return new se(o)}scale(e,r){const n=r||this.boundingBox.center,o=Ah(e,n).transformCurves(this.curves);return new se(o)}rotate(e,r){const n=kh(e*wt,r).transformCurves(this.curves);return new se(n)}translate(e,r=0){const n=Co(e)?e:[e,r],o=Ch(n).transformCurves(this.curves);return new se(o)}mirror(e,r=[0,0],n="center"){const o=Ph(e,r,n).transformCurves(this.curves);return new se(o)}sketchOnPlane(e,r){const n=e instanceof tt?or(e):or(e,r),o=Eh(this.curves,n),i=dn(o);return new Vr(i,{defaultOrigin:n.origin,defaultDirection:n.zDir})}sketchOnFace(e,r){const n=N(),o=Oh(this.curves,e,r),i=dn(o);n.BRepLib.BuildCurves3d_2(i.wrapped);const u=new n.ShapeFix_Wire_2(i.wrapped,e.wrapped,1e-9);u.FixEdgeCurves(),u.delete();const l=new Vr(i);if(i.isClosed){const f=l.clone().face();l.defaultOrigin=f.pointOnSurface(.5,.5),l.defaultDirection=f.normalAt(),f.orientation!==e.orientation&&(l.defaultDirection=l.defaultDirection.multiply(-1)),l.baseFace=e}else{const f=i.startPoint;l.defaultOrigin=f,l.defaultDirection=e.normalAt(f),l.baseFace=e}return l}toSVGPathD(){const e=xe(),r=this.clone().mirror([1,0],[0,0],"plane"),o=ko(r.curves).flatMap(l=>oh(e(l.adaptor()),l.lastPoint)),[i,u]=r.curves[0].firstPoint;return`M ${yt(i)} ${yt(u)} ${o.join(" ")}${r.isClosed()?" Z":""}`}toSVGPath(){return`<path d="${this.toSVGPathD()}" />`}toSVGViewBox(e=1){return Zo(this.boundingBox,e)}toSVGPaths(){return[this.toSVGPathD()]}toSVG(e=1){return ca(this.toSVGPath(),this.boundingBox,e)}get firstPoint(){return this.curves[0].firstPoint}get lastPoint(){return this.curves[this.curves.length-1].lastPoint}isInside(e){if(!this.boundingBox.containsPoint(e))return!1;const r=N(),n=new r.Geom2dAPI_InterCurveCurve_1,o=Tn(e,this.boundingBox.outsidePoint());let i=0;return this.curves.find(l=>l.isOnCurve(e))?!1:(this.curves.forEach(l=>{l.boundingBox.isOut(o.boundingBox)||(n.Init_1(o.wrapped,l.wrapped,1e-9),i+=n.NbPoints())}),n.delete(),!!(i%2))}isClosed(){return Qe(this.firstPoint,this.lastPoint)}intersects(e){const r=N(),n=new r.Geom2dAPI_InterCurveCurve_1;if(this.boundingBox.isOut(e.boundingBox))return!1;for(const o of this.curves)for(const i of e.curves)if(!o.boundingBox.isOut(i.boundingBox)&&(n.Init_1(o.wrapped,i.wrapped,1e-9),n.NbPoints()||n.NbSegments()))return!0;return n.delete(),!1}}class Rh{constructor(e=[0,0]){this.pointer=e,this.firstPoint=e,this._nextCorner=null,this.pendingCurves=[]}_convertToUV([e,r]){return[e,r]}_convertFromUV([e,r]){return[e,r]}movePointerTo(e){if(this.pendingCurves.length)throw new Error("You can only move the pointer if there is no curve defined");return this.pointer=e,this.firstPoint=e,this}saveCurve(e){if(!this._nextCorner){this.pendingCurves.push(e);return}const r=this.pendingCurves.pop();if(!r)throw new Error("bug in the custom corner algorithm");const n=this._nextCorner.mode==="chamfer"?Zi:Yi;this.pendingCurves.push(...n(r,e,this._nextCorner.radius)),this._nextCorner=null}lineTo(e){const r=Tn(this._convertToUV(this.pointer),this._convertToUV(e));return this.pointer=e,this.saveCurve(r),this}line(e,r){return this.lineTo([this.pointer[0]+e,this.pointer[1]+r])}vLine(e){return this.line(0,e)}hLine(e){return this.line(e,0)}vLineTo(e){return this.lineTo([this.pointer[0],e])}hLineTo(e){return this.lineTo([e,this.pointer[1]])}polarLineTo([e,r]){const n=r*wt,o=Fr(e,n);return this.lineTo(o)}polarLine(e,r){const n=r*wt,[o,i]=Fr(e,n);return this.line(o,i)}tangentLine(e){const r=this.pendingCurves.length?this.pendingCurves[this.pendingCurves.length-1]:null;if(!r)throw new Error("You need a previous curve to sketch a tangent line");const n=er(this._convertFromUV(r.tangentAt(1)));return this.line(n[0]*e,n[1]*e)}threePointsArcTo(e,r){return this.saveCurve(Xi(this._convertToUV(this.pointer),this._convertToUV(r),this._convertToUV(e))),this.pointer=e,this}threePointsArc(e,r,n,o){const[i,u]=this.pointer;return this.threePointsArcTo([i+e,u+r],[i+n,u+o])}sagittaArcTo(e,r){const[n,o]=this.pointer,[i,u]=e,l=[(n+i)/2,(o+u)/2],f=[-(u-o),i-n],p=Math.sqrt(f[0]**2+f[1]**2),d=[l[0]+f[0]/p*r,l[1]+f[1]/p*r];return this.saveCurve(Xi(this._convertToUV(this.pointer),this._convertToUV(d),this._convertToUV(e))),this.pointer=e,this}sagittaArc(e,r,n){return this.sagittaArcTo([e+this.pointer[0],r+this.pointer[1]],n)}vSagittaArc(e,r){return this.sagittaArc(0,e,r)}hSagittaArc(e,r){return this.sagittaArc(e,0,r)}bulgeArcTo(e,r){if(!r)return this.lineTo(e);const n=kt(this.pointer,e)/2,o=-r*n;return this.sagittaArcTo(e,o)}bulgeArc(e,r,n){return this.bulgeArcTo([e+this.pointer[0],r+this.pointer[1]],n)}vBulgeArc(e,r){return this.bulgeArc(0,e,r)}hBulgeArc(e,r){return this.bulgeArc(e,0,r)}tangentArcTo(e){const r=this.pendingCurves.length?this.pendingCurves[this.pendingCurves.length-1]:null;if(!r)throw new Error("You need a previous curve to sketch a tangent arc");return this.saveCurve(jf(this._convertToUV(this.pointer),r.tangentAt(1),this._convertToUV(e))),this.pointer=e,this}tangentArc(e,r){const[n,o]=this.pointer;return this.tangentArcTo([e+n,r+o])}ellipseTo(e,r,n,o=0,i=!1,u=!1){let l=o,f=r,p=n;r<n&&(l=o+90,f=n,p=r);const d=l*wt,y=ee=>kt(this._convertToUV(ee)),m=y(Fr(f,d)),S=y(Fr(p,d+Math.PI/2)),T=er(this._convertToUV($f([1,0],d))),[,x]=Yf(T),{cx:C,cy:A,startAngle:B,endAngle:F,clockwise:q,rx:z,ry:ie}=bh(this._convertToUV(this.pointer),this._convertToUV(e),m,S,x,i,u),re=Kf(z,ie,q?B:F,q?F:B,[C,A],T);return q||re.reverse(),this.saveCurve(re),this.pointer=e,this}ellipse(e,r,n,o,i=0,u=!1,l=!1){const[f,p]=this.pointer;return this.ellipseTo([e+f,r+p],n,o,i,u,l)}halfEllipseTo(e,r,n=!1){const o=Xf(e,this.pointer),i=kt(e,this.pointer);return this.ellipseTo(e,i/2,r,o*ln,!0,n)}halfEllipse(e,r,n,o=!1){const[i,u]=this.pointer;return this.halfEllipseTo([i+e,u+r],n,o)}bezierCurveTo(e,r){let n;return r.length===2&&!Array.isArray(r[0])?n=[r]:n=r,this.saveCurve(Qf(this._convertToUV(this.pointer),n.map(o=>this._convertToUV(o)),this._convertToUV(e))),this.pointer=e,this}quadraticBezierCurveTo(e,r){return this.bezierCurveTo(e,[r])}cubicBezierCurveTo(e,r,n){return this.bezierCurveTo(e,[r,n])}smoothSplineTo(e,r){const{endTangent:n,startTangent:o,startFactor:i,endFactor:u}=_h(r),l=this.pendingCurves.length?this.pendingCurves[this.pendingCurves.length-1]:null,f=kt(this.pointer,e)*.25;let p;o?p=o:l?p=this._convertFromUV(l.tangentAt(1)):p=[1,0],p=er(p);const d=[this.pointer[0]+p[0]*i*f,this.pointer[1]+p[1]*i*f];let y;n==="symmetric"?y=[-p[0],-p[1]]:y=n,y=er(y);const m=[e[0]-y[0]*u*f,e[1]-y[1]*u*f];return this.cubicBezierCurveTo(e,d,m)}smoothSpline(e,r,n){return this.smoothSplineTo([e+this.pointer[0],r+this.pointer[1]],n)}customCorner(e,r="fillet"){if(!this.pendingCurves.length)throw new Error("You need a curve defined to fillet the angle");return this._nextCorner={mode:r,radius:e},this}_customCornerLastWithFirst(e,r="fillet"){if(!e)return;const n=this.pendingCurves.pop(),o=this.pendingCurves.shift();if(!n||!o)throw new Error("Not enough curves to close and fillet");const i=r==="chamfer"?Zi:Yi;this.pendingCurves.push(...i(n,o,e))}_closeSketch(){Qe(this.pointer,this.firstPoint)||this.lineTo(this.firstPoint)}_closeWithMirror(){if(Qe(this.pointer,this.firstPoint))throw new Error("Cannot close with a mirror when the sketch is already closed");const e=[this.pointer[0]-this.firstPoint[0],this.pointer[1]-this.firstPoint[1]],r=Nr(this._convertToUV(this.pointer),this._convertToUV(e)),n=this.pendingCurves.map(o=>new Le(o.innerCurve.Mirrored_2(r)));n.reverse(),n.map(o=>o.reverse()),this.pendingCurves.push(...n),this.pointer=this.firstPoint}}const Dh=t=>{const e=N(),r=new e.BRepOffsetAPI_MakeFilling(3,15,2,!1,1e-5,1e-4,.01,.1,8,9);t.forEach((i,u)=>{i.edges.forEach(l=>{r.Add_1(l.wrapped,e.GeomAbs_Shape.GeomAbs_C0,u===0)})});const n=new e.Message_ProgressRange_1;r.Build(n),n.delete();const o=Ae(r.Shape());if(r.delete(),!(o instanceof Wr))throw new Error("Failed to create a face");return o},Mh=(t,e)=>{const r=N(),n=new r.ShapeFix_Wire_2(t.wrapped,e.wrapped,1e-9);return n.FixEdgeCurves(),n.delete(),t},os=t=>{let e,r;try{e=_o(t[0]),r=t.slice(1)}catch{e=Dh(t),r=t.slice(1).map(o=>Mh(o,e))}return yu(e,r)},is=(t,e)=>{const r=[],n=[],o=[];t.forEach(f=>{const[p,d,y]=e(f);r.push(p),n.push(d),o.push(y)});const i=os(n),u=os(o);return la([i,...r,u])};class as{constructor(e){this.sketches=e}delete(){this.sketches.forEach(e=>e.delete())}get outerSketch(){return this.sketches[0]}get innerSketches(){return this.sketches.slice(1)}get wires(){const e=this.sketches.map(r=>r.wire);return At(e)}face(){const e=this.outerSketch.face();return yu(e,this.innerSketches.map(n=>n.wire))}extrude(e,{extrusionDirection:r,extrusionProfile:n,twistAngle:o,origin:i}={}){const u=new M(r||this.outerSketch.defaultDirection).normalized().multiply(e);return n&&!o?is(this.sketches,p=>Su(p.wire,i||this.outerSketch.defaultOrigin,u,n,!0)):o?is(this.sketches,p=>Tu(p.wire,o,i||this.outerSketch.defaultOrigin,u,n,!0)):wu(this.face(),u)}revolve(e,{origin:r}={}){return _u(this.face(),r||this.outerSketch.defaultOrigin,e)}loftWith(e,r){if(this.sketches.length!==e.sketches.length)throw new Error("You need to loft with another compound with the same number of sketches");const n=this.sketches.map((i,u)=>{const l=e.sketches[u];return i.clone().loftWith(l.clone(),{ruled:r.ruled},!0)}),o=this.face().clone();return n.push(o,e.face()),la(n)}}class me{constructor(e){this.blueprints=e,this._boundingBox=null}clone(){return new me(this.blueprints)}get boundingBox(){if(!this._boundingBox){const e=new bn;this.blueprints.forEach(r=>e.add(r.boundingBox)),this._boundingBox=e}return this._boundingBox}get repr(){return["Compound Blueprints","-- Outline",this.blueprints[0].repr,"-- Holes",...this.blueprints.slice(1).map(e=>e.repr)].join(`
`)}stretch(e,r,n){return new me(this.blueprints.map(o=>o.stretch(e,r,n)))}rotate(e,r){return new me(this.blueprints.map(n=>n.rotate(e,r)))}scale(e,r){const n=r||this.boundingBox.center;return new me(this.blueprints.map(o=>o.scale(e,n)))}translate(e,r=0){return new me(this.blueprints.map(n=>n.translate(e,r)))}mirror(e,r,n){return new me(this.blueprints.map(o=>o.mirror(e,r,n)))}sketchOnPlane(e,r){const n=this.blueprints.map(o=>o.sketchOnPlane(e,r));return new as(n)}sketchOnFace(e,r){const n=this.blueprints.map(o=>o.sketchOnFace(e,r));return new as(n)}toSVGViewBox(e=1){return Zo(this.boundingBox,e)}toSVGPaths(){return this.blueprints.flatMap(e=>e.toSVGPaths())}toSVGGroup(){return`<g>${this.blueprints.map(e=>e.toSVGPath()).join("")}</g>`}toSVG(e=1){return ca(this.toSVGGroup(),this.boundingBox,e)}}class ss{constructor(e){this.sketches=e}wires(){const e=this.sketches.map(r=>r instanceof Vr?r.wire:r.wires);return At(e)}faces(){const e=this.sketches.map(r=>r.face());return At(e)}extrude(e,r={}){const n=this.sketches.map(o=>o.extrude(e,r));return At(n)}revolve(e,r){return At(this.sketches.map(n=>n.revolve(e,r)))}}class J{constructor(e){this.blueprints=e,this._boundingBox=null}get repr(){return["Blueprints",...this.blueprints.map(e=>e.repr)].join(`
`)}clone(){return new J(this.blueprints)}get boundingBox(){if(!this._boundingBox){const e=new bn;this.blueprints.forEach(r=>e.add(r.boundingBox)),this._boundingBox=e}return this._boundingBox}stretch(e,r,n){return new J(this.blueprints.map(o=>o.stretch(e,r,n)))}rotate(e,r){return new J(this.blueprints.map(n=>n.rotate(e,r)))}scale(e,r){const n=r||this.boundingBox.center;return new J(this.blueprints.map(o=>o.scale(e,n)))}translate(e,r=0){return new J(this.blueprints.map(n=>n.translate(e,r)))}mirror(e,r,n){return new J(this.blueprints.map(o=>o.mirror(e,r,n)))}sketchOnPlane(e,r){return new ss(this.blueprints.map(n=>n.sketchOnPlane(e,r)))}sketchOnFace(e,r){return new ss(this.blueprints.map(n=>n.sketchOnFace(e,r)))}toSVGViewBox(e=1){return Zo(this.boundingBox,e)}toSVGPaths(){return this.blueprints.map(e=>e.toSVGPaths())}toSVG(e=1){const r=this.blueprints.map(n=>n instanceof se?n.toSVGPath():n.toSVGGroup());return ca(r.join(`
    `),this.boundingBox,e)}}const Fh=t=>{const e=t.map((o,i)=>t.slice(i+1).map((u,l)=>[l+i+1,u]).filter(([,u])=>!o.boundingBox.isOut(u.boundingBox)).map(([u])=>u)),r=[],n=Array(e.length);return e.forEach((o,i)=>{let u=n[i];u||(u=[],r.push(u)),u.push(t[i]),o.length&&o.forEach(l=>{n[l]=u})}),r},Cu=t=>t.map((e,r)=>{const n=e.curves[0],o=n.value((n.lastParameter+n.firstParameter)/2),i=t.filter((u,l)=>r===l?!1:u.isInside(o));return{blueprint:e,isIn:i}}),Bh=(t,e)=>t.flatMap(({blueprint:r})=>fa(e.filter(({blueprint:n,isIn:o})=>n===r||o.indexOf(r)!==-1))),Lh=(t,e)=>{const r=e.filter(({isIn:o})=>o.length<=1),n=fa(Cu(t.map(({blueprint:o})=>o)));return[r,...n]},fa=t=>{if(!t.length)return[];const e=t.filter(({isIn:n})=>!n.length),r=t.filter(({isIn:n})=>n.length>1);return e.length===1&&r.length===0?[t]:e.length>1?Bh(e,t):Lh(r,t)},xn=t=>{const e=Fh(t).map(Cu);return new J(e.flatMap(fa).map(r=>r.length===1?r[0].blueprint:(r.sort((n,o)=>n.isIn.length-o.isIn.length),new me(r.map(({blueprint:n})=>n)))))},bo=1e-9,Ke=(t,e)=>Qe(t,e,bo),sn=t=>{const e=(t.lastParameter+t.firstParameter)/2;return t.value(e)},us=(t,e)=>{const r=t.findIndex(i=>Ke(e,i.firstPoint)),n=t.slice(0,r);return t.slice(r).concat(n)},ls=(t,e)=>{const r=u=>Ke(e.firstPoint,u.firstPoint)&&Ke(e.lastPoint,u.lastPoint);let n=t.findIndex(r);if(n===-1&&(t=ha(t),n=t.findIndex(r),n===-1))throw console.error(t.map(u=>u.repr),e.repr),new Error("Failed to rotate to segment start");const o=t.slice(0,n);return t.slice(n).concat(o)};function*cs(t,e,r){const n=u=>!!e.find(l=>Ke(l,u.lastPoint)),o=u=>!!r.find(l=>Ke(l.firstPoint,u.firstPoint)&&Ke(l.lastPoint,u.lastPoint)||Ke(l.firstPoint,u.lastPoint)&&Ke(l.lastPoint,u.firstPoint));let i=[];for(const u of t)n(u)?(i.push(u),yield i,i=[]):o(u)?(i.length&&(yield i,i=[]),yield[u]):i.push(u);i.length&&(yield i)}const Uh=t=>t[0].firstPoint,Mi=t=>t[t.length-1].lastPoint,ha=t=>(t.reverse(),t.map(e=>{const r=e.clone();return r.reverse(),r})),Ih=t=>(t.reverse(),t.map(ha));function Gh(t,e,r){return t.filter(n=>{const o=e.filter(l=>Ke(l.firstPoint,n)||Ke(l.lastPoint,n));if(o.length%2)throw console.error(o,n),new Error("Bug in the intersection algo on non crossing point");const i=o.map(l=>r.isInside(sn(l)));return!(i.every(l=>l)||!i.some(l=>l))})}function Nh(t,e){let r=[];const n=[],o=new Array(t.curves.length).fill(0).map(()=>[]),i=new Array(e.curves.length).fill(0).map(()=>[]);if(t.curves.forEach((m,S)=>{e.curves.forEach((T,x)=>{const{intersections:C,commonSegments:A,commonSegmentsPoints:B}=Sn(m,T,bo/100);r.push(...C),o[S].push(...C),i[x].push(...C),n.push(...A),r.push(...B),o[S].push(...B),i[x].push(...B)})}),r=nu(r,bo),!r.length||r.length===1)return null;const u=([m,S])=>S.length?m.splitAt(S,bo/100):[m];let l=Lr([t.curves,o]).flatMap(u),f=Lr([e.curves,i]).flatMap(u);const p=n.map(m=>[m.firstPoint,m.lastPoint]);if(r=Gh(r,l,e),!r.length&&!n.length)return null;if(n.length){const m=n[0];l=ls(l,m),f=ls(f,m)}else{const m=r[0];l=us(l,m),f=us(f,m)}const d=Array.from(cs(l,r,n));let y=Array.from(cs(f,r,n));return(!Ke(Mi(y[0]),Mi(d[0]))||n.length>0&&y[0].length!==1)&&(y=Ih(y)),Lr([d,y]).map(([m,S])=>{const T=Uh(m),x=Mi(m);return p.find(([C,A])=>Ke(C,T)&&Ke(A,x)||Ke(C,x)&&Ke(C,T))?[m,"same"]:[m,S]})}const Hh=t=>{const e=t.map(u=>u.firstPoint);let r=t.map(u=>u.lastPoint);r=r.slice(-1).concat(r.slice(0,-1));const n=Lr([e,r]).map(([u,l],f)=>Ke(u,l)?null:f).filter(u=>u!==null);if(!n.length)return[t];const o=Lr([n.slice(0,-1),n.slice(1)]).map(([u,l])=>t.slice(u,l));let i=t.slice(n[n.length-1]);return n[0]!==0&&(i=i.concat(t.slice(0,n[0]))),o.push(i),o};function pa(t,e,{firstInside:r,secondInside:n}){const o=Nh(t,e);if(!o){const p=sn(t.curves[0]),d=e.isInside(p),y=sn(e.curves[0]),m=t.isInside(y);return{identical:!1,firstCurveInSecond:d,secondCurveInFirst:m}}if(o.every(([,p])=>p==="same"))return{identical:!0};let i=null,u=null;const l=o.flatMap(([p,d])=>{let y=[],m=0;if(d==="same")return u===1?(u=1,[...p]):u===2||u===0?(u=null,[]):u===null?(i?i=[...i,...p]:i=p,[]):(console.error("weird situation"),[]);const S=sn(p[0]),T=e.isInside(S);(r==="keep"&&T||r==="remove"&&!T)&&(m+=1,y.push(...p));const x=sn(d[0]),C=t.isInside(x);if(n==="keep"&&C||n==="remove"&&!C){let A=d;m===1&&(A=ha(d)),m+=1,y.push(...A)}return u===null&&m===1&&i&&(y=[...i,...y]),m===1&&(u=m,i=null),y}),f=Hh(l).filter(p=>p.length).map(p=>new se(p));return f.length===0?null:f.length===1?f[0]:xn(f)}const qo=(t,e)=>{const r=pa(t,e,{firstInside:"remove",secondInside:"remove"});return r===null||r instanceof se||r instanceof J?r:r.identical?t.clone():r.firstCurveInSecond?e.clone():r.secondCurveInFirst?t.clone():new J([t,e])},gn=(t,e)=>{const r=pa(t,e,{firstInside:"remove",secondInside:"keep"});return r===null||r instanceof se||r instanceof J?r:r.identical||r.firstCurveInSecond?null:r.secondCurveInFirst?new J([new me([t,e])]):t.clone()},da=(t,e)=>{const r=pa(t,e,{firstInside:"keep",secondInside:"keep"});return r===null||r instanceof se||r instanceof J?r:r.identical||r.firstCurveInSecond?t.clone():r.secondCurveInFirst?e.clone():null},ji=(t,e)=>{if(t instanceof se&&e instanceof se){let r=[];return t.curves.forEach(n=>{e.curves.forEach(o=>{const{intersections:i,commonSegmentsPoints:u}=Sn(n,o);r.push(...i),r.push(...u)})}),r=nu(r),r.length>1}if(t instanceof me||t instanceof J)return t.blueprints.some(r=>ji(r,e));if(e instanceof me||e instanceof J)return e.blueprints.some(r=>ji(t,r));throw new Error("Bug in the generic intersects algorithm")},Vh=(t,e)=>{if(t instanceof me){if(e instanceof se)return Mo(e,t);if(e instanceof me)return Fo(t,e)}if(e instanceof me){if(t instanceof se)return Mo(t,e);if(t instanceof me)return Fo(t,e)}if(t instanceof se&&e instanceof se)return qo(t,e);throw new Error("Bug in the generic fuse algorithm")},fs=t=>{const e=new Map,r=[];return t.forEach((n,o)=>{let i;e.has(o)?i=e.get(o):(i={current:n,fusedWith:new Set([o])},r.push(i)),t.slice(o+1).forEach((u,l)=>{const f=i.current,p=o+l+1;if(i.fusedWith.has(p))return;let d=u,y=!1;if(e.has(p)&&(d=e.get(p).current,y=!0),f.boundingBox.isOut(d.boundingBox)||!ji(f,d))return;let m;if(f instanceof J||d instanceof J?m=Ht(f,d):m=Vh(f,d),!(m instanceof se||m instanceof me)){if(m instanceof J&&m.blueprints.length===2)return;if(m instanceof J&&m.blueprints.length===1)m=m.blueprints[0];else if(!(m instanceof J))throw console.error(m),new Error("Bug in blueprint fusing algorigthm")}i.fusedWith.add(p),i.current=m,y||e.set(p,i)})}),xn(r.map(({current:n})=>n).filter(n=>n).flatMap(n=>Nt(n)))},Nt=t=>t instanceof se?[t]:t instanceof me?t.blueprints:t instanceof J?t.blueprints.flatMap(e=>Nt(e)):[],Mo=(t,e)=>{const r=qo(t,e.blueprints[0]),n=e.blueprints.slice(1).map(o=>gn(o,t));return xn([...Nt(r),...n.flatMap(o=>Nt(o))])};function zh(t,e){const r=[];for(const n of t)for(const o of e)r.push([n,o]);return r}const Fo=(t,e)=>{const r=qo(t.blueprints[0],e.blueprints[0]),n=e.blueprints.slice(1).map(u=>gn(u,t.blueprints[0])),o=t.blueprints.slice(1).map(u=>gn(u,e.blueprints[0])),i=zh(t.blueprints.slice(1),e.blueprints.slice(1)).flatMap(([u,l])=>Nt(da(u,l)));return xn([...Nt(r),...n.flatMap(u=>Nt(u)),...o.flatMap(u=>Nt(u)),...i])},Ht=(t,e)=>{if(t===null)return e&&e.clone();if(e===null)return t&&t.clone();if(!(t instanceof J)&&e instanceof J)return fs([t,...e.blueprints]);if(!(e instanceof J)&&t instanceof J)return fs([e,...t.blueprints]);if(t instanceof J&&e instanceof J){let r=Ht(t.blueprints[0],e);return t.blueprints.slice(1).forEach(n=>{r=Ht(n,r)}),r}if(t instanceof me){if(e instanceof J)return Ht(e,t);if(e instanceof se)return Mo(e,t);if(e instanceof me)return Fo(t,e)}if(e instanceof me){if(t instanceof J)return Ht(t,e);if(t instanceof se)return Mo(t,e);if(t instanceof me)return Fo(t,e)}return t instanceof se&&e instanceof se?qo(t,e):null},Bo=t=>{const e=t.flatMap(r=>r===null?[]:r instanceof J?r.blueprints:r);return e.length===1?e[0]:new J(e)},tr=(t,e)=>{if(t===null)return null;if(e===null)return t.clone();if(t instanceof J)return Bo(t.blueprints.map(n=>tr(n,e)));if(t instanceof me){const n=t.blueprints[0];if(e instanceof se&&!e.intersects(n)){if(!n.isInside(e.firstPoint))return null;const o=Ht(e,new J(t.blueprints.slice(1)));return xn([n,...Nt(o)])}else{let o=tr(t.blueprints[0],e);return t.blueprints.slice(1).forEach(i=>{o=tr(o,i)}),o}}if(e instanceof J)return Bo(e.blueprints.map(n=>tr(t,n)));if(e instanceof me){let n=gn(t,e.blueprints[0]);return e.blueprints.slice(1).forEach(o=>{n=Ht(n,da(o,t))}),n}return gn(t,e)};function un(t,e){if(t===null||e===null)return null;if(t instanceof se&&e instanceof se)return da(t,e);if(t instanceof J)return Bo(t.blueprints.map(r=>un(r,e)));if(t instanceof me){const r=t.blueprints[0],n=t.blueprints[1];return tr(un(r,e),n)}if(e instanceof J)return Bo(e.blueprints.map(r=>un(t,r)));if(e instanceof me){const r=e.blueprints[0],n=e.blueprints[1];return tr(un(r,t),n)}throw new Error("intersct 2D algorithm error")}const hs=(t,e={})=>{const r=e.plane instanceof tt?or(e.plane):or(e.plane,e.origin),n=dn([fh(t,r.origin,r.zDir)]),o=new Vr(n,{defaultOrigin:r.origin,defaultDirection:r.zDir});return r.delete(),o};/*! https://mths.be/codepointat v0.2.0 by @mathias */String.prototype.codePointAt||function(){var t=function(){try{var r={},n=Object.defineProperty,o=n(r,r,r)&&n}catch{}return o}(),e=function(r){if(this==null)throw TypeError();var n=String(this),o=n.length,i=r?Number(r):0;if(i!=i&&(i=0),!(i<0||i>=o)){var u=n.charCodeAt(i),l;return u>=55296&&u<=56319&&o>i+1&&(l=n.charCodeAt(i+1),l>=56320&&l<=57343)?(u-55296)*1024+l-56320+65536:u}};t?t(String.prototype,"codePointAt",{value:e,configurable:!0,writable:!0}):String.prototype.codePointAt=e}();function Pu(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}var Wh=new Pu,Xh=new Pu,ku=new Uint8Array(30),Au=new Uint16Array(30),$h=new Uint8Array(30),Yh=new Uint16Array(30);function Ou(t,e,r,n){var o,i;for(o=0;o<r;++o)t[o]=0;for(o=0;o<30-r;++o)t[o+r]=o/r|0;for(i=n,o=0;o<30;++o)e[o]=i,i+=1<<t[o]}function Zh(t,e){var r;for(r=0;r<7;++r)t.table[r]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,r=0;r<24;++r)t.trans[r]=256+r;for(r=0;r<144;++r)t.trans[24+r]=r;for(r=0;r<8;++r)t.trans[24+144+r]=280+r;for(r=0;r<112;++r)t.trans[24+144+8+r]=144+r;for(r=0;r<5;++r)e.table[r]=0;for(e.table[5]=32,r=0;r<32;++r)e.trans[r]=r}Zh(Wh,Xh);Ou(ku,Au,4,3);Ou($h,Yh,2,1);ku[28]=0;Au[28]=258;function Dr(t,e,r,n,o){return Math.pow(1-o,3)*t+3*Math.pow(1-o,2)*o*e+3*(1-o)*Math.pow(o,2)*r+Math.pow(o,3)*n}function sr(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}sr.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)};sr.prototype.addPoint=function(t,e){typeof t=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),typeof e=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))};sr.prototype.addX=function(t){this.addPoint(t,null)};sr.prototype.addY=function(t){this.addPoint(null,t)};sr.prototype.addBezier=function(t,e,r,n,o,i,u,l){var f=[t,e],p=[r,n],d=[o,i],y=[u,l];this.addPoint(t,e),this.addPoint(u,l);for(var m=0;m<=1;m++){var S=6*f[m]-12*p[m]+6*d[m],T=-3*f[m]+9*p[m]-9*d[m]+3*y[m],x=3*p[m]-3*f[m];if(T===0){if(S===0)continue;var C=-x/S;0<C&&C<1&&(m===0&&this.addX(Dr(f[m],p[m],d[m],y[m],C)),m===1&&this.addY(Dr(f[m],p[m],d[m],y[m],C)));continue}var A=Math.pow(S,2)-4*x*T;if(!(A<0)){var B=(-S+Math.sqrt(A))/(2*T);0<B&&B<1&&(m===0&&this.addX(Dr(f[m],p[m],d[m],y[m],B)),m===1&&this.addY(Dr(f[m],p[m],d[m],y[m],B)));var F=(-S-Math.sqrt(A))/(2*T);0<F&&F<1&&(m===0&&this.addX(Dr(f[m],p[m],d[m],y[m],F)),m===1&&this.addY(Dr(f[m],p[m],d[m],y[m],F)))}}};sr.prototype.addQuad=function(t,e,r,n,o,i){var u=t+.6666666666666666*(r-t),l=e+2/3*(n-e),f=u+1/3*(o-t),p=l+1/3*(i-e);this.addBezier(t,e,u,l,f,p,o,i)};function $e(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}$e.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})};$e.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})};$e.prototype.curveTo=$e.prototype.bezierCurveTo=function(t,e,r,n,o,i){this.commands.push({type:"C",x1:t,y1:e,x2:r,y2:n,x:o,y:i})};$e.prototype.quadTo=$e.prototype.quadraticCurveTo=function(t,e,r,n){this.commands.push({type:"Q",x1:t,y1:e,x:r,y:n})};$e.prototype.close=$e.prototype.closePath=function(){this.commands.push({type:"Z"})};$e.prototype.extend=function(t){if(t.commands)t=t.commands;else if(t instanceof sr){var e=t;this.moveTo(e.x1,e.y1),this.lineTo(e.x2,e.y1),this.lineTo(e.x2,e.y2),this.lineTo(e.x1,e.y2),this.close();return}Array.prototype.push.apply(this.commands,t)};$e.prototype.getBoundingBox=function(){for(var t=new sr,e=0,r=0,n=0,o=0,i=0;i<this.commands.length;i++){var u=this.commands[i];switch(u.type){case"M":t.addPoint(u.x,u.y),e=n=u.x,r=o=u.y;break;case"L":t.addPoint(u.x,u.y),n=u.x,o=u.y;break;case"Q":t.addQuad(n,o,u.x1,u.y1,u.x,u.y),n=u.x,o=u.y;break;case"C":t.addBezier(n,o,u.x1,u.y1,u.x2,u.y2,u.x,u.y),n=u.x,o=u.y;break;case"Z":n=e,o=r;break;default:throw new Error("Unexpected path command "+u.type)}}return t.isEmpty()&&t.addPoint(0,0),t};$e.prototype.draw=function(t){t.beginPath();for(var e=0;e<this.commands.length;e+=1){var r=this.commands[e];r.type==="M"?t.moveTo(r.x,r.y):r.type==="L"?t.lineTo(r.x,r.y):r.type==="C"?t.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):r.type==="Q"?t.quadraticCurveTo(r.x1,r.y1,r.x,r.y):r.type==="Z"&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())};$e.prototype.toPathData=function(t){t=t!==void 0?t:2;function e(u){return Math.round(u)===u?""+Math.round(u):u.toFixed(t)}function r(){for(var u=arguments,l="",f=0;f<arguments.length;f+=1){var p=u[f];p>=0&&f>0&&(l+=" "),l+=e(p)}return l}for(var n="",o=0;o<this.commands.length;o+=1){var i=this.commands[o];i.type==="M"?n+="M"+r(i.x,i.y):i.type==="L"?n+="L"+r(i.x,i.y):i.type==="C"?n+="C"+r(i.x1,i.y1,i.x2,i.y2,i.x,i.y):i.type==="Q"?n+="Q"+r(i.x1,i.y1,i.x,i.y):i.type==="Z"&&(n+="Z")}return n};$e.prototype.toSVG=function(t){var e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&&this.fill!=="black"&&(this.fill===null?e+=' fill="none"':e+=' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>",e};$e.prototype.toDOMElement=function(t){var e=this.toPathData(t),r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",e),r};function Ru(t){throw new Error(t)}function ps(t,e){t||Ru(e)}var Q={fail:Ru,argument:ps,assert:ps},ds=32768,vs=2147483648,zr={},V={},j={};function St(t){return function(){return t}}V.BYTE=function(t){return Q.argument(t>=0&&t<=255,"Byte value should be between 0 and 255."),[t]};j.BYTE=St(1);V.CHAR=function(t){return[t.charCodeAt(0)]};j.CHAR=St(1);V.CHARARRAY=function(t){typeof t>"u"&&(t="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var e=[],r=0;r<t.length;r+=1)e[r]=t.charCodeAt(r);return e};j.CHARARRAY=function(t){return typeof t>"u"?0:t.length};V.USHORT=function(t){return[t>>8&255,t&255]};j.USHORT=St(2);V.SHORT=function(t){return t>=ds&&(t=-(2*ds-t)),[t>>8&255,t&255]};j.SHORT=St(2);V.UINT24=function(t){return[t>>16&255,t>>8&255,t&255]};j.UINT24=St(3);V.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,t&255]};j.ULONG=St(4);V.LONG=function(t){return t>=vs&&(t=-(2*vs-t)),[t>>24&255,t>>16&255,t>>8&255,t&255]};j.LONG=St(4);V.FIXED=V.ULONG;j.FIXED=j.ULONG;V.FWORD=V.SHORT;j.FWORD=j.SHORT;V.UFWORD=V.USHORT;j.UFWORD=j.USHORT;V.LONGDATETIME=function(t){return[0,0,0,0,t>>24&255,t>>16&255,t>>8&255,t&255]};j.LONGDATETIME=St(8);V.TAG=function(t){return Q.argument(t.length===4,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]};j.TAG=St(4);V.Card8=V.BYTE;j.Card8=j.BYTE;V.Card16=V.USHORT;j.Card16=j.USHORT;V.OffSize=V.BYTE;j.OffSize=j.BYTE;V.SID=V.USHORT;j.SID=j.USHORT;V.NUMBER=function(t){return t>=-107&&t<=107?[t+139]:t>=108&&t<=1131?(t=t-108,[(t>>8)+247,t&255]):t>=-1131&&t<=-108?(t=-t-108,[(t>>8)+251,t&255]):t>=-32768&&t<=32767?V.NUMBER16(t):V.NUMBER32(t)};j.NUMBER=function(t){return V.NUMBER(t).length};V.NUMBER16=function(t){return[28,t>>8&255,t&255]};j.NUMBER16=St(3);V.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,t&255]};j.NUMBER32=St(5);V.REAL=function(t){var e=t.toString(),r=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(r){var n=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length));e=(Math.round(t*n)/n).toString()}for(var o="",i=0,u=e.length;i<u;i+=1){var l=e[i];l==="e"?o+=e[++i]==="-"?"c":"b":l==="."?o+="a":l==="-"?o+="e":o+=l}o+=o.length&1?"f":"ff";for(var f=[30],p=0,d=o.length;p<d;p+=2)f.push(parseInt(o.substr(p,2),16));return f};j.REAL=function(t){return V.REAL(t).length};V.NAME=V.CHARARRAY;j.NAME=j.CHARARRAY;V.STRING=V.CHARARRAY;j.STRING=j.CHARARRAY;zr.UTF8=function(t,e,r){for(var n=[],o=r,i=0;i<o;i++,e+=1)n[i]=t.getUint8(e);return String.fromCharCode.apply(null,n)};zr.UTF16=function(t,e,r){for(var n=[],o=r/2,i=0;i<o;i++,e+=2)n[i]=t.getUint16(e);return String.fromCharCode.apply(null,n)};V.UTF16=function(t){for(var e=[],r=0;r<t.length;r+=1){var n=t.charCodeAt(r);e[e.length]=n>>8&255,e[e.length]=n&255}return e};j.UTF16=function(t){return t.length*2};var Ki={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};zr.MACSTRING=function(t,e,r,n){var o=Ki[n];if(o!==void 0){for(var i="",u=0;u<r;u++){var l=t.getUint8(e+u);l<=127?i+=String.fromCharCode(l):i+=o[l&127]}return i}};var fo=typeof WeakMap=="function"&&new WeakMap,ho,qh=function(t){if(!ho){ho={};for(var e in Ki)ho[e]=new String(e)}var r=ho[t];if(r!==void 0){if(fo){var n=fo.get(r);if(n!==void 0)return n}var o=Ki[t];if(o!==void 0){for(var i={},u=0;u<o.length;u++)i[o.charCodeAt(u)]=u+128;return fo&&fo.set(r,i),i}}};V.MACSTRING=function(t,e){var r=qh(e);if(r!==void 0){for(var n=[],o=0;o<t.length;o++){var i=t.charCodeAt(o);if(i>=128&&(i=r[i],i===void 0))return;n[o]=i}return n}};j.MACSTRING=function(t,e){var r=V.MACSTRING(t,e);return r!==void 0?r.length:0};function Qi(t){return t>=-128&&t<=127}function jh(t,e,r){for(var n=0,o=t.length;e<o&&n<64&&t[e]===0;)++e,++n;return r.push(128|n-1),e}function Kh(t,e,r){for(var n=0,o=t.length,i=e;i<o&&n<64;){var u=t[i];if(!Qi(u)||u===0&&i+1<o&&t[i+1]===0)break;++i,++n}r.push(n-1);for(var l=e;l<i;++l)r.push(t[l]+256&255);return i}function Qh(t,e,r){for(var n=0,o=t.length,i=e;i<o&&n<64;){var u=t[i];if(u===0||Qi(u)&&i+1<o&&Qi(t[i+1]))break;++i,++n}r.push(64|n-1);for(var l=e;l<i;++l){var f=t[l];r.push(f+65536>>8&255,f+256&255)}return i}V.VARDELTAS=function(t){for(var e=0,r=[];e<t.length;){var n=t[e];n===0?e=jh(t,e,r):n>=-128&&n<=127?e=Kh(t,e,r):e=Qh(t,e,r)}return r};V.INDEX=function(t){for(var e=1,r=[e],n=[],o=0;o<t.length;o+=1){var i=V.OBJECT(t[o]);Array.prototype.push.apply(n,i),e+=i.length,r.push(e)}if(n.length===0)return[0,0];for(var u=[],l=1+Math.floor(Math.log(e)/Math.log(2))/8|0,f=[void 0,V.BYTE,V.USHORT,V.UINT24,V.ULONG][l],p=0;p<r.length;p+=1){var d=f(r[p]);Array.prototype.push.apply(u,d)}return Array.prototype.concat(V.Card16(t.length),V.OffSize(l),u,n)};j.INDEX=function(t){return V.INDEX(t).length};V.DICT=function(t){for(var e=[],r=Object.keys(t),n=r.length,o=0;o<n;o+=1){var i=parseInt(r[o],0),u=t[i];e=e.concat(V.OPERAND(u.value,u.type)),e=e.concat(V.OPERATOR(i))}return e};j.DICT=function(t){return V.DICT(t).length};V.OPERATOR=function(t){return t<1200?[t]:[12,t-1200]};V.OPERAND=function(t,e){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n+=1)Q.argument(t.length===e.length,"Not enough arguments given for type"+e),r=r.concat(V.OPERAND(t[n],e[n]));else if(e==="SID")r=r.concat(V.NUMBER(t));else if(e==="offset")r=r.concat(V.NUMBER32(t));else if(e==="number")r=r.concat(V.NUMBER(t));else if(e==="real")r=r.concat(V.REAL(t));else throw new Error("Unknown operand type "+e);return r};V.OP=V.BYTE;j.OP=j.BYTE;var po=typeof WeakMap=="function"&&new WeakMap;V.CHARSTRING=function(t){if(po){var e=po.get(t);if(e!==void 0)return e}for(var r=[],n=t.length,o=0;o<n;o+=1){var i=t[o];r=r.concat(V[i.type](i.value))}return po&&po.set(t,r),r};j.CHARSTRING=function(t){return V.CHARSTRING(t).length};V.OBJECT=function(t){var e=V[t.type];return Q.argument(e!==void 0,"No encoding function for type "+t.type),e(t.value)};j.OBJECT=function(t){var e=j[t.type];return Q.argument(e!==void 0,"No sizeOf function for type "+t.type),e(t.value)};V.TABLE=function(t){for(var e=[],r=t.fields.length,n=[],o=[],i=0;i<r;i+=1){var u=t.fields[i],l=V[u.type];Q.argument(l!==void 0,"No encoding function for field type "+u.type+" ("+u.name+")");var f=t[u.name];f===void 0&&(f=u.value);var p=l(f);u.type==="TABLE"?(o.push(e.length),e=e.concat([0,0]),n.push(p)):e=e.concat(p)}for(var d=0;d<n.length;d+=1){var y=o[d],m=e.length;Q.argument(m<65536,"Table "+t.tableName+" too big."),e[y]=m>>8,e[y+1]=m&255,e=e.concat(n[d])}return e};j.TABLE=function(t){for(var e=0,r=t.fields.length,n=0;n<r;n+=1){var o=t.fields[n],i=j[o.type];Q.argument(i!==void 0,"No sizeOf function for field type "+o.type+" ("+o.name+")");var u=t[o.name];u===void 0&&(u=o.value),e+=i(u),o.type==="TABLE"&&(e+=2)}return e};V.RECORD=V.TABLE;j.RECORD=j.TABLE;V.LITERAL=function(t){return t};j.LITERAL=function(t){return t.length};function Ze(t,e,r){if(e.length&&(e[0].name!=="coverageFormat"||e[0].value===1))for(var n=0;n<e.length;n+=1){var o=e[n];this[o.name]=o.value}if(this.tableName=t,this.fields=e,r)for(var i=Object.keys(r),u=0;u<i.length;u+=1){var l=i[u],f=r[l];this[l]!==void 0&&(this[l]=f)}}Ze.prototype.encode=function(){return V.TABLE(this)};Ze.prototype.sizeOf=function(){return j.TABLE(this)};function mn(t,e,r){r===void 0&&(r=e.length);var n=new Array(e.length+1);n[0]={name:t+"Count",type:"USHORT",value:r};for(var o=0;o<e.length;o++)n[o+1]={name:t+o,type:"USHORT",value:e[o]};return n}function Ji(t,e,r){var n=e.length,o=new Array(n+1);o[0]={name:t+"Count",type:"USHORT",value:n};for(var i=0;i<n;i++)o[i+1]={name:t+i,type:"TABLE",value:r(e[i],i)};return o}function yn(t,e,r){var n=e.length,o=[];o[0]={name:t+"Count",type:"USHORT",value:n};for(var i=0;i<n;i++)o=o.concat(r(e[i],i));return o}function Lo(t){t.format===1?Ze.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(mn("glyph",t.glyphs))):t.format===2?Ze.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(yn("rangeRecord",t.ranges,function(e){return[{name:"startGlyphID",type:"USHORT",value:e.start},{name:"endGlyphID",type:"USHORT",value:e.end},{name:"startCoverageIndex",type:"USHORT",value:e.index}]}))):Q.assert(!1,"Coverage format must be 1 or 2.")}Lo.prototype=Object.create(Ze.prototype);Lo.prototype.constructor=Lo;function Uo(t){Ze.call(this,"scriptListTable",yn("scriptRecord",t,function(e,r){var n=e.script,o=n.defaultLangSys;return Q.assert(!!o,"Unable to write GSUB: script "+e.tag+" has no default language system."),[{name:"scriptTag"+r,type:"TAG",value:e.tag},{name:"script"+r,type:"TABLE",value:new Ze("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new Ze("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:o.reqFeatureIndex}].concat(mn("featureIndex",o.featureIndexes)))}].concat(yn("langSys",n.langSysRecords,function(i,u){var l=i.langSys;return[{name:"langSysTag"+u,type:"TAG",value:i.tag},{name:"langSys"+u,type:"TABLE",value:new Ze("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:l.reqFeatureIndex}].concat(mn("featureIndex",l.featureIndexes)))}]})))}]}))}Uo.prototype=Object.create(Ze.prototype);Uo.prototype.constructor=Uo;function Io(t){Ze.call(this,"featureListTable",yn("featureRecord",t,function(e,r){var n=e.feature;return[{name:"featureTag"+r,type:"TAG",value:e.tag},{name:"feature"+r,type:"TABLE",value:new Ze("featureTable",[{name:"featureParams",type:"USHORT",value:n.featureParams}].concat(mn("lookupListIndex",n.lookupListIndexes)))}]}))}Io.prototype=Object.create(Ze.prototype);Io.prototype.constructor=Io;function Go(t,e){Ze.call(this,"lookupListTable",Ji("lookup",t,function(r){var n=e[r.lookupType];return Q.assert(!!n,"Unable to write GSUB lookup type "+r.lookupType+" tables."),new Ze("lookupTable",[{name:"lookupType",type:"USHORT",value:r.lookupType},{name:"lookupFlag",type:"USHORT",value:r.lookupFlag}].concat(Ji("subtable",r.subtables,n)))}))}Go.prototype=Object.create(Ze.prototype);Go.prototype.constructor=Go;var X={Table:Ze,Record:Ze,Coverage:Lo,ScriptList:Uo,FeatureList:Io,LookupList:Go,ushortList:mn,tableList:Ji,recordList:yn};function gs(t,e){return t.getUint8(e)}function No(t,e){return t.getUint16(e,!1)}function Jh(t,e){return t.getInt16(e,!1)}function va(t,e){return t.getUint32(e,!1)}function Du(t,e){var r=t.getInt16(e,!1),n=t.getUint16(e+2,!1);return r+n/65535}function ep(t,e){for(var r="",n=e;n<e+4;n+=1)r+=String.fromCharCode(t.getInt8(n));return r}function tp(t,e,r){for(var n=0,o=0;o<r;o+=1)n<<=8,n+=t.getUint8(e+o);return n}function rp(t,e,r){for(var n=[],o=e;o<r;o+=1)n.push(t.getUint8(o));return n}function np(t){for(var e="",r=0;r<t.length;r+=1)e+=String.fromCharCode(t[r]);return e}var op={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function P(t,e){this.data=t,this.offset=e,this.relativeOffset=0}P.prototype.parseByte=function(){var t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t};P.prototype.parseChar=function(){var t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t};P.prototype.parseCard8=P.prototype.parseByte;P.prototype.parseUShort=function(){var t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t};P.prototype.parseCard16=P.prototype.parseUShort;P.prototype.parseSID=P.prototype.parseUShort;P.prototype.parseOffset16=P.prototype.parseUShort;P.prototype.parseShort=function(){var t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t};P.prototype.parseF2Dot14=function(){var t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t};P.prototype.parseULong=function(){var t=va(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t};P.prototype.parseOffset32=P.prototype.parseULong;P.prototype.parseFixed=function(){var t=Du(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t};P.prototype.parseString=function(t){var e=this.data,r=this.offset+this.relativeOffset,n="";this.relativeOffset+=t;for(var o=0;o<t;o++)n+=String.fromCharCode(e.getUint8(r+o));return n};P.prototype.parseTag=function(){return this.parseString(4)};P.prototype.parseLongDateTime=function(){var t=va(this.data,this.offset+this.relativeOffset+4);return t-=2082844800,this.relativeOffset+=8,t};P.prototype.parseVersion=function(t){var e=No(this.data,this.offset+this.relativeOffset),r=No(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,t===void 0&&(t=4096),e+r/t/10};P.prototype.skip=function(t,e){e===void 0&&(e=1),this.relativeOffset+=op[t]*e};P.prototype.parseULongList=function(t){t===void 0&&(t=this.parseULong());for(var e=new Array(t),r=this.data,n=this.offset+this.relativeOffset,o=0;o<t;o++)e[o]=r.getUint32(n),n+=4;return this.relativeOffset+=t*4,e};P.prototype.parseOffset16List=P.prototype.parseUShortList=function(t){t===void 0&&(t=this.parseUShort());for(var e=new Array(t),r=this.data,n=this.offset+this.relativeOffset,o=0;o<t;o++)e[o]=r.getUint16(n),n+=2;return this.relativeOffset+=t*2,e};P.prototype.parseShortList=function(t){for(var e=new Array(t),r=this.data,n=this.offset+this.relativeOffset,o=0;o<t;o++)e[o]=r.getInt16(n),n+=2;return this.relativeOffset+=t*2,e};P.prototype.parseByteList=function(t){for(var e=new Array(t),r=this.data,n=this.offset+this.relativeOffset,o=0;o<t;o++)e[o]=r.getUint8(n++);return this.relativeOffset+=t,e};P.prototype.parseList=function(t,e){e||(e=t,t=this.parseUShort());for(var r=new Array(t),n=0;n<t;n++)r[n]=e.call(this);return r};P.prototype.parseList32=function(t,e){e||(e=t,t=this.parseULong());for(var r=new Array(t),n=0;n<t;n++)r[n]=e.call(this);return r};P.prototype.parseRecordList=function(t,e){e||(e=t,t=this.parseUShort());for(var r=new Array(t),n=Object.keys(e),o=0;o<t;o++){for(var i={},u=0;u<n.length;u++){var l=n[u],f=e[l];i[l]=f.call(this)}r[o]=i}return r};P.prototype.parseRecordList32=function(t,e){e||(e=t,t=this.parseULong());for(var r=new Array(t),n=Object.keys(e),o=0;o<t;o++){for(var i={},u=0;u<n.length;u++){var l=n[u],f=e[l];i[l]=f.call(this)}r[o]=i}return r};P.prototype.parseStruct=function(t){if(typeof t=="function")return t.call(this);for(var e=Object.keys(t),r={},n=0;n<e.length;n++){var o=e[n],i=t[o];r[o]=i.call(this)}return r};P.prototype.parseValueRecord=function(t){if(t===void 0&&(t=this.parseUShort()),t!==0){var e={};return t&1&&(e.xPlacement=this.parseShort()),t&2&&(e.yPlacement=this.parseShort()),t&4&&(e.xAdvance=this.parseShort()),t&8&&(e.yAdvance=this.parseShort()),t&16&&(e.xPlaDevice=void 0,this.parseShort()),t&32&&(e.yPlaDevice=void 0,this.parseShort()),t&64&&(e.xAdvDevice=void 0,this.parseShort()),t&128&&(e.yAdvDevice=void 0,this.parseShort()),e}};P.prototype.parseValueRecordList=function(){for(var t=this.parseUShort(),e=this.parseUShort(),r=new Array(e),n=0;n<e;n++)r[n]=this.parseValueRecord(t);return r};P.prototype.parsePointer=function(t){var e=this.parseOffset16();if(e>0)return new P(this.data,this.offset+e).parseStruct(t)};P.prototype.parsePointer32=function(t){var e=this.parseOffset32();if(e>0)return new P(this.data,this.offset+e).parseStruct(t)};P.prototype.parseListOfLists=function(t){for(var e=this.parseOffset16List(),r=e.length,n=this.relativeOffset,o=new Array(r),i=0;i<r;i++){var u=e[i];if(u===0){o[i]=void 0;continue}if(this.relativeOffset=u,t){for(var l=this.parseOffset16List(),f=new Array(l.length),p=0;p<l.length;p++)this.relativeOffset=u+l[p],f[p]=t.call(this);o[i]=f}else o[i]=this.parseUShortList()}return this.relativeOffset=n,o};P.prototype.parseCoverage=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort(),r=this.parseUShort();if(e===1)return{format:1,glyphs:this.parseUShortList(r)};if(e===2){for(var n=new Array(r),o=0;o<r;o++)n[o]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:n}}throw new Error("0x"+t.toString(16)+": Coverage format must be 1 or 2.")};P.prototype.parseClassDef=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(e===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(e===2)return{format:2,ranges:this.parseRecordList({start:P.uShort,end:P.uShort,classId:P.uShort})};throw new Error("0x"+t.toString(16)+": ClassDef format must be 1 or 2.")};P.list=function(t,e){return function(){return this.parseList(t,e)}};P.list32=function(t,e){return function(){return this.parseList32(t,e)}};P.recordList=function(t,e){return function(){return this.parseRecordList(t,e)}};P.recordList32=function(t,e){return function(){return this.parseRecordList32(t,e)}};P.pointer=function(t){return function(){return this.parsePointer(t)}};P.pointer32=function(t){return function(){return this.parsePointer32(t)}};P.tag=P.prototype.parseTag;P.byte=P.prototype.parseByte;P.uShort=P.offset16=P.prototype.parseUShort;P.uShortList=P.prototype.parseUShortList;P.uLong=P.offset32=P.prototype.parseULong;P.uLongList=P.prototype.parseULongList;P.struct=P.prototype.parseStruct;P.coverage=P.prototype.parseCoverage;P.classDef=P.prototype.parseClassDef;var ms={reserved:P.uShort,reqFeatureIndex:P.uShort,featureIndexes:P.uShortList};P.prototype.parseScriptList=function(){return this.parsePointer(P.recordList({tag:P.tag,script:P.pointer({defaultLangSys:P.pointer(ms),langSysRecords:P.recordList({tag:P.tag,langSys:P.pointer(ms)})})}))||[]};P.prototype.parseFeatureList=function(){return this.parsePointer(P.recordList({tag:P.tag,feature:P.pointer({featureParams:P.offset16,lookupListIndexes:P.uShortList})}))||[]};P.prototype.parseLookupList=function(t){return this.parsePointer(P.list(P.pointer(function(){var e=this.parseUShort();Q.argument(1<=e&&e<=9,"GPOS/GSUB lookup type "+e+" unknown.");var r=this.parseUShort(),n=r&16;return{lookupType:e,lookupFlag:r,subtables:this.parseList(P.pointer(t[e])),markFilteringSet:n?this.parseUShort():void 0}})))||[]};P.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var t=this.parseUShort(),e=this.parseUShort();Q.argument(t===1&&e<1,"GPOS/GSUB feature variations table unknown.");var r=this.parseRecordList32({conditionSetOffset:P.offset32,featureTableSubstitutionOffset:P.offset32});return r})||[]};var te={getByte:gs,getCard8:gs,getUShort:No,getCard16:No,getShort:Jh,getULong:va,getFixed:Du,getTag:ep,getOffset:tp,getBytes:rp,bytesToString:np,Parser:P};function ip(t,e){e.parseUShort(),t.length=e.parseULong(),t.language=e.parseULong();var r;t.groupCount=r=e.parseULong(),t.glyphIndexMap={};for(var n=0;n<r;n+=1)for(var o=e.parseULong(),i=e.parseULong(),u=e.parseULong(),l=o;l<=i;l+=1)t.glyphIndexMap[l]=u,u++}function ap(t,e,r,n,o){t.length=e.parseUShort(),t.language=e.parseUShort();var i;t.segCount=i=e.parseUShort()>>1,e.skip("uShort",3),t.glyphIndexMap={};for(var u=new te.Parser(r,n+o+14),l=new te.Parser(r,n+o+16+i*2),f=new te.Parser(r,n+o+16+i*4),p=new te.Parser(r,n+o+16+i*6),d=n+o+16+i*8,y=0;y<i-1;y+=1)for(var m=void 0,S=u.parseUShort(),T=l.parseUShort(),x=f.parseShort(),C=p.parseUShort(),A=T;A<=S;A+=1)C!==0?(d=p.offset+p.relativeOffset-2,d+=C,d+=(A-T)*2,m=te.getUShort(r,d),m!==0&&(m=m+x&65535)):m=A+x&65535,t.glyphIndexMap[A]=m}function sp(t,e){var r={};r.version=te.getUShort(t,e),Q.argument(r.version===0,"cmap table version should be 0."),r.numTables=te.getUShort(t,e+2);for(var n=-1,o=r.numTables-1;o>=0;o-=1){var i=te.getUShort(t,e+4+o*8),u=te.getUShort(t,e+4+o*8+2);if(i===3&&(u===0||u===1||u===10)||i===0&&(u===0||u===1||u===2||u===3||u===4)){n=te.getULong(t,e+4+o*8+4);break}}if(n===-1)throw new Error("No valid cmap sub-tables found.");var l=new te.Parser(t,e+n);if(r.format=l.parseUShort(),r.format===12)ip(r,l);else if(r.format===4)ap(r,l,t,e,n);else throw new Error("Only format 4 and 12 cmap tables are supported (found format "+r.format+").");return r}function up(t,e,r){t.segments.push({end:e,start:e,delta:-(e-r),offset:0,glyphIndex:r})}function lp(t){t.segments.push({end:65535,start:65535,delta:1,offset:0})}function cp(t){var e=!0,r;for(r=t.length-1;r>0;r-=1){var n=t.get(r);if(n.unicode>65535){console.log("Adding CMAP format 12 (needed!)"),e=!1;break}}var o=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:e?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:e?12:12+8}];e||(o=o.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),o=o.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var i=new X.Table("cmap",o);for(i.segments=[],r=0;r<t.length;r+=1){for(var u=t.get(r),l=0;l<u.unicodes.length;l+=1)up(i,u.unicodes[l],r);i.segments=i.segments.sort(function(B,F){return B.start-F.start})}lp(i);var f=i.segments.length,p=0,d=[],y=[],m=[],S=[],T=[],x=[];for(r=0;r<f;r+=1){var C=i.segments[r];C.end<=65535&&C.start<=65535?(d=d.concat({name:"end_"+r,type:"USHORT",value:C.end}),y=y.concat({name:"start_"+r,type:"USHORT",value:C.start}),m=m.concat({name:"idDelta_"+r,type:"SHORT",value:C.delta}),S=S.concat({name:"idRangeOffset_"+r,type:"USHORT",value:C.offset}),C.glyphId!==void 0&&(T=T.concat({name:"glyph_"+r,type:"USHORT",value:C.glyphId}))):p+=1,!e&&C.glyphIndex!==void 0&&(x=x.concat({name:"cmap12Start_"+r,type:"ULONG",value:C.start}),x=x.concat({name:"cmap12End_"+r,type:"ULONG",value:C.end}),x=x.concat({name:"cmap12Glyph_"+r,type:"ULONG",value:C.glyphIndex}))}if(i.segCountX2=(f-p)*2,i.searchRange=Math.pow(2,Math.floor(Math.log(f-p)/Math.log(2)))*2,i.entrySelector=Math.log(i.searchRange/2)/Math.log(2),i.rangeShift=i.segCountX2-i.searchRange,i.fields=i.fields.concat(d),i.fields.push({name:"reservedPad",type:"USHORT",value:0}),i.fields=i.fields.concat(y),i.fields=i.fields.concat(m),i.fields=i.fields.concat(S),i.fields=i.fields.concat(T),i.cmap4Length=14+d.length*2+2+y.length*2+m.length*2+S.length*2+T.length*2,!e){var A=16+x.length*4;i.cmap12Offset=12+2*2+4+i.cmap4Length,i.fields=i.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:A},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:x.length/3}]),i.fields=i.fields.concat(x)}return i}var fp={parse:sp,make:cp},So=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],hp=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],pp=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],ys=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function Mu(t){this.font=t}Mu.prototype.charToGlyphIndex=function(t){var e=t.codePointAt(0),r=this.font.glyphs;if(r){for(var n=0;n<r.length;n+=1)for(var o=r.get(n),i=0;i<o.unicodes.length;i+=1)if(o.unicodes[i]===e)return n}return null};function Ho(t,e){this.encoding=t,this.charset=e}Ho.prototype.charToGlyphIndex=function(t){var e=t.codePointAt(0),r=this.encoding[e];return this.charset.indexOf(r)};function dp(t,e,r,n,o){t.beginPath(),t.moveTo(e,r),t.lineTo(n,o),t.stroke()}var hr={line:dp};function vp(t,e){var r=e||new $e;return{configurable:!0,get:function(){return typeof r=="function"&&(r=r()),r},set:function(n){r=n}}}function pt(t){this.bindConstructorValues(t)}pt.prototype.bindConstructorValues=function(t){this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||t.unicode!==void 0?[t.unicode]:[],"xMin"in t&&(this.xMin=t.xMin),"yMin"in t&&(this.yMin=t.yMin),"xMax"in t&&(this.xMax=t.xMax),"yMax"in t&&(this.yMax=t.yMax),"advanceWidth"in t&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",vp(this,t.path))};pt.prototype.addUnicode=function(t){this.unicodes.length===0&&(this.unicode=t),this.unicodes.push(t)};pt.prototype.getBoundingBox=function(){return this.path.getBoundingBox()};pt.prototype.getPath=function(t,e,r,n,o){t=t!==void 0?t:0,e=e!==void 0?e:0,r=r!==void 0?r:72;var i,u;n||(n={});var l=n.xScale,f=n.yScale;if(n.hinting&&o&&o.hinting&&(u=this.path&&o.hinting.exec(this,r)),u)i=o.hinting.getCommands(u),t=Math.round(t),e=Math.round(e),l=f=1;else{i=this.path.commands;var p=1/(this.path.unitsPerEm||1e3)*r;l===void 0&&(l=p),f===void 0&&(f=p)}for(var d=new $e,y=0;y<i.length;y+=1){var m=i[y];m.type==="M"?d.moveTo(t+m.x*l,e+-m.y*f):m.type==="L"?d.lineTo(t+m.x*l,e+-m.y*f):m.type==="Q"?d.quadraticCurveTo(t+m.x1*l,e+-m.y1*f,t+m.x*l,e+-m.y*f):m.type==="C"?d.curveTo(t+m.x1*l,e+-m.y1*f,t+m.x2*l,e+-m.y2*f,t+m.x*l,e+-m.y*f):m.type==="Z"&&d.closePath()}return d};pt.prototype.getContours=function(){if(this.points===void 0)return[];for(var t=[],e=[],r=0;r<this.points.length;r+=1){var n=this.points[r];e.push(n),n.lastPointOfContour&&(t.push(e),e=[])}return Q.argument(e.length===0,"There are still points left in the current contour."),t};pt.prototype.getMetrics=function(){for(var t=this.path.commands,e=[],r=[],n=0;n<t.length;n+=1){var o=t[n];o.type!=="Z"&&(e.push(o.x),r.push(o.y)),(o.type==="Q"||o.type==="C")&&(e.push(o.x1),r.push(o.y1)),o.type==="C"&&(e.push(o.x2),r.push(o.y2))}var i={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,r),leftSideBearing:this.leftSideBearing};return isFinite(i.xMin)||(i.xMin=0),isFinite(i.xMax)||(i.xMax=this.advanceWidth),isFinite(i.yMin)||(i.yMin=0),isFinite(i.yMax)||(i.yMax=0),i.rightSideBearing=this.advanceWidth-i.leftSideBearing-(i.xMax-i.xMin),i};pt.prototype.draw=function(t,e,r,n,o){this.getPath(e,r,n,o).draw(t)};pt.prototype.drawPoints=function(t,e,r,n){function o(y,m,S,T){t.beginPath();for(var x=0;x<y.length;x+=1)t.moveTo(m+y[x].x*T,S+y[x].y*T),t.arc(m+y[x].x*T,S+y[x].y*T,2,0,Math.PI*2,!1);t.closePath(),t.fill()}e=e!==void 0?e:0,r=r!==void 0?r:0,n=n!==void 0?n:24;for(var i=1/this.path.unitsPerEm*n,u=[],l=[],f=this.path,p=0;p<f.commands.length;p+=1){var d=f.commands[p];d.x!==void 0&&u.push({x:d.x,y:-d.y}),d.x1!==void 0&&l.push({x:d.x1,y:-d.y1}),d.x2!==void 0&&l.push({x:d.x2,y:-d.y2})}t.fillStyle="blue",o(u,e,r,i),t.fillStyle="red",o(l,e,r,i)};pt.prototype.drawMetrics=function(t,e,r,n){var o;e=e!==void 0?e:0,r=r!==void 0?r:0,n=n!==void 0?n:24,o=1/this.path.unitsPerEm*n,t.lineWidth=1,t.strokeStyle="black",hr.line(t,e,-1e4,e,1e4),hr.line(t,-1e4,r,1e4,r);var i=this.xMin||0,u=this.yMin||0,l=this.xMax||0,f=this.yMax||0,p=this.advanceWidth||0;t.strokeStyle="blue",hr.line(t,e+i*o,-1e4,e+i*o,1e4),hr.line(t,e+l*o,-1e4,e+l*o,1e4),hr.line(t,-1e4,r+-u*o,1e4,r+-u*o),hr.line(t,-1e4,r+-f*o,1e4,r+-f*o),t.strokeStyle="green",hr.line(t,e+p*o,-1e4,e+p*o,1e4)};function vo(t,e,r){Object.defineProperty(t,e,{get:function(){return t.path,t[r]},set:function(n){t[r]=n},enumerable:!0,configurable:!0})}function ga(t,e){if(this.font=t,this.glyphs={},Array.isArray(e))for(var r=0;r<e.length;r++){var n=e[r];n.path.unitsPerEm=t.unitsPerEm,this.glyphs[r]=n}this.length=e&&e.length||0}ga.prototype.get=function(t){if(this.glyphs[t]===void 0){this.font._push(t),typeof this.glyphs[t]=="function"&&(this.glyphs[t]=this.glyphs[t]());var e=this.glyphs[t],r=this.font._IndexToUnicodeMap[t];if(r)for(var n=0;n<r.unicodes.length;n++)e.addUnicode(r.unicodes[n]);this.font.cffEncoding?this.font.isCIDFont?e.name="gid"+t:e.name=this.font.cffEncoding.charset[t]:this.font.glyphNames.names&&(e.name=this.font.glyphNames.glyphIndexToName(t)),this.glyphs[t].advanceWidth=this.font._hmtxTableData[t].advanceWidth,this.glyphs[t].leftSideBearing=this.font._hmtxTableData[t].leftSideBearing}else typeof this.glyphs[t]=="function"&&(this.glyphs[t]=this.glyphs[t]());return this.glyphs[t]};ga.prototype.push=function(t,e){this.glyphs[t]=e,this.length++};function gp(t,e){return new pt({index:e,font:t})}function mp(t,e,r,n,o,i){return function(){var u=new pt({index:e,font:t});return u.path=function(){r(u,n,o);var l=i(t.glyphs,u);return l.unitsPerEm=t.unitsPerEm,l},vo(u,"xMin","_xMin"),vo(u,"xMax","_xMax"),vo(u,"yMin","_yMin"),vo(u,"yMax","_yMax"),u}}function yp(t,e,r,n){return function(){var o=new pt({index:e,font:t});return o.path=function(){var i=r(t,o,n);return i.unitsPerEm=t.unitsPerEm,i},o}}var Rt={GlyphSet:ga,glyphLoader:gp,ttfGlyphLoader:mp,cffGlyphLoader:yp};function Fu(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r+=1)if(!Fu(t[r],e[r]))return!1;return!0}else return!1}function ea(t){var e;return t.length<1240?e=107:t.length<33900?e=1131:e=32768,e}function Jt(t,e,r){var n=[],o=[],i=te.getCard16(t,e),u,l;if(i!==0){var f=te.getByte(t,e+2);u=e+(i+1)*f+2;for(var p=e+3,d=0;d<i+1;d+=1)n.push(te.getOffset(t,p,f)),p+=f;l=u+n[i]}else l=e+2;for(var y=0;y<n.length-1;y+=1){var m=te.getBytes(t,u+n[y],u+n[y+1]);r&&(m=r(m)),o.push(m)}return{objects:o,startOffset:e,endOffset:l}}function wp(t,e){var r=[],n=te.getCard16(t,e),o,i;if(n!==0){var u=te.getByte(t,e+2);o=e+(n+1)*u+2;for(var l=e+3,f=0;f<n+1;f+=1)r.push(te.getOffset(t,l,u)),l+=u;i=o+r[n]}else i=e+2;return{offsets:r,startOffset:e,endOffset:i}}function _p(t,e,r,n,o){var i=te.getCard16(r,n),u=0;if(i!==0){var l=te.getByte(r,n+2);u=n+(i+1)*l+2}var f=te.getBytes(r,u+e[t],u+e[t+1]);return o&&(f=o(f)),f}function bp(t){for(var e="",r=15,n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var o=t.parseByte(),i=o>>4,u=o&15;if(i===r||(e+=n[i],u===r))break;e+=n[u]}return parseFloat(e)}function Sp(t,e){var r,n,o,i;if(e===28)return r=t.parseByte(),n=t.parseByte(),r<<8|n;if(e===29)return r=t.parseByte(),n=t.parseByte(),o=t.parseByte(),i=t.parseByte(),r<<24|n<<16|o<<8|i;if(e===30)return bp(t);if(e>=32&&e<=246)return e-139;if(e>=247&&e<=250)return r=t.parseByte(),(e-247)*256+r+108;if(e>=251&&e<=254)return r=t.parseByte(),-(e-251)*256-r-108;throw new Error("Invalid b0 "+e)}function Tp(t){for(var e={},r=0;r<t.length;r+=1){var n=t[r][0],o=t[r][1],i=void 0;if(o.length===1?i=o[0]:i=o,e.hasOwnProperty(n)&&!isNaN(e[n]))throw new Error("Object "+e+" already has key "+n);e[n]=i}return e}function Bu(t,e,r){e=e!==void 0?e:0;var n=new te.Parser(t,e),o=[],i=[];for(r=r!==void 0?r:t.length;n.relativeOffset<r;){var u=n.parseByte();u<=21?(u===12&&(u=1200+n.parseByte()),o.push([u,i]),i=[]):i.push(Sp(n,u))}return Tp(o)}function hn(t,e){return e<=390?e=So[e]:e=t[e-391],e}function Lu(t,e,r){for(var n={},o,i=0;i<e.length;i+=1){var u=e[i];if(Array.isArray(u.type)){var l=[];l.length=u.type.length;for(var f=0;f<u.type.length;f++)o=t[u.op]!==void 0?t[u.op][f]:void 0,o===void 0&&(o=u.value!==void 0&&u.value[f]!==void 0?u.value[f]:null),u.type[f]==="SID"&&(o=hn(r,o)),l[f]=o;n[u.name]=l}else o=t[u.op],o===void 0&&(o=u.value!==void 0?u.value:null),u.type==="SID"&&(o=hn(r,o)),n[u.name]=o}return n}function Ep(t,e){var r={};return r.formatMajor=te.getCard8(t,e),r.formatMinor=te.getCard8(t,e+1),r.size=te.getCard8(t,e+2),r.offsetSize=te.getCard8(t,e+3),r.startOffset=e,r.endOffset=e+4,r}var Uu=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Iu=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function xp(t,e){var r=Bu(t,0,t.byteLength);return Lu(r,Uu,e)}function Gu(t,e,r,n){var o=Bu(t,e,r);return Lu(o,Iu,n)}function ws(t,e,r,n){for(var o=[],i=0;i<r.length;i+=1){var u=new DataView(new Uint8Array(r[i]).buffer),l=xp(u,n);l._subrs=[],l._subrsBias=0,l._defaultWidthX=0,l._nominalWidthX=0;var f=l.private[0],p=l.private[1];if(f!==0&&p!==0){var d=Gu(t,p+e,f,n);if(l._defaultWidthX=d.defaultWidthX,l._nominalWidthX=d.nominalWidthX,d.subrs!==0){var y=p+d.subrs,m=Jt(t,y+e);l._subrs=m.objects,l._subrsBias=ea(l._subrs)}l._privateDict=d}o.push(l)}return o}function Cp(t,e,r,n){var o,i,u=new te.Parser(t,e);r-=1;var l=[".notdef"],f=u.parseCard8();if(f===0)for(var p=0;p<r;p+=1)o=u.parseSID(),l.push(hn(n,o));else if(f===1)for(;l.length<=r;){o=u.parseSID(),i=u.parseCard8();for(var d=0;d<=i;d+=1)l.push(hn(n,o)),o+=1}else if(f===2)for(;l.length<=r;){o=u.parseSID(),i=u.parseCard16();for(var y=0;y<=i;y+=1)l.push(hn(n,o)),o+=1}else throw new Error("Unknown charset format "+f);return l}function Pp(t,e,r){var n,o={},i=new te.Parser(t,e),u=i.parseCard8();if(u===0)for(var l=i.parseCard8(),f=0;f<l;f+=1)n=i.parseCard8(),o[n]=f;else if(u===1){var p=i.parseCard8();n=1;for(var d=0;d<p;d+=1)for(var y=i.parseCard8(),m=i.parseCard8(),S=y;S<=y+m;S+=1)o[S]=n,n+=1}else throw new Error("Unknown encoding format "+u);return new Ho(o,r)}function _s(t,e,r){var n,o,i,u,l=new $e,f=[],p=0,d=!1,y=!1,m=0,S=0,T,x,C,A;if(t.isCIDFont){var B=t.tables.cff.topDict._fdSelect[e.index],F=t.tables.cff.topDict._fdArray[B];T=F._subrs,x=F._subrsBias,C=F._defaultWidthX,A=F._nominalWidthX}else T=t.tables.cff.topDict._subrs,x=t.tables.cff.topDict._subrsBias,C=t.tables.cff.topDict._defaultWidthX,A=t.tables.cff.topDict._nominalWidthX;var q=C;function z(ee,de){y&&l.closePath(),l.moveTo(ee,de),y=!0}function ie(){var ee;ee=f.length%2!==0,ee&&!d&&(q=f.shift()+A),p+=f.length>>1,f.length=0,d=!0}function re(ee){for(var de,Te,Oe,Re,Ce,ue,ge,Pe,ve,we,ke,Ge,_e=0;_e<ee.length;){var De=ee[_e];switch(_e+=1,De){case 1:ie();break;case 3:ie();break;case 4:f.length>1&&!d&&(q=f.shift()+A,d=!0),S+=f.pop(),z(m,S);break;case 5:for(;f.length>0;)m+=f.shift(),S+=f.shift(),l.lineTo(m,S);break;case 6:for(;f.length>0&&(m+=f.shift(),l.lineTo(m,S),f.length!==0);)S+=f.shift(),l.lineTo(m,S);break;case 7:for(;f.length>0&&(S+=f.shift(),l.lineTo(m,S),f.length!==0);)m+=f.shift(),l.lineTo(m,S);break;case 8:for(;f.length>0;)n=m+f.shift(),o=S+f.shift(),i=n+f.shift(),u=o+f.shift(),m=i+f.shift(),S=u+f.shift(),l.curveTo(n,o,i,u,m,S);break;case 10:Ce=f.pop()+x,ue=T[Ce],ue&&re(ue);break;case 11:return;case 12:switch(De=ee[_e],_e+=1,De){case 35:n=m+f.shift(),o=S+f.shift(),i=n+f.shift(),u=o+f.shift(),ge=i+f.shift(),Pe=u+f.shift(),ve=ge+f.shift(),we=Pe+f.shift(),ke=ve+f.shift(),Ge=we+f.shift(),m=ke+f.shift(),S=Ge+f.shift(),f.shift(),l.curveTo(n,o,i,u,ge,Pe),l.curveTo(ve,we,ke,Ge,m,S);break;case 34:n=m+f.shift(),o=S,i=n+f.shift(),u=o+f.shift(),ge=i+f.shift(),Pe=u,ve=ge+f.shift(),we=u,ke=ve+f.shift(),Ge=S,m=ke+f.shift(),l.curveTo(n,o,i,u,ge,Pe),l.curveTo(ve,we,ke,Ge,m,S);break;case 36:n=m+f.shift(),o=S+f.shift(),i=n+f.shift(),u=o+f.shift(),ge=i+f.shift(),Pe=u,ve=ge+f.shift(),we=u,ke=ve+f.shift(),Ge=we+f.shift(),m=ke+f.shift(),l.curveTo(n,o,i,u,ge,Pe),l.curveTo(ve,we,ke,Ge,m,S);break;case 37:n=m+f.shift(),o=S+f.shift(),i=n+f.shift(),u=o+f.shift(),ge=i+f.shift(),Pe=u+f.shift(),ve=ge+f.shift(),we=Pe+f.shift(),ke=ve+f.shift(),Ge=we+f.shift(),Math.abs(ke-m)>Math.abs(Ge-S)?m=ke+f.shift():S=Ge+f.shift(),l.curveTo(n,o,i,u,ge,Pe),l.curveTo(ve,we,ke,Ge,m,S);break;default:console.log("Glyph "+e.index+": unknown operator "+1200+De),f.length=0}break;case 14:f.length>0&&!d&&(q=f.shift()+A,d=!0),y&&(l.closePath(),y=!1);break;case 18:ie();break;case 19:case 20:ie(),_e+=p+7>>3;break;case 21:f.length>2&&!d&&(q=f.shift()+A,d=!0),S+=f.pop(),m+=f.pop(),z(m,S);break;case 22:f.length>1&&!d&&(q=f.shift()+A,d=!0),m+=f.pop(),z(m,S);break;case 23:ie();break;case 24:for(;f.length>2;)n=m+f.shift(),o=S+f.shift(),i=n+f.shift(),u=o+f.shift(),m=i+f.shift(),S=u+f.shift(),l.curveTo(n,o,i,u,m,S);m+=f.shift(),S+=f.shift(),l.lineTo(m,S);break;case 25:for(;f.length>6;)m+=f.shift(),S+=f.shift(),l.lineTo(m,S);n=m+f.shift(),o=S+f.shift(),i=n+f.shift(),u=o+f.shift(),m=i+f.shift(),S=u+f.shift(),l.curveTo(n,o,i,u,m,S);break;case 26:for(f.length%2&&(m+=f.shift());f.length>0;)n=m,o=S+f.shift(),i=n+f.shift(),u=o+f.shift(),m=i,S=u+f.shift(),l.curveTo(n,o,i,u,m,S);break;case 27:for(f.length%2&&(S+=f.shift());f.length>0;)n=m+f.shift(),o=S,i=n+f.shift(),u=o+f.shift(),m=i+f.shift(),S=u,l.curveTo(n,o,i,u,m,S);break;case 28:de=ee[_e],Te=ee[_e+1],f.push((de<<24|Te<<16)>>16),_e+=2;break;case 29:Ce=f.pop()+t.gsubrsBias,ue=t.gsubrs[Ce],ue&&re(ue);break;case 30:for(;f.length>0&&(n=m,o=S+f.shift(),i=n+f.shift(),u=o+f.shift(),m=i+f.shift(),S=u+(f.length===1?f.shift():0),l.curveTo(n,o,i,u,m,S),f.length!==0);)n=m+f.shift(),o=S,i=n+f.shift(),u=o+f.shift(),S=u+f.shift(),m=i+(f.length===1?f.shift():0),l.curveTo(n,o,i,u,m,S);break;case 31:for(;f.length>0&&(n=m+f.shift(),o=S,i=n+f.shift(),u=o+f.shift(),S=u+f.shift(),m=i+(f.length===1?f.shift():0),l.curveTo(n,o,i,u,m,S),f.length!==0);)n=m,o=S+f.shift(),i=n+f.shift(),u=o+f.shift(),m=i+f.shift(),S=u+(f.length===1?f.shift():0),l.curveTo(n,o,i,u,m,S);break;default:De<32?console.log("Glyph "+e.index+": unknown operator "+De):De<247?f.push(De-139):De<251?(de=ee[_e],_e+=1,f.push((De-247)*256+de+108)):De<255?(de=ee[_e],_e+=1,f.push(-(De-251)*256-de-108)):(de=ee[_e],Te=ee[_e+1],Oe=ee[_e+2],Re=ee[_e+3],_e+=4,f.push((de<<24|Te<<16|Oe<<8|Re)/65536))}}}return re(r),e.advanceWidth=q,l}function kp(t,e,r,n){var o=[],i,u=new te.Parser(t,e),l=u.parseCard8();if(l===0)for(var f=0;f<r;f++){if(i=u.parseCard8(),i>=n)throw new Error("CFF table CID Font FDSelect has bad FD index value "+i+" (FD count "+n+")");o.push(i)}else if(l===3){var p=u.parseCard16(),d=u.parseCard16();if(d!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+d);for(var y,m=0;m<p;m++){if(i=u.parseCard8(),y=u.parseCard16(),i>=n)throw new Error("CFF table CID Font FDSelect has bad FD index value "+i+" (FD count "+n+")");if(y>r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+y);for(;d<y;d++)o.push(i);d=y}if(y!==r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+y)}else throw new Error("CFF Table CID Font FDSelect table has unsupported format "+l);return o}function Ap(t,e,r,n){r.tables.cff={};var o=Ep(t,e),i=Jt(t,o.endOffset,te.bytesToString),u=Jt(t,i.endOffset),l=Jt(t,u.endOffset,te.bytesToString),f=Jt(t,l.endOffset);r.gsubrs=f.objects,r.gsubrsBias=ea(r.gsubrs);var p=ws(t,e,u.objects,l.objects);if(p.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+p.length);var d=p[0];if(r.tables.cff.topDict=d,d._privateDict&&(r.defaultWidthX=d._privateDict.defaultWidthX,r.nominalWidthX=d._privateDict.nominalWidthX),d.ros[0]!==void 0&&d.ros[1]!==void 0&&(r.isCIDFont=!0),r.isCIDFont){var y=d.fdArray,m=d.fdSelect;if(y===0||m===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");y+=e;var S=Jt(t,y),T=ws(t,e,S.objects,l.objects);d._fdArray=T,m+=e,d._fdSelect=kp(t,m,r.numGlyphs,T.length)}var x=e+d.private[1],C=Gu(t,x,d.private[0],l.objects);if(r.defaultWidthX=C.defaultWidthX,r.nominalWidthX=C.nominalWidthX,C.subrs!==0){var A=x+C.subrs,B=Jt(t,A);r.subrs=B.objects,r.subrsBias=ea(r.subrs)}else r.subrs=[],r.subrsBias=0;var F;n.lowMemory?(F=wp(t,e+d.charStrings),r.nGlyphs=F.offsets.length):(F=Jt(t,e+d.charStrings),r.nGlyphs=F.objects.length);var q=Cp(t,e+d.charset,r.nGlyphs,l.objects);if(d.encoding===0?r.cffEncoding=new Ho(hp,q):d.encoding===1?r.cffEncoding=new Ho(pp,q):r.cffEncoding=Pp(t,e+d.encoding,q),r.encoding=r.encoding||r.cffEncoding,r.glyphs=new Rt.GlyphSet(r),n.lowMemory)r._push=function(re){var ee=_p(re,F.offsets,t,e+d.charStrings);r.glyphs.push(re,Rt.cffGlyphLoader(r,re,_s,ee))};else for(var z=0;z<r.nGlyphs;z+=1){var ie=F.objects[z];r.glyphs.push(z,Rt.cffGlyphLoader(r,z,_s,ie))}}function Nu(t,e){var r,n=So.indexOf(t);return n>=0&&(r=n),n=e.indexOf(t),n>=0?r=n+So.length:(r=So.length+e.length,e.push(t)),r}function Op(){return new X.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function Rp(t){var e=new X.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(var r=0;r<t.length;r+=1)e.names.push({name:"name_"+r,type:"NAME",value:t[r]});return e}function Hu(t,e,r){for(var n={},o=0;o<t.length;o+=1){var i=t[o],u=e[i.name];u!==void 0&&!Fu(u,i.value)&&(i.type==="SID"&&(u=Nu(u,r)),n[i.op]={name:i.name,type:i.type,value:u})}return n}function bs(t,e){var r=new X.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=Hu(Uu,t,e),r}function Ss(t){var e=new X.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function Dp(t){var e=new X.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(var r=0;r<t.length;r+=1)e.strings.push({name:"string_"+r,type:"STRING",value:t[r]});return e}function Mp(){return new X.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function Fp(t,e){for(var r=new X.Record("Charsets",[{name:"format",type:"Card8",value:0}]),n=0;n<t.length;n+=1){var o=t[n],i=Nu(o,e);r.fields.push({name:"glyph_"+n,type:"SID",value:i})}return r}function Bp(t){var e=[],r=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});for(var n=0,o=0,i=0;i<r.commands.length;i+=1){var u=void 0,l=void 0,f=r.commands[i];if(f.type==="Q"){var p=.3333333333333333,d=2/3;f={type:"C",x:f.x,y:f.y,x1:Math.round(p*n+d*f.x1),y1:Math.round(p*o+d*f.y1),x2:Math.round(p*f.x+d*f.x1),y2:Math.round(p*f.y+d*f.y1)}}if(f.type==="M")u=Math.round(f.x-n),l=Math.round(f.y-o),e.push({name:"dx",type:"NUMBER",value:u}),e.push({name:"dy",type:"NUMBER",value:l}),e.push({name:"rmoveto",type:"OP",value:21}),n=Math.round(f.x),o=Math.round(f.y);else if(f.type==="L")u=Math.round(f.x-n),l=Math.round(f.y-o),e.push({name:"dx",type:"NUMBER",value:u}),e.push({name:"dy",type:"NUMBER",value:l}),e.push({name:"rlineto",type:"OP",value:5}),n=Math.round(f.x),o=Math.round(f.y);else if(f.type==="C"){var y=Math.round(f.x1-n),m=Math.round(f.y1-o),S=Math.round(f.x2-f.x1),T=Math.round(f.y2-f.y1);u=Math.round(f.x-f.x2),l=Math.round(f.y-f.y2),e.push({name:"dx1",type:"NUMBER",value:y}),e.push({name:"dy1",type:"NUMBER",value:m}),e.push({name:"dx2",type:"NUMBER",value:S}),e.push({name:"dy2",type:"NUMBER",value:T}),e.push({name:"dx",type:"NUMBER",value:u}),e.push({name:"dy",type:"NUMBER",value:l}),e.push({name:"rrcurveto",type:"OP",value:8}),n=Math.round(f.x),o=Math.round(f.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}function Lp(t){for(var e=new X.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),r=0;r<t.length;r+=1){var n=t.get(r),o=Bp(n);e.charStrings.push({name:n.name,type:"CHARSTRING",value:o})}return e}function Up(t,e){var r=new X.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=Hu(Iu,t,e),r}function Ip(t,e){for(var r=new X.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),n=1/e.unitsPerEm,o={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontBBox:e.fontBBox||[0,0,0,0],fontMatrix:[n,0,0,n,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},i={},u=[],l,f=1;f<t.length;f+=1)l=t.get(f),u.push(l.name);var p=[];r.header=Op(),r.nameIndex=Rp([e.postScriptName]);var d=bs(o,p);r.topDictIndex=Ss(d),r.globalSubrIndex=Mp(),r.charsets=Fp(u,p),r.charStringsIndex=Lp(t),r.privateDict=Up(i,p),r.stringIndex=Dp(p);var y=r.header.sizeOf()+r.nameIndex.sizeOf()+r.topDictIndex.sizeOf()+r.stringIndex.sizeOf()+r.globalSubrIndex.sizeOf();return o.charset=y,o.encoding=0,o.charStrings=o.charset+r.charsets.sizeOf(),o.private[1]=o.charStrings+r.charStringsIndex.sizeOf(),d=bs(o,p),r.topDictIndex=Ss(d),r}var Gp={parse:Ap,make:Ip};function Np(t,e){var r={},n=new te.Parser(t,e);return r.version=n.parseVersion(),r.fontRevision=Math.round(n.parseFixed()*1e3)/1e3,r.checkSumAdjustment=n.parseULong(),r.magicNumber=n.parseULong(),Q.argument(r.magicNumber===1594834165,"Font header has wrong magic number."),r.flags=n.parseUShort(),r.unitsPerEm=n.parseUShort(),r.created=n.parseLongDateTime(),r.modified=n.parseLongDateTime(),r.xMin=n.parseShort(),r.yMin=n.parseShort(),r.xMax=n.parseShort(),r.yMax=n.parseShort(),r.macStyle=n.parseUShort(),r.lowestRecPPEM=n.parseUShort(),r.fontDirectionHint=n.parseShort(),r.indexToLocFormat=n.parseShort(),r.glyphDataFormat=n.parseShort(),r}function Hp(t){var e=Math.round(new Date().getTime()/1e3)+2082844800,r=e;return t.createdTimestamp&&(r=t.createdTimestamp+2082844800),new X.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:r},{name:"modified",type:"LONGDATETIME",value:e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}var Vp={parse:Np,make:Hp};function zp(t,e){var r={},n=new te.Parser(t,e);return r.version=n.parseVersion(),r.ascender=n.parseShort(),r.descender=n.parseShort(),r.lineGap=n.parseShort(),r.advanceWidthMax=n.parseUShort(),r.minLeftSideBearing=n.parseShort(),r.minRightSideBearing=n.parseShort(),r.xMaxExtent=n.parseShort(),r.caretSlopeRise=n.parseShort(),r.caretSlopeRun=n.parseShort(),r.caretOffset=n.parseShort(),n.relativeOffset+=8,r.metricDataFormat=n.parseShort(),r.numberOfHMetrics=n.parseUShort(),r}function Wp(t){return new X.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}var Xp={parse:zp,make:Wp};function $p(t,e,r,n,o){for(var i,u,l=new te.Parser(t,e),f=0;f<n;f+=1){f<r&&(i=l.parseUShort(),u=l.parseShort());var p=o.get(f);p.advanceWidth=i,p.leftSideBearing=u}}function Yp(t,e,r,n,o){t._hmtxTableData={};for(var i,u,l=new te.Parser(e,r),f=0;f<o;f+=1)f<n&&(i=l.parseUShort(),u=l.parseShort()),t._hmtxTableData[f]={advanceWidth:i,leftSideBearing:u}}function Zp(t,e,r,n,o,i,u){u.lowMemory?Yp(t,e,r,n,o):$p(e,r,n,o,i)}function qp(t){for(var e=new X.Table("hmtx",[]),r=0;r<t.length;r+=1){var n=t.get(r),o=n.advanceWidth||0,i=n.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+r,type:"USHORT",value:o}),e.fields.push({name:"leftSideBearing_"+r,type:"SHORT",value:i})}return e}var jp={parse:Zp,make:qp};function Kp(t){for(var e=new X.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:t.length}]),r="",n=12+t.length*4,o=0;o<t.length;++o){var i=r.indexOf(t[o]);i<0&&(i=r.length,r+=t[o]),e.fields.push({name:"offset "+o,type:"USHORT",value:n+i}),e.fields.push({name:"length "+o,type:"USHORT",value:t[o].length})}return e.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),e}function Qp(t,e){var r=new te.Parser(t,e),n=r.parseULong();Q.argument(n===1,"Unsupported ltag table version."),r.skip("uLong",1);for(var o=r.parseULong(),i=[],u=0;u<o;u++){for(var l="",f=e+r.parseUShort(),p=r.parseUShort(),d=f;d<f+p;++d)l+=String.fromCharCode(t.getInt8(d));i.push(l)}return i}var Jp={make:Kp,parse:Qp};function ed(t,e){var r={},n=new te.Parser(t,e);return r.version=n.parseVersion(),r.numGlyphs=n.parseUShort(),r.version===1&&(r.maxPoints=n.parseUShort(),r.maxContours=n.parseUShort(),r.maxCompositePoints=n.parseUShort(),r.maxCompositeContours=n.parseUShort(),r.maxZones=n.parseUShort(),r.maxTwilightPoints=n.parseUShort(),r.maxStorage=n.parseUShort(),r.maxFunctionDefs=n.parseUShort(),r.maxInstructionDefs=n.parseUShort(),r.maxStackElements=n.parseUShort(),r.maxSizeOfInstructions=n.parseUShort(),r.maxComponentElements=n.parseUShort(),r.maxComponentDepth=n.parseUShort()),r}function td(t){return new X.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}var rd={parse:ed,make:td},Vu=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],zu={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},nd={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Wu={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function od(t,e,r){switch(t){case 0:if(e===65535)return"und";if(r)return r[e];break;case 1:return zu[e];case 3:return Wu[e]}}var ta="utf-16",id={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},ad={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Xu(t,e,r){switch(t){case 0:return ta;case 1:return ad[r]||id[e];case 3:if(e===1||e===10)return ta;break}}function sd(t,e,r){for(var n={},o=new te.Parser(t,e),i=o.parseUShort(),u=o.parseUShort(),l=o.offset+o.parseUShort(),f=0;f<u;f++){var p=o.parseUShort(),d=o.parseUShort(),y=o.parseUShort(),m=o.parseUShort(),S=Vu[m]||m,T=o.parseUShort(),x=o.parseUShort(),C=od(p,y,r),A=Xu(p,d,y);if(A!==void 0&&C!==void 0){var B=void 0;if(A===ta?B=zr.UTF16(t,l+x,T):B=zr.MACSTRING(t,l+x,T,A),B){var F=n[S];F===void 0&&(F=n[S]={}),F[C]=B}}}return i===1&&o.parseUShort(),n}function Fi(t){var e={};for(var r in t)e[t[r]]=parseInt(r);return e}function Ts(t,e,r,n,o,i){return new X.Record("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:r},{name:"nameID",type:"USHORT",value:n},{name:"length",type:"USHORT",value:o},{name:"offset",type:"USHORT",value:i}])}function ud(t,e){var r=t.length,n=e.length-r+1;e:for(var o=0;o<n;o++)for(;o<n;o++){for(var i=0;i<r;i++)if(e[o+i]!==t[i])continue e;return o}return-1}function Es(t,e){var r=ud(t,e);if(r<0){r=e.length;for(var n=0,o=t.length;n<o;++n)e.push(t[n])}return r}function ld(t,e){var r,n=[],o={},i=Fi(Vu);for(var u in t){var l=i[u];if(l===void 0&&(l=u),r=parseInt(l),isNaN(r))throw new Error('Name table entry "'+u+'" does not exist, see nameTableNames for complete list.');o[r]=t[u],n.push(r)}for(var f=Fi(zu),p=Fi(Wu),d=[],y=[],m=0;m<n.length;m++){r=n[m];var S=o[r];for(var T in S){var x=S[T],C=1,A=f[T],B=nd[A],F=Xu(C,B,A),q=V.MACSTRING(x,F);q===void 0&&(C=0,A=e.indexOf(T),A<0&&(A=e.length,e.push(T)),B=4,q=V.UTF16(x));var z=Es(q,y);d.push(Ts(C,B,A,r,q.length,z));var ie=p[T];if(ie!==void 0){var re=V.UTF16(x),ee=Es(re,y);d.push(Ts(3,1,ie,r,re.length,ee))}}}d.sort(function(Oe,Re){return Oe.platformID-Re.platformID||Oe.encodingID-Re.encodingID||Oe.languageID-Re.languageID||Oe.nameID-Re.nameID});for(var de=new X.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:d.length},{name:"stringOffset",type:"USHORT",value:6+d.length*12}]),Te=0;Te<d.length;Te++)de.fields.push({name:"record_"+Te,type:"RECORD",value:d[Te]});return de.fields.push({name:"strings",type:"LITERAL",value:y}),de}var cd={parse:sd,make:ld},ra=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function fd(t){for(var e=0;e<ra.length;e+=1){var r=ra[e];if(t>=r.begin&&t<r.end)return e}return-1}function hd(t,e){var r={},n=new te.Parser(t,e);r.version=n.parseUShort(),r.xAvgCharWidth=n.parseShort(),r.usWeightClass=n.parseUShort(),r.usWidthClass=n.parseUShort(),r.fsType=n.parseUShort(),r.ySubscriptXSize=n.parseShort(),r.ySubscriptYSize=n.parseShort(),r.ySubscriptXOffset=n.parseShort(),r.ySubscriptYOffset=n.parseShort(),r.ySuperscriptXSize=n.parseShort(),r.ySuperscriptYSize=n.parseShort(),r.ySuperscriptXOffset=n.parseShort(),r.ySuperscriptYOffset=n.parseShort(),r.yStrikeoutSize=n.parseShort(),r.yStrikeoutPosition=n.parseShort(),r.sFamilyClass=n.parseShort(),r.panose=[];for(var o=0;o<10;o++)r.panose[o]=n.parseByte();return r.ulUnicodeRange1=n.parseULong(),r.ulUnicodeRange2=n.parseULong(),r.ulUnicodeRange3=n.parseULong(),r.ulUnicodeRange4=n.parseULong(),r.achVendID=String.fromCharCode(n.parseByte(),n.parseByte(),n.parseByte(),n.parseByte()),r.fsSelection=n.parseUShort(),r.usFirstCharIndex=n.parseUShort(),r.usLastCharIndex=n.parseUShort(),r.sTypoAscender=n.parseShort(),r.sTypoDescender=n.parseShort(),r.sTypoLineGap=n.parseShort(),r.usWinAscent=n.parseUShort(),r.usWinDescent=n.parseUShort(),r.version>=1&&(r.ulCodePageRange1=n.parseULong(),r.ulCodePageRange2=n.parseULong()),r.version>=2&&(r.sxHeight=n.parseShort(),r.sCapHeight=n.parseShort(),r.usDefaultChar=n.parseUShort(),r.usBreakChar=n.parseUShort(),r.usMaxContent=n.parseUShort()),r}function pd(t){return new X.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)}var xs={parse:hd,make:pd,unicodeRanges:ra,getUnicodeRange:fd};function dd(t,e){var r={},n=new te.Parser(t,e);switch(r.version=n.parseVersion(),r.italicAngle=n.parseFixed(),r.underlinePosition=n.parseShort(),r.underlineThickness=n.parseShort(),r.isFixedPitch=n.parseULong(),r.minMemType42=n.parseULong(),r.maxMemType42=n.parseULong(),r.minMemType1=n.parseULong(),r.maxMemType1=n.parseULong(),r.version){case 1:r.names=ys.slice();break;case 2:r.numberOfGlyphs=n.parseUShort(),r.glyphNameIndex=new Array(r.numberOfGlyphs);for(var o=0;o<r.numberOfGlyphs;o++)r.glyphNameIndex[o]=n.parseUShort();r.names=[];for(var i=0;i<r.numberOfGlyphs;i++)if(r.glyphNameIndex[i]>=ys.length){var u=n.parseChar();r.names.push(n.parseString(u))}break;case 2.5:r.numberOfGlyphs=n.parseUShort(),r.offset=new Array(r.numberOfGlyphs);for(var l=0;l<r.numberOfGlyphs;l++)r.offset[l]=n.parseChar();break}return r}function vd(){return new X.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var gd={parse:dd,make:vd},_t=new Array(9);_t[1]=function(){var e=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:1,coverage:this.parsePointer(P.coverage),deltaGlyphId:this.parseUShort()};if(r===2)return{substFormat:2,coverage:this.parsePointer(P.coverage),substitute:this.parseOffset16List()};Q.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")};_t[2]=function(){var e=this.parseUShort();return Q.argument(e===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(P.coverage),sequences:this.parseListOfLists()}};_t[3]=function(){var e=this.parseUShort();return Q.argument(e===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(P.coverage),alternateSets:this.parseListOfLists()}};_t[4]=function(){var e=this.parseUShort();return Q.argument(e===1,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(P.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var Ur={sequenceIndex:P.uShort,lookupListIndex:P.uShort};_t[5]=function(){var e=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:r,coverage:this.parsePointer(P.coverage),ruleSets:this.parseListOfLists(function(){var i=this.parseUShort(),u=this.parseUShort();return{input:this.parseUShortList(i-1),lookupRecords:this.parseRecordList(u,Ur)}})};if(r===2)return{substFormat:r,coverage:this.parsePointer(P.coverage),classDef:this.parsePointer(P.classDef),classSets:this.parseListOfLists(function(){var i=this.parseUShort(),u=this.parseUShort();return{classes:this.parseUShortList(i-1),lookupRecords:this.parseRecordList(u,Ur)}})};if(r===3){var n=this.parseUShort(),o=this.parseUShort();return{substFormat:r,coverages:this.parseList(n,P.pointer(P.coverage)),lookupRecords:this.parseRecordList(o,Ur)}}Q.assert(!1,"0x"+e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")};_t[6]=function(){var e=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{substFormat:1,coverage:this.parsePointer(P.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(Ur)}})};if(r===2)return{substFormat:2,coverage:this.parsePointer(P.coverage),backtrackClassDef:this.parsePointer(P.classDef),inputClassDef:this.parsePointer(P.classDef),lookaheadClassDef:this.parsePointer(P.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(Ur)}})};if(r===3)return{substFormat:3,backtrackCoverage:this.parseList(P.pointer(P.coverage)),inputCoverage:this.parseList(P.pointer(P.coverage)),lookaheadCoverage:this.parseList(P.pointer(P.coverage)),lookupRecords:this.parseRecordList(Ur)};Q.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")};_t[7]=function(){var e=this.parseUShort();Q.argument(e===1,"GSUB Extension Substitution subtable identifier-format must be 1");var r=this.parseUShort(),n=new P(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:r,extension:_t[r].call(n)}};_t[8]=function(){var e=this.parseUShort();return Q.argument(e===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(P.coverage),backtrackCoverage:this.parseList(P.pointer(P.coverage)),lookaheadCoverage:this.parseList(P.pointer(P.coverage)),substitutes:this.parseUShortList()}};function md(t,e){e=e||0;var r=new P(t,e),n=r.parseVersion(1);return Q.argument(n===1||n===1.1,"Unsupported GSUB table version."),n===1?{version:n,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(_t)}:{version:n,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(_t),variations:r.parseFeatureVariationsList()}}var Xr=new Array(9);Xr[1]=function(e){return e.substFormat===1?new X.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new X.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new X.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new X.Coverage(e.coverage)}].concat(X.ushortList("substitute",e.substitute)))};Xr[2]=function(e){return Q.assert(e.substFormat===1,"Lookup type 2 substFormat must be 1."),new X.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new X.Coverage(e.coverage)}].concat(X.tableList("seqSet",e.sequences,function(r){return new X.Table("sequenceSetTable",X.ushortList("sequence",r))})))};Xr[3]=function(e){return Q.assert(e.substFormat===1,"Lookup type 3 substFormat must be 1."),new X.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new X.Coverage(e.coverage)}].concat(X.tableList("altSet",e.alternateSets,function(r){return new X.Table("alternateSetTable",X.ushortList("alternate",r))})))};Xr[4]=function(e){return Q.assert(e.substFormat===1,"Lookup type 4 substFormat must be 1."),new X.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new X.Coverage(e.coverage)}].concat(X.tableList("ligSet",e.ligatureSets,function(r){return new X.Table("ligatureSetTable",X.tableList("ligature",r,function(n){return new X.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:n.ligGlyph}].concat(X.ushortList("component",n.components,n.components.length+1)))}))})))};Xr[6]=function(e){if(e.substFormat===1){var r=new X.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:e.substFormat},{name:"coverage",type:"TABLE",value:new X.Coverage(e.coverage)}].concat(X.tableList("chainRuleSet",e.chainRuleSets,function(i){return new X.Table("chainRuleSetTable",X.tableList("chainRule",i,function(u){var l=X.ushortList("backtrackGlyph",u.backtrack,u.backtrack.length).concat(X.ushortList("inputGlyph",u.input,u.input.length+1)).concat(X.ushortList("lookaheadGlyph",u.lookahead,u.lookahead.length)).concat(X.ushortList("substitution",[],u.lookupRecords.length));return u.lookupRecords.forEach(function(f,p){l=l.concat({name:"sequenceIndex"+p,type:"USHORT",value:f.sequenceIndex}).concat({name:"lookupListIndex"+p,type:"USHORT",value:f.lookupListIndex})}),new X.Table("chainRuleTable",l)}))})));return r}else if(e.substFormat===2)Q.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(e.substFormat===3){var n=[{name:"substFormat",type:"USHORT",value:e.substFormat}];n.push({name:"backtrackGlyphCount",type:"USHORT",value:e.backtrackCoverage.length}),e.backtrackCoverage.forEach(function(i,u){n.push({name:"backtrackCoverage"+u,type:"TABLE",value:new X.Coverage(i)})}),n.push({name:"inputGlyphCount",type:"USHORT",value:e.inputCoverage.length}),e.inputCoverage.forEach(function(i,u){n.push({name:"inputCoverage"+u,type:"TABLE",value:new X.Coverage(i)})}),n.push({name:"lookaheadGlyphCount",type:"USHORT",value:e.lookaheadCoverage.length}),e.lookaheadCoverage.forEach(function(i,u){n.push({name:"lookaheadCoverage"+u,type:"TABLE",value:new X.Coverage(i)})}),n.push({name:"substitutionCount",type:"USHORT",value:e.lookupRecords.length}),e.lookupRecords.forEach(function(i,u){n=n.concat({name:"sequenceIndex"+u,type:"USHORT",value:i.sequenceIndex}).concat({name:"lookupListIndex"+u,type:"USHORT",value:i.lookupListIndex})});var o=new X.Table("chainContextTable",n);return o}Q.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};function yd(t){return new X.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new X.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new X.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new X.LookupList(t.lookups,Xr)}])}var wd={parse:md,make:yd};function _d(t,e){var r=new te.Parser(t,e),n=r.parseULong();Q.argument(n===1,"Unsupported META table version."),r.parseULong(),r.parseULong();for(var o=r.parseULong(),i={},u=0;u<o;u++){var l=r.parseTag(),f=r.parseULong(),p=r.parseULong(),d=zr.UTF8(t,e+f,p);i[l]=d}return i}function bd(t){var e=Object.keys(t).length,r="",n=16+e*12,o=new X.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:n},{name:"numTags",type:"ULONG",value:e}]);for(var i in t){var u=r.length;r+=t[i],o.fields.push({name:"tag "+i,type:"TAG",value:i}),o.fields.push({name:"offset "+i,type:"ULONG",value:n+u}),o.fields.push({name:"length "+i,type:"ULONG",value:t[i].length})}return o.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),o}var Sd={parse:_d,make:bd};function Cs(t){return Math.log(t)/Math.log(2)|0}function ma(t){for(;t.length%4!==0;)t.push(0);for(var e=0,r=0;r<t.length;r+=4)e+=(t[r]<<24)+(t[r+1]<<16)+(t[r+2]<<8)+t[r+3];return e%=Math.pow(2,32),e}function Ps(t,e,r,n){return new X.Record("Table Record",[{name:"tag",type:"TAG",value:t!==void 0?t:""},{name:"checkSum",type:"ULONG",value:e!==void 0?e:0},{name:"offset",type:"ULONG",value:r!==void 0?r:0},{name:"length",type:"ULONG",value:n!==void 0?n:0}])}function $u(t){var e=new X.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;var r=Math.pow(2,Cs(e.numTables));e.searchRange=16*r,e.entrySelector=Cs(r),e.rangeShift=e.numTables*16-e.searchRange;for(var n=[],o=[],i=e.sizeOf()+Ps().sizeOf()*e.numTables;i%4!==0;)i+=1,o.push({name:"padding",type:"BYTE",value:0});for(var u=0;u<t.length;u+=1){var l=t[u];Q.argument(l.tableName.length===4,"Table name"+l.tableName+" is invalid.");var f=l.sizeOf(),p=Ps(l.tableName,ma(l.encode()),i,f);for(n.push({name:p.tag+" Table Record",type:"RECORD",value:p}),o.push({name:l.tableName+" table",type:"RECORD",value:l}),i+=f,Q.argument(!isNaN(i),"Something went wrong calculating the offset.");i%4!==0;)i+=1,o.push({name:"padding",type:"BYTE",value:0})}return n.sort(function(d,y){return d.value.tag>y.value.tag?1:-1}),e.fields=e.fields.concat(n),e.fields=e.fields.concat(o),e}function ks(t,e,r){for(var n=0;n<e.length;n+=1){var o=t.charToGlyphIndex(e[n]);if(o>0){var i=t.glyphs.get(o);return i.getMetrics()}}return r}function Td(t){for(var e=0,r=0;r<t.length;r+=1)e+=t[r];return e/t.length}function Ed(t){for(var e=[],r=[],n=[],o=[],i=[],u=[],l=[],f,p=0,d=0,y=0,m=0,S=0,T=0;T<t.glyphs.length;T+=1){var x=t.glyphs.get(T),C=x.unicode|0;if(isNaN(x.advanceWidth))throw new Error("Glyph "+x.name+" ("+T+"): advanceWidth is not a number.");(f>C||f===void 0)&&C>0&&(f=C),p<C&&(p=C);var A=xs.getUnicodeRange(C);if(A<32)d|=1<<A;else if(A<64)y|=1<<A-32;else if(A<96)m|=1<<A-64;else if(A<123)S|=1<<A-96;else throw new Error("Unicode ranges bits > 123 are reserved for internal usage");if(x.name!==".notdef"){var B=x.getMetrics();e.push(B.xMin),r.push(B.yMin),n.push(B.xMax),o.push(B.yMax),u.push(B.leftSideBearing),l.push(B.rightSideBearing),i.push(x.advanceWidth)}}var F={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,n),yMax:Math.max.apply(null,o),advanceWidthMax:Math.max.apply(null,i),advanceWidthAvg:Td(i),minLeftSideBearing:Math.min.apply(null,u),maxLeftSideBearing:Math.max.apply(null,u),minRightSideBearing:Math.min.apply(null,l)};F.ascender=t.ascender,F.descender=t.descender;var q=Vp.make({flags:3,unitsPerEm:t.unitsPerEm,xMin:F.xMin,yMin:F.yMin,xMax:F.xMax,yMax:F.yMax,lowestRecPPEM:3,createdTimestamp:t.createdTimestamp}),z=Xp.make({ascender:F.ascender,descender:F.descender,advanceWidthMax:F.advanceWidthMax,minLeftSideBearing:F.minLeftSideBearing,minRightSideBearing:F.minRightSideBearing,xMaxExtent:F.maxLeftSideBearing+(F.xMax-F.xMin),numberOfHMetrics:t.glyphs.length}),ie=rd.make(t.glyphs.length),re=xs.make(Object.assign({xAvgCharWidth:Math.round(F.advanceWidthAvg),usFirstCharIndex:f,usLastCharIndex:p,ulUnicodeRange1:d,ulUnicodeRange2:y,ulUnicodeRange3:m,ulUnicodeRange4:S,sTypoAscender:F.ascender,sTypoDescender:F.descender,sTypoLineGap:0,usWinAscent:F.yMax,usWinDescent:Math.abs(F.yMin),ulCodePageRange1:1,sxHeight:ks(t,"xyvw",{yMax:Math.round(F.ascender/2)}).yMax,sCapHeight:ks(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",F).yMax,usDefaultChar:t.hasChar(" ")?32:0,usBreakChar:t.hasChar(" ")?32:0},t.tables.os2)),ee=jp.make(t.glyphs),de=fp.make(t.glyphs),Te=t.getEnglishName("fontFamily"),Oe=t.getEnglishName("fontSubfamily"),Re=Te+" "+Oe,Ce=t.getEnglishName("postScriptName");Ce||(Ce=Te.replace(/\s/g,"")+"-"+Oe);var ue={};for(var ge in t.names)ue[ge]=t.names[ge];ue.uniqueID||(ue.uniqueID={en:t.getEnglishName("manufacturer")+":"+Re}),ue.postScriptName||(ue.postScriptName={en:Ce}),ue.preferredFamily||(ue.preferredFamily=t.names.fontFamily),ue.preferredSubfamily||(ue.preferredSubfamily=t.names.fontSubfamily);var Pe=[],ve=cd.make(ue,Pe),we=Pe.length>0?Jp.make(Pe):void 0,ke=gd.make(),Ge=Gp.make(t.glyphs,{version:t.getEnglishName("version"),fullName:Re,familyName:Te,weightName:Oe,postScriptName:Ce,unitsPerEm:t.unitsPerEm,fontBBox:[0,F.yMin,F.ascender,F.advanceWidthMax]}),_e=t.metas&&Object.keys(t.metas).length>0?Sd.make(t.metas):void 0,De=[q,z,ie,re,ve,de,ke,Ge,ee];we&&De.push(we),t.tables.gsub&&De.push(wd.make(t.tables.gsub)),_e&&De.push(_e);for(var $t=$u(De),rt=$t.encode(),je=ma(rt),ut=$t.fields,Sr=!1,lt=0;lt<ut.length;lt+=1)if(ut[lt].name==="head table"){ut[lt].value.checkSumAdjustment=2981146554-je,Sr=!0;break}if(!Sr)throw new Error("Could not find head table with checkSum to adjust.");return $t}var xd={make:$u,fontToTable:Ed,computeCheckSum:ma};function Bi(t,e){for(var r=0,n=t.length-1;r<=n;){var o=r+n>>>1,i=t[o].tag;if(i===e)return o;i<e?r=o+1:n=o-1}return-r-1}function As(t,e){for(var r=0,n=t.length-1;r<=n;){var o=r+n>>>1,i=t[o];if(i===e)return o;i<e?r=o+1:n=o-1}return-r-1}function Os(t,e){for(var r,n=0,o=t.length-1;n<=o;){var i=n+o>>>1;r=t[i];var u=r.start;if(u===e)return r;u<e?n=i+1:o=i-1}if(n>0)return r=t[n-1],e>r.end?0:r}function Cn(t,e){this.font=t,this.tableName=e}Cn.prototype={searchTag:Bi,binSearch:As,getTable:function(t){var e=this.font.tables[this.tableName];return!e&&t&&(e=this.font.tables[this.tableName]=this.createDefaultTable()),e},getScriptNames:function(){var t=this.getTable();return t?t.scripts.map(function(e){return e.tag}):[]},getDefaultScriptName:function(){var t=this.getTable();if(t){for(var e=!1,r=0;r<t.scripts.length;r++){var n=t.scripts[r].tag;if(n==="DFLT")return n;n==="latn"&&(e=!0)}if(e)return"latn"}},getScriptTable:function(t,e){var r=this.getTable(e);if(r){t=t||"DFLT";var n=r.scripts,o=Bi(r.scripts,t);if(o>=0)return n[o].script;if(e){var i={tag:t,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return n.splice(-1-o,0,i),i.script}}},getLangSysTable:function(t,e,r){var n=this.getScriptTable(t,r);if(n){if(!e||e==="dflt"||e==="DFLT")return n.defaultLangSys;var o=Bi(n.langSysRecords,e);if(o>=0)return n.langSysRecords[o].langSys;if(r){var i={tag:e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return n.langSysRecords.splice(-1-o,0,i),i.langSys}}},getFeatureTable:function(t,e,r,n){var o=this.getLangSysTable(t,e,n);if(o){for(var i,u=o.featureIndexes,l=this.font.tables[this.tableName].features,f=0;f<u.length;f++)if(i=l[u[f]],i.tag===r)return i.feature;if(n){var p=l.length;return Q.assert(p===0||r>=l[p-1].tag,"Features must be added in alphabetical order."),i={tag:r,feature:{params:0,lookupListIndexes:[]}},l.push(i),u.push(p),i.feature}}},getLookupTables:function(t,e,r,n,o){var i=this.getFeatureTable(t,e,r,o),u=[];if(i){for(var l,f=i.lookupListIndexes,p=this.font.tables[this.tableName].lookups,d=0;d<f.length;d++)l=p[f[d]],l.lookupType===n&&u.push(l);if(u.length===0&&o){l={lookupType:n,lookupFlag:0,subtables:[],markFilteringSet:void 0};var y=p.length;return p.push(l),f.push(y),[l]}}return u},getGlyphClass:function(t,e){switch(t.format){case 1:return t.startGlyph<=e&&e<t.startGlyph+t.classes.length?t.classes[e-t.startGlyph]:0;case 2:var r=Os(t.ranges,e);return r?r.classId:0}},getCoverageIndex:function(t,e){switch(t.format){case 1:var r=As(t.glyphs,e);return r>=0?r:-1;case 2:var n=Os(t.ranges,e);return n?n.index+e-n.start:-1}},expandCoverage:function(t){if(t.format===1)return t.glyphs;for(var e=[],r=t.ranges,n=0;n<r.length;n++)for(var o=r[n],i=o.start,u=o.end,l=i;l<=u;l++)e.push(l);return e}};function Pn(t){Cn.call(this,t,"gpos")}Pn.prototype=Cn.prototype;Pn.prototype.init=function(){var t=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(t)};Pn.prototype.getKerningValue=function(t,e,r){for(var n=0;n<t.length;n++)for(var o=t[n].subtables,i=0;i<o.length;i++){var u=o[i],l=this.getCoverageIndex(u.coverage,e);if(!(l<0))switch(u.posFormat){case 1:for(var f=u.pairSets[l],p=0;p<f.length;p++){var d=f[p];if(d.secondGlyph===r)return d.value1&&d.value1.xAdvance||0}break;case 2:var y=this.getGlyphClass(u.classDef1,e),m=this.getGlyphClass(u.classDef2,r),S=u.classRecords[y][m];return S.value1&&S.value1.xAdvance||0}}return 0};Pn.prototype.getKerningTables=function(t,e){if(this.font.tables.gpos)return this.getLookupTables(t,e,"kern",2)};function at(t){Cn.call(this,t,"gsub")}function Cd(t,e){var r=t.length;if(r!==e.length)return!1;for(var n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function ya(t,e,r){for(var n=t.subtables,o=0;o<n.length;o++){var i=n[o];if(i.substFormat===e)return i}if(r)return n.push(r),r}at.prototype=Cn.prototype;at.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}};at.prototype.getSingle=function(t,e,r){for(var n=[],o=this.getLookupTables(e,r,t,1),i=0;i<o.length;i++)for(var u=o[i].subtables,l=0;l<u.length;l++){var f=u[l],p=this.expandCoverage(f.coverage),d=void 0;if(f.substFormat===1){var y=f.deltaGlyphId;for(d=0;d<p.length;d++){var m=p[d];n.push({sub:m,by:m+y})}}else{var S=f.substitute;for(d=0;d<p.length;d++)n.push({sub:p[d],by:S[d]})}}return n};at.prototype.getMultiple=function(t,e,r){for(var n=[],o=this.getLookupTables(e,r,t,2),i=0;i<o.length;i++)for(var u=o[i].subtables,l=0;l<u.length;l++){var f=u[l],p=this.expandCoverage(f.coverage),d=void 0;for(d=0;d<p.length;d++){var y=p[d],m=f.sequences[d];n.push({sub:y,by:m})}}return n};at.prototype.getAlternates=function(t,e,r){for(var n=[],o=this.getLookupTables(e,r,t,3),i=0;i<o.length;i++)for(var u=o[i].subtables,l=0;l<u.length;l++)for(var f=u[l],p=this.expandCoverage(f.coverage),d=f.alternateSets,y=0;y<p.length;y++)n.push({sub:p[y],by:d[y]});return n};at.prototype.getLigatures=function(t,e,r){for(var n=[],o=this.getLookupTables(e,r,t,4),i=0;i<o.length;i++)for(var u=o[i].subtables,l=0;l<u.length;l++)for(var f=u[l],p=this.expandCoverage(f.coverage),d=f.ligatureSets,y=0;y<p.length;y++)for(var m=p[y],S=d[y],T=0;T<S.length;T++){var x=S[T];n.push({sub:[m].concat(x.components),by:x.ligGlyph})}return n};at.prototype.addSingle=function(t,e,r,n){var o=this.getLookupTables(r,n,t,1,!0)[0],i=ya(o,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});Q.assert(i.coverage.format===1,"Single: unable to modify coverage table format "+i.coverage.format);var u=e.sub,l=this.binSearch(i.coverage.glyphs,u);l<0&&(l=-1-l,i.coverage.glyphs.splice(l,0,u),i.substitute.splice(l,0,0)),i.substitute[l]=e.by};at.prototype.addMultiple=function(t,e,r,n){Q.assert(e.by instanceof Array&&e.by.length>1,'Multiple: "by" must be an array of two or more ids');var o=this.getLookupTables(r,n,t,2,!0)[0],i=ya(o,1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});Q.assert(i.coverage.format===1,"Multiple: unable to modify coverage table format "+i.coverage.format);var u=e.sub,l=this.binSearch(i.coverage.glyphs,u);l<0&&(l=-1-l,i.coverage.glyphs.splice(l,0,u),i.sequences.splice(l,0,0)),i.sequences[l]=e.by};at.prototype.addAlternate=function(t,e,r,n){var o=this.getLookupTables(r,n,t,3,!0)[0],i=ya(o,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});Q.assert(i.coverage.format===1,"Alternate: unable to modify coverage table format "+i.coverage.format);var u=e.sub,l=this.binSearch(i.coverage.glyphs,u);l<0&&(l=-1-l,i.coverage.glyphs.splice(l,0,u),i.alternateSets.splice(l,0,0)),i.alternateSets[l]=e.by};at.prototype.addLigature=function(t,e,r,n){var o=this.getLookupTables(r,n,t,4,!0)[0],i=o.subtables[0];i||(i={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},o.subtables[0]=i),Q.assert(i.coverage.format===1,"Ligature: unable to modify coverage table format "+i.coverage.format);var u=e.sub[0],l=e.sub.slice(1),f={ligGlyph:e.by,components:l},p=this.binSearch(i.coverage.glyphs,u);if(p>=0){for(var d=i.ligatureSets[p],y=0;y<d.length;y++)if(Cd(d[y].components,l))return;d.push(f)}else p=-1-p,i.coverage.glyphs.splice(p,0,u),i.ligatureSets.splice(p,0,[f])};at.prototype.getFeature=function(t,e,r){if(/ss\d\d/.test(t))return this.getSingle(t,e,r);switch(t){case"aalt":case"salt":return this.getSingle(t,e,r).concat(this.getAlternates(t,e,r));case"dlig":case"liga":case"rlig":return this.getLigatures(t,e,r);case"ccmp":return this.getMultiple(t,e,r).concat(this.getLigatures(t,e,r));case"stch":return this.getMultiple(t,e,r)}};at.prototype.add=function(t,e,r,n){if(/ss\d\d/.test(t))return this.addSingle(t,e,r,n);switch(t){case"aalt":case"salt":return typeof e.by=="number"?this.addSingle(t,e,r,n):this.addAlternate(t,e,r,n);case"dlig":case"liga":case"rlig":return this.addLigature(t,e,r,n);case"ccmp":return e.by instanceof Array?this.addMultiple(t,e,r,n):this.addLigature(t,e,r,n)}};function Pd(){return typeof window<"u"}function kd(t){for(var e=new Buffer(t.byteLength),r=new Uint8Array(t),n=0;n<e.length;++n)e[n]=r[n];return e}function on(t,e){if(!t)throw e}function Rs(t,e,r,n,o){var i;return(e&n)>0?(i=t.parseByte(),e&o||(i=-i),i=r+i):(e&o)>0?i=r:i=r+t.parseShort(),i}function Yu(t,e,r){var n=new te.Parser(e,r);t.numberOfContours=n.parseShort(),t._xMin=n.parseShort(),t._yMin=n.parseShort(),t._xMax=n.parseShort(),t._yMax=n.parseShort();var o,i;if(t.numberOfContours>0){for(var u=t.endPointIndices=[],l=0;l<t.numberOfContours;l+=1)u.push(n.parseUShort());t.instructionLength=n.parseUShort(),t.instructions=[];for(var f=0;f<t.instructionLength;f+=1)t.instructions.push(n.parseByte());var p=u[u.length-1]+1;o=[];for(var d=0;d<p;d+=1)if(i=n.parseByte(),o.push(i),(i&8)>0)for(var y=n.parseByte(),m=0;m<y;m+=1)o.push(i),d+=1;if(Q.argument(o.length===p,"Bad flags."),u.length>0){var S=[],T;if(p>0){for(var x=0;x<p;x+=1)i=o[x],T={},T.onCurve=!!(i&1),T.lastPointOfContour=u.indexOf(x)>=0,S.push(T);for(var C=0,A=0;A<p;A+=1)i=o[A],T=S[A],T.x=Rs(n,i,C,2,16),C=T.x;for(var B=0,F=0;F<p;F+=1)i=o[F],T=S[F],T.y=Rs(n,i,B,4,32),B=T.y}t.points=S}else t.points=[]}else if(t.numberOfContours===0)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];for(var q=!0;q;){o=n.parseUShort();var z={glyphIndex:n.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(o&1)>0?(o&2)>0?(z.dx=n.parseShort(),z.dy=n.parseShort()):z.matchedPoints=[n.parseUShort(),n.parseUShort()]:(o&2)>0?(z.dx=n.parseChar(),z.dy=n.parseChar()):z.matchedPoints=[n.parseByte(),n.parseByte()],(o&8)>0?z.xScale=z.yScale=n.parseF2Dot14():(o&64)>0?(z.xScale=n.parseF2Dot14(),z.yScale=n.parseF2Dot14()):(o&128)>0&&(z.xScale=n.parseF2Dot14(),z.scale01=n.parseF2Dot14(),z.scale10=n.parseF2Dot14(),z.yScale=n.parseF2Dot14()),t.components.push(z),q=!!(o&32)}if(o&256){t.instructionLength=n.parseUShort(),t.instructions=[];for(var ie=0;ie<t.instructionLength;ie+=1)t.instructions.push(n.parseByte())}}}function Li(t,e){for(var r=[],n=0;n<t.length;n+=1){var o=t[n],i={x:e.xScale*o.x+e.scale01*o.y+e.dx,y:e.scale10*o.x+e.yScale*o.y+e.dy,onCurve:o.onCurve,lastPointOfContour:o.lastPointOfContour};r.push(i)}return r}function Ad(t){for(var e=[],r=[],n=0;n<t.length;n+=1){var o=t[n];r.push(o),o.lastPointOfContour&&(e.push(r),r=[])}return Q.argument(r.length===0,"There are still points left in the current contour."),e}function Zu(t){var e=new $e;if(!t)return e;for(var r=Ad(t),n=0;n<r.length;++n){var o=r[n],i=null,u=o[o.length-1],l=o[0];if(u.onCurve)e.moveTo(u.x,u.y);else if(l.onCurve)e.moveTo(l.x,l.y);else{var f={x:(u.x+l.x)*.5,y:(u.y+l.y)*.5};e.moveTo(f.x,f.y)}for(var p=0;p<o.length;++p)if(i=u,u=l,l=o[(p+1)%o.length],u.onCurve)e.lineTo(u.x,u.y);else{var d=l;i.onCurve||((u.x+i.x)*.5,(u.y+i.y)*.5),l.onCurve||(d={x:(u.x+l.x)*.5,y:(u.y+l.y)*.5}),e.quadraticCurveTo(u.x,u.y,d.x,d.y)}e.closePath()}return e}function qu(t,e){if(e.isComposite)for(var r=0;r<e.components.length;r+=1){var n=e.components[r],o=t.get(n.glyphIndex);if(o.getPath(),o.points){var i=void 0;if(n.matchedPoints===void 0)i=Li(o.points,n);else{if(n.matchedPoints[0]>e.points.length-1||n.matchedPoints[1]>o.points.length-1)throw Error("Matched points out of range in "+e.name);var u=e.points[n.matchedPoints[0]],l=o.points[n.matchedPoints[1]],f={xScale:n.xScale,scale01:n.scale01,scale10:n.scale10,yScale:n.yScale,dx:0,dy:0};l=Li([l],f)[0],f.dx=u.x-l.x,f.dy=u.y-l.y,i=Li(o.points,f)}e.points=e.points.concat(i)}}return Zu(e.points)}function Od(t,e,r,n){for(var o=new Rt.GlyphSet(n),i=0;i<r.length-1;i+=1){var u=r[i],l=r[i+1];u!==l?o.push(i,Rt.ttfGlyphLoader(n,i,Yu,t,e+u,qu)):o.push(i,Rt.glyphLoader(n,i))}return o}function Rd(t,e,r,n){var o=new Rt.GlyphSet(n);return n._push=function(i){var u=r[i],l=r[i+1];u!==l?o.push(i,Rt.ttfGlyphLoader(n,i,Yu,t,e+u,qu)):o.push(i,Rt.glyphLoader(n,i))},o}function Dd(t,e,r,n,o){return o.lowMemory?Rd(t,e,r,n):Od(t,e,r,n)}var Md={getPath:Zu,parse:Dd},ju,_r,Ku,na;function Qu(t){this.font=t,this.getCommands=function(e){return Md.getPath(e).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Fd(t){return t}function Ju(t){return Math.sign(t)*Math.round(Math.abs(t))}function Bd(t){return Math.sign(t)*Math.round(Math.abs(t*2))/2}function Ld(t){return Math.sign(t)*(Math.round(Math.abs(t)+.5)-.5)}function Ud(t){return Math.sign(t)*Math.ceil(Math.abs(t))}function Id(t){return Math.sign(t)*Math.floor(Math.abs(t))}var el=function(t){var e=this.srPeriod,r=this.srPhase,n=this.srThreshold,o=1;return t<0&&(t=-t,o=-1),t+=n-r,t=Math.trunc(t/e)*e,t+=r,t<0?r*o:t*o},Ot={x:1,y:0,axis:"x",distance:function(t,e,r,n){return(r?t.xo:t.x)-(n?e.xo:e.x)},interpolate:function(t,e,r,n){var o,i,u,l,f,p,d;if(!n||n===this){if(o=t.xo-e.xo,i=t.xo-r.xo,f=e.x-e.xo,p=r.x-r.xo,u=Math.abs(o),l=Math.abs(i),d=u+l,d===0){t.x=t.xo+(f+p)/2;return}t.x=t.xo+(f*l+p*u)/d;return}if(o=n.distance(t,e,!0,!0),i=n.distance(t,r,!0,!0),f=n.distance(e,e,!1,!0),p=n.distance(r,r,!1,!0),u=Math.abs(o),l=Math.abs(i),d=u+l,d===0){Ot.setRelative(t,t,(f+p)/2,n,!0);return}Ot.setRelative(t,t,(f*l+p*u)/d,n,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(t,e,r,n,o){if(!n||n===this){t.x=(o?e.xo:e.x)+r;return}var i=o?e.xo:e.x,u=o?e.yo:e.y,l=i+r*n.x,f=u+r*n.y;t.x=l+(t.y-f)/n.normalSlope},slope:0,touch:function(t){t.xTouched=!0},touched:function(t){return t.xTouched},untouch:function(t){t.xTouched=!1}},Vt={x:0,y:1,axis:"y",distance:function(t,e,r,n){return(r?t.yo:t.y)-(n?e.yo:e.y)},interpolate:function(t,e,r,n){var o,i,u,l,f,p,d;if(!n||n===this){if(o=t.yo-e.yo,i=t.yo-r.yo,f=e.y-e.yo,p=r.y-r.yo,u=Math.abs(o),l=Math.abs(i),d=u+l,d===0){t.y=t.yo+(f+p)/2;return}t.y=t.yo+(f*l+p*u)/d;return}if(o=n.distance(t,e,!0,!0),i=n.distance(t,r,!0,!0),f=n.distance(e,e,!1,!0),p=n.distance(r,r,!1,!0),u=Math.abs(o),l=Math.abs(i),d=u+l,d===0){Vt.setRelative(t,t,(f+p)/2,n,!0);return}Vt.setRelative(t,t,(f*l+p*u)/d,n,!0)},normalSlope:0,setRelative:function(t,e,r,n,o){if(!n||n===this){t.y=(o?e.yo:e.y)+r;return}var i=o?e.xo:e.x,u=o?e.yo:e.y,l=i+r*n.x,f=u+r*n.y;t.y=f+n.normalSlope*(t.x-l)},slope:Number.POSITIVE_INFINITY,touch:function(t){t.yTouched=!0},touched:function(t){return t.yTouched},untouch:function(t){t.yTouched=!1}};Object.freeze(Ot);Object.freeze(Vt);function kn(t,e){this.x=t,this.y=e,this.axis=void 0,this.slope=e/t,this.normalSlope=-t/e,Object.freeze(this)}kn.prototype.distance=function(t,e,r,n){return this.x*Ot.distance(t,e,r,n)+this.y*Vt.distance(t,e,r,n)};kn.prototype.interpolate=function(t,e,r,n){var o,i,u,l,f,p,d;if(u=n.distance(t,e,!0,!0),l=n.distance(t,r,!0,!0),o=n.distance(e,e,!1,!0),i=n.distance(r,r,!1,!0),f=Math.abs(u),p=Math.abs(l),d=f+p,d===0){this.setRelative(t,t,(o+i)/2,n,!0);return}this.setRelative(t,t,(o*p+i*f)/d,n,!0)};kn.prototype.setRelative=function(t,e,r,n,o){n=n||this;var i=o?e.xo:e.x,u=o?e.yo:e.y,l=i+r*n.x,f=u+r*n.y,p=n.normalSlope,d=this.slope,y=t.x,m=t.y;t.x=(d*y-p*l+f-m)/(d-p),t.y=d*(t.x-y)+m};kn.prototype.touch=function(t){t.xTouched=!0,t.yTouched=!0};function An(t,e){var r=Math.sqrt(t*t+e*e);return t/=r,e/=r,t===1&&e===0?Ot:t===0&&e===1?Vt:new kn(t,e)}function zt(t,e,r,n){this.x=this.xo=Math.round(t*64)/64,this.y=this.yo=Math.round(e*64)/64,this.lastPointOfContour=r,this.onCurve=n,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}zt.prototype.nextTouched=function(t){for(var e=this.nextPointOnContour;!t.touched(e)&&e!==this;)e=e.nextPointOnContour;return e};zt.prototype.prevTouched=function(t){for(var e=this.prevPointOnContour;!t.touched(e)&&e!==this;)e=e.prevPointOnContour;return e};var wn=Object.freeze(new zt(0,0)),Gd={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function rr(t,e){switch(this.env=t,this.stack=[],this.prog=e,t){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Ot,this.round=Ju}}Qu.prototype.exec=function(t,e){if(typeof e!="number")throw new Error("Point size is not a number!");if(!(this._errorState>2)){var r=this.font,n=this._prepState;if(!n||n.ppem!==e){var o=this._fpgmState;if(!o){rr.prototype=Gd,o=this._fpgmState=new rr("fpgm",r.tables.fpgm),o.funcs=[],o.font=r,O.DEBUG&&(console.log("---EXEC FPGM---"),o.step=-1);try{_r(o)}catch(p){console.log("Hinting error in FPGM:"+p),this._errorState=3;return}}rr.prototype=o,n=this._prepState=new rr("prep",r.tables.prep),n.ppem=e;var i=r.tables.cvt;if(i)for(var u=n.cvt=new Array(i.length),l=e/r.unitsPerEm,f=0;f<i.length;f++)u[f]=i[f]*l;else n.cvt=[];O.DEBUG&&(console.log("---EXEC PREP---"),n.step=-1);try{_r(n)}catch(p){this._errorState<2&&console.log("Hinting error in PREP:"+p),this._errorState=2}}if(!(this._errorState>1))try{return Ku(t,n)}catch(p){this._errorState<1&&(console.log("Hinting error:"+p),console.log("Note: further hinting errors are silenced")),this._errorState=1;return}}};Ku=function(t,e){var r=e.ppem/e.font.unitsPerEm,n=r,o=t.components,i,u,l;if(rr.prototype=e,!o)l=new rr("glyf",t.instructions),O.DEBUG&&(console.log("---EXEC GLYPH---"),l.step=-1),na(t,l,r,n),u=l.gZone;else{var f=e.font;u=[],i=[];for(var p=0;p<o.length;p++){var d=o[p],y=f.glyphs.get(d.glyphIndex);l=new rr("glyf",y.instructions),O.DEBUG&&(console.log("---EXEC COMP "+p+"---"),l.step=-1),na(y,l,r,n);for(var m=Math.round(d.dx*r),S=Math.round(d.dy*n),T=l.gZone,x=l.contours,C=0;C<T.length;C++){var A=T[C];A.xTouched=A.yTouched=!1,A.xo=A.x=A.x+m,A.yo=A.y=A.y+S}var B=u.length;u.push.apply(u,T);for(var F=0;F<x.length;F++)i.push(x[F]+B)}t.instructions&&!l.inhibitGridFit&&(l=new rr("glyf",t.instructions),l.gZone=l.z0=l.z1=l.z2=u,l.contours=i,u.push(new zt(0,0),new zt(Math.round(t.advanceWidth*r),0)),O.DEBUG&&(console.log("---EXEC COMPOSITE---"),l.step=-1),_r(l),u.length-=2)}return u};na=function(t,e,r,n){for(var o=t.points||[],i=o.length,u=e.gZone=e.z0=e.z1=e.z2=[],l=e.contours=[],f,p=0;p<i;p++)f=o[p],u[p]=new zt(f.x*r,f.y*n,f.lastPointOfContour,f.onCurve);for(var d,y,m=0;m<i;m++)f=u[m],d||(d=f,l.push(m)),f.lastPointOfContour?(f.nextPointOnContour=d,d.prevPointOnContour=f,d=void 0):(y=u[m+1],f.nextPointOnContour=y,y.prevPointOnContour=f);if(!e.inhibitGridFit){if(O.DEBUG){console.log("PROCESSING GLYPH",e.stack);for(var S=0;S<i;S++)console.log(S,u[S].x,u[S].y)}if(u.push(new zt(0,0),new zt(Math.round(t.advanceWidth*r),0)),_r(e),u.length-=2,O.DEBUG){console.log("FINISHED GLYPH",e.stack);for(var T=0;T<i;T++)console.log(T,u[T].x,u[T].y)}}};_r=function(t){var e=t.prog;if(e){var r=e.length,n;for(t.ip=0;t.ip<r;t.ip++){if(O.DEBUG&&t.step++,n=ju[e[t.ip]],!n)throw new Error("unknown instruction: 0x"+Number(e[t.ip]).toString(16));n(t)}}};function jo(t){for(var e=t.tZone=new Array(t.gZone.length),r=0;r<e.length;r++)e[r]=new zt(0,0)}function tl(t,e){var r=t.prog,n=t.ip,o=1,i;do if(i=r[++n],i===88)o++;else if(i===89)o--;else if(i===64)n+=r[n+1]+1;else if(i===65)n+=2*r[n+1]+1;else if(i>=176&&i<=183)n+=i-176+1;else if(i>=184&&i<=191)n+=(i-184+1)*2;else if(e&&o===1&&i===27)break;while(o>0);t.ip=n}function Ds(t,e){O.DEBUG&&console.log(e.step,"SVTCA["+t.axis+"]"),e.fv=e.pv=e.dpv=t}function Ms(t,e){O.DEBUG&&console.log(e.step,"SPVTCA["+t.axis+"]"),e.pv=e.dpv=t}function Fs(t,e){O.DEBUG&&console.log(e.step,"SFVTCA["+t.axis+"]"),e.fv=t}function Bs(t,e){var r=e.stack,n=r.pop(),o=r.pop(),i=e.z2[n],u=e.z1[o];O.DEBUG&&console.log("SPVTL["+t+"]",n,o);var l,f;t?(l=i.y-u.y,f=u.x-i.x):(l=u.x-i.x,f=u.y-i.y),e.pv=e.dpv=An(l,f)}function Ls(t,e){var r=e.stack,n=r.pop(),o=r.pop(),i=e.z2[n],u=e.z1[o];O.DEBUG&&console.log("SFVTL["+t+"]",n,o);var l,f;t?(l=i.y-u.y,f=u.x-i.x):(l=u.x-i.x,f=u.y-i.y),e.fv=An(l,f)}function Nd(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"SPVFS[]",r,n),t.pv=t.dpv=An(n,r)}function Hd(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"SPVFS[]",r,n),t.fv=An(n,r)}function Vd(t){var e=t.stack,r=t.pv;O.DEBUG&&console.log(t.step,"GPV[]"),e.push(r.x*16384),e.push(r.y*16384)}function zd(t){var e=t.stack,r=t.fv;O.DEBUG&&console.log(t.step,"GFV[]"),e.push(r.x*16384),e.push(r.y*16384)}function Wd(t){t.fv=t.pv,O.DEBUG&&console.log(t.step,"SFVTPV[]")}function Xd(t){var e=t.stack,r=e.pop(),n=e.pop(),o=e.pop(),i=e.pop(),u=e.pop(),l=t.z0,f=t.z1,p=l[r],d=l[n],y=f[o],m=f[i],S=t.z2[u];O.DEBUG&&console.log("ISECT[], ",r,n,o,i,u);var T=p.x,x=p.y,C=d.x,A=d.y,B=y.x,F=y.y,q=m.x,z=m.y,ie=(T-C)*(F-z)-(x-A)*(B-q),re=T*A-x*C,ee=B*z-F*q;S.x=(re*(B-q)-ee*(T-C))/ie,S.y=(re*(F-z)-ee*(x-A))/ie}function $d(t){t.rp0=t.stack.pop(),O.DEBUG&&console.log(t.step,"SRP0[]",t.rp0)}function Yd(t){t.rp1=t.stack.pop(),O.DEBUG&&console.log(t.step,"SRP1[]",t.rp1)}function Zd(t){t.rp2=t.stack.pop(),O.DEBUG&&console.log(t.step,"SRP2[]",t.rp2)}function qd(t){var e=t.stack.pop();switch(O.DEBUG&&console.log(t.step,"SZP0[]",e),t.zp0=e,e){case 0:t.tZone||jo(t),t.z0=t.tZone;break;case 1:t.z0=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function jd(t){var e=t.stack.pop();switch(O.DEBUG&&console.log(t.step,"SZP1[]",e),t.zp1=e,e){case 0:t.tZone||jo(t),t.z1=t.tZone;break;case 1:t.z1=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function Kd(t){var e=t.stack.pop();switch(O.DEBUG&&console.log(t.step,"SZP2[]",e),t.zp2=e,e){case 0:t.tZone||jo(t),t.z2=t.tZone;break;case 1:t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function Qd(t){var e=t.stack.pop();switch(O.DEBUG&&console.log(t.step,"SZPS[]",e),t.zp0=t.zp1=t.zp2=e,e){case 0:t.tZone||jo(t),t.z0=t.z1=t.z2=t.tZone;break;case 1:t.z0=t.z1=t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function Jd(t){t.loop=t.stack.pop(),O.DEBUG&&console.log(t.step,"SLOOP[]",t.loop)}function ev(t){O.DEBUG&&console.log(t.step,"RTG[]"),t.round=Ju}function tv(t){O.DEBUG&&console.log(t.step,"RTHG[]"),t.round=Ld}function rv(t){var e=t.stack.pop();O.DEBUG&&console.log(t.step,"SMD[]",e),t.minDis=e/64}function nv(t){O.DEBUG&&console.log(t.step,"ELSE[]"),tl(t,!1)}function ov(t){var e=t.stack.pop();O.DEBUG&&console.log(t.step,"JMPR[]",e),t.ip+=e-1}function iv(t){var e=t.stack.pop();O.DEBUG&&console.log(t.step,"SCVTCI[]",e),t.cvCutIn=e/64}function av(t){var e=t.stack;O.DEBUG&&console.log(t.step,"DUP[]"),e.push(e[e.length-1])}function Ui(t){O.DEBUG&&console.log(t.step,"POP[]"),t.stack.pop()}function sv(t){O.DEBUG&&console.log(t.step,"CLEAR[]"),t.stack.length=0}function uv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"SWAP[]"),e.push(r),e.push(n)}function lv(t){var e=t.stack;O.DEBUG&&console.log(t.step,"DEPTH[]"),e.push(e.length)}function cv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"LOOPCALL[]",r,n);var o=t.ip,i=t.prog;t.prog=t.funcs[r];for(var u=0;u<n;u++)_r(t),O.DEBUG&&console.log(++t.step,u+1<n?"next loopcall":"done loopcall",u);t.ip=o,t.prog=i}function fv(t){var e=t.stack.pop();O.DEBUG&&console.log(t.step,"CALL[]",e);var r=t.ip,n=t.prog;t.prog=t.funcs[e],_r(t),t.ip=r,t.prog=n,O.DEBUG&&console.log(++t.step,"returning from",e)}function hv(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"CINDEX[]",r),e.push(e[e.length-r])}function pv(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"MINDEX[]",r),e.push(e.splice(e.length-r,1)[0])}function dv(t){if(t.env!=="fpgm")throw new Error("FDEF not allowed here");var e=t.stack,r=t.prog,n=t.ip,o=e.pop(),i=n;for(O.DEBUG&&console.log(t.step,"FDEF[]",o);r[++n]!==45;);t.ip=n,t.funcs[o]=r.slice(i+1,n)}function Us(t,e){var r=e.stack.pop(),n=e.z0[r],o=e.fv,i=e.pv;O.DEBUG&&console.log(e.step,"MDAP["+t+"]",r);var u=i.distance(n,wn);t&&(u=e.round(u)),o.setRelative(n,wn,u,i),o.touch(n),e.rp0=e.rp1=r}function Is(t,e){var r=e.z2,n=r.length-2,o,i,u;O.DEBUG&&console.log(e.step,"IUP["+t.axis+"]");for(var l=0;l<n;l++)o=r[l],!t.touched(o)&&(i=o.prevTouched(t),i!==o&&(u=o.nextTouched(t),i===u&&t.setRelative(o,o,t.distance(i,i,!1,!0),t,!0),t.interpolate(o,i,u,t)))}function Gs(t,e){for(var r=e.stack,n=t?e.rp1:e.rp2,o=(t?e.z0:e.z1)[n],i=e.fv,u=e.pv,l=e.loop,f=e.z2;l--;){var p=r.pop(),d=f[p],y=u.distance(o,o,!1,!0);i.setRelative(d,d,y,u),i.touch(d),O.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-l)+": ":"")+"SHP["+(t?"rp1":"rp2")+"]",p)}e.loop=1}function Ns(t,e){var r=e.stack,n=t?e.rp1:e.rp2,o=(t?e.z0:e.z1)[n],i=e.fv,u=e.pv,l=r.pop(),f=e.z2[e.contours[l]],p=f;O.DEBUG&&console.log(e.step,"SHC["+t+"]",l);var d=u.distance(o,o,!1,!0);do p!==o&&i.setRelative(p,p,d,u),p=p.nextPointOnContour;while(p!==f)}function Hs(t,e){var r=e.stack,n=t?e.rp1:e.rp2,o=(t?e.z0:e.z1)[n],i=e.fv,u=e.pv,l=r.pop();O.DEBUG&&console.log(e.step,"SHZ["+t+"]",l);var f;switch(l){case 0:f=e.tZone;break;case 1:f=e.gZone;break;default:throw new Error("Invalid zone")}for(var p,d=u.distance(o,o,!1,!0),y=f.length-2,m=0;m<y;m++)p=f[m],i.setRelative(p,p,d,u)}function vv(t){for(var e=t.stack,r=t.loop,n=t.fv,o=e.pop()/64,i=t.z2;r--;){var u=e.pop(),l=i[u];O.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-r)+": ":"")+"SHPIX[]",u,o),n.setRelative(l,l,o),n.touch(l)}t.loop=1}function gv(t){for(var e=t.stack,r=t.rp1,n=t.rp2,o=t.loop,i=t.z0[r],u=t.z1[n],l=t.fv,f=t.dpv,p=t.z2;o--;){var d=e.pop(),y=p[d];O.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-o)+": ":"")+"IP[]",d,r,"<->",n),l.interpolate(y,i,u,f),l.touch(y)}t.loop=1}function Vs(t,e){var r=e.stack,n=r.pop()/64,o=r.pop(),i=e.z1[o],u=e.z0[e.rp0],l=e.fv,f=e.pv;l.setRelative(i,u,n,f),l.touch(i),O.DEBUG&&console.log(e.step,"MSIRP["+t+"]",n,o),e.rp1=e.rp0,e.rp2=o,t&&(e.rp0=o)}function mv(t){for(var e=t.stack,r=t.rp0,n=t.z0[r],o=t.loop,i=t.fv,u=t.pv,l=t.z1;o--;){var f=e.pop(),p=l[f];O.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-o)+": ":"")+"ALIGNRP[]",f),i.setRelative(p,n,0,u),i.touch(p)}t.loop=1}function yv(t){O.DEBUG&&console.log(t.step,"RTDG[]"),t.round=Bd}function zs(t,e){var r=e.stack,n=r.pop(),o=r.pop(),i=e.z0[o],u=e.fv,l=e.pv,f=e.cvt[n];O.DEBUG&&console.log(e.step,"MIAP["+t+"]",n,"(",f,")",o);var p=l.distance(i,wn);t&&(Math.abs(p-f)<e.cvCutIn&&(p=f),p=e.round(p)),u.setRelative(i,wn,p,l),e.zp0===0&&(i.xo=i.x,i.yo=i.y),u.touch(i),e.rp0=e.rp1=o}function wv(t){var e=t.prog,r=t.ip,n=t.stack,o=e[++r];O.DEBUG&&console.log(t.step,"NPUSHB[]",o);for(var i=0;i<o;i++)n.push(e[++r]);t.ip=r}function _v(t){var e=t.ip,r=t.prog,n=t.stack,o=r[++e];O.DEBUG&&console.log(t.step,"NPUSHW[]",o);for(var i=0;i<o;i++){var u=r[++e]<<8|r[++e];u&32768&&(u=-((u^65535)+1)),n.push(u)}t.ip=e}function bv(t){var e=t.stack,r=t.store;r||(r=t.store=[]);var n=e.pop(),o=e.pop();O.DEBUG&&console.log(t.step,"WS",n,o),r[o]=n}function Sv(t){var e=t.stack,r=t.store,n=e.pop();O.DEBUG&&console.log(t.step,"RS",n);var o=r&&r[n]||0;e.push(o)}function Tv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"WCVTP",r,n),t.cvt[n]=r/64}function Ev(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"RCVT",r),e.push(t.cvt[r]*64)}function Ws(t,e){var r=e.stack,n=r.pop(),o=e.z2[n];O.DEBUG&&console.log(e.step,"GC["+t+"]",n),r.push(e.dpv.distance(o,wn,t,!1)*64)}function Xs(t,e){var r=e.stack,n=r.pop(),o=r.pop(),i=e.z1[n],u=e.z0[o],l=e.dpv.distance(u,i,t,t);O.DEBUG&&console.log(e.step,"MD["+t+"]",n,o,"->",l),e.stack.push(Math.round(l*64))}function xv(t){O.DEBUG&&console.log(t.step,"MPPEM[]"),t.stack.push(t.ppem)}function Cv(t){O.DEBUG&&console.log(t.step,"FLIPON[]"),t.autoFlip=!0}function Pv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"LT[]",r,n),e.push(n<r?1:0)}function kv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"LTEQ[]",r,n),e.push(n<=r?1:0)}function Av(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"GT[]",r,n),e.push(n>r?1:0)}function Ov(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"GTEQ[]",r,n),e.push(n>=r?1:0)}function Rv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"EQ[]",r,n),e.push(r===n?1:0)}function Dv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"NEQ[]",r,n),e.push(r!==n?1:0)}function Mv(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"ODD[]",r),e.push(Math.trunc(r)%2?1:0)}function Fv(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"EVEN[]",r),e.push(Math.trunc(r)%2?0:1)}function Bv(t){var e=t.stack.pop();O.DEBUG&&console.log(t.step,"IF[]",e),e||(tl(t,!0),O.DEBUG&&console.log(t.step,"EIF[]"))}function Lv(t){O.DEBUG&&console.log(t.step,"EIF[]")}function Uv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"AND[]",r,n),e.push(r&&n?1:0)}function Iv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"OR[]",r,n),e.push(r||n?1:0)}function Gv(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"NOT[]",r),e.push(r?0:1)}function Ii(t,e){var r=e.stack,n=r.pop(),o=e.fv,i=e.pv,u=e.ppem,l=e.deltaBase+(t-1)*16,f=e.deltaShift,p=e.z0;O.DEBUG&&console.log(e.step,"DELTAP["+t+"]",n,r);for(var d=0;d<n;d++){var y=r.pop(),m=r.pop(),S=l+((m&240)>>4);if(S===u){var T=(m&15)-8;T>=0&&T++,O.DEBUG&&console.log(e.step,"DELTAPFIX",y,"by",T*f);var x=p[y];o.setRelative(x,x,T*f,i)}}}function Nv(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"SDB[]",r),t.deltaBase=r}function Hv(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"SDS[]",r),t.deltaShift=Math.pow(.5,r)}function Vv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"ADD[]",r,n),e.push(n+r)}function zv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"SUB[]",r,n),e.push(n-r)}function Wv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"DIV[]",r,n),e.push(n*64/r)}function Xv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"MUL[]",r,n),e.push(n*r/64)}function $v(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"ABS[]",r),e.push(Math.abs(r))}function Yv(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"NEG[]",r),e.push(-r)}function Zv(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"FLOOR[]",r),e.push(Math.floor(r/64)*64)}function qv(t){var e=t.stack,r=e.pop();O.DEBUG&&console.log(t.step,"CEILING[]",r),e.push(Math.ceil(r/64)*64)}function go(t,e){var r=e.stack,n=r.pop();O.DEBUG&&console.log(e.step,"ROUND[]"),r.push(e.round(n/64)*64)}function jv(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"WCVTF[]",r,n),t.cvt[n]=r*t.ppem/t.font.unitsPerEm}function Gi(t,e){var r=e.stack,n=r.pop(),o=e.ppem,i=e.deltaBase+(t-1)*16,u=e.deltaShift;O.DEBUG&&console.log(e.step,"DELTAC["+t+"]",n,r);for(var l=0;l<n;l++){var f=r.pop(),p=r.pop(),d=i+((p&240)>>4);if(d===o){var y=(p&15)-8;y>=0&&y++;var m=y*u;O.DEBUG&&console.log(e.step,"DELTACFIX",f,"by",m),e.cvt[f]+=m}}}function Kv(t){var e=t.stack.pop();O.DEBUG&&console.log(t.step,"SROUND[]",e),t.round=el;var r;switch(e&192){case 0:r=.5;break;case 64:r=1;break;case 128:r=2;break;default:throw new Error("invalid SROUND value")}switch(t.srPeriod=r,e&48){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*r;break;case 32:t.srPhase=.5*r;break;case 48:t.srPhase=.75*r;break;default:throw new Error("invalid SROUND value")}e&=15,e===0?t.srThreshold=0:t.srThreshold=(e/8-.5)*r}function Qv(t){var e=t.stack.pop();O.DEBUG&&console.log(t.step,"S45ROUND[]",e),t.round=el;var r;switch(e&192){case 0:r=Math.sqrt(2)/2;break;case 64:r=Math.sqrt(2);break;case 128:r=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(t.srPeriod=r,e&48){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*r;break;case 32:t.srPhase=.5*r;break;case 48:t.srPhase=.75*r;break;default:throw new Error("invalid S45ROUND value")}e&=15,e===0?t.srThreshold=0:t.srThreshold=(e/8-.5)*r}function Jv(t){O.DEBUG&&console.log(t.step,"ROFF[]"),t.round=Fd}function eg(t){O.DEBUG&&console.log(t.step,"RUTG[]"),t.round=Ud}function tg(t){O.DEBUG&&console.log(t.step,"RDTG[]"),t.round=Id}function rg(t){var e=t.stack.pop();O.DEBUG&&console.log(t.step,"SCANCTRL[]",e)}function $s(t,e){var r=e.stack,n=r.pop(),o=r.pop(),i=e.z2[n],u=e.z1[o];O.DEBUG&&console.log(e.step,"SDPVTL["+t+"]",n,o);var l,f;t?(l=i.y-u.y,f=u.x-i.x):(l=u.x-i.x,f=u.y-i.y),e.dpv=An(l,f)}function ng(t){var e=t.stack,r=e.pop(),n=0;O.DEBUG&&console.log(t.step,"GETINFO[]",r),r&1&&(n=35),r&32&&(n|=4096),e.push(n)}function og(t){var e=t.stack,r=e.pop(),n=e.pop(),o=e.pop();O.DEBUG&&console.log(t.step,"ROLL[]"),e.push(n),e.push(r),e.push(o)}function ig(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"MAX[]",r,n),e.push(Math.max(n,r))}function ag(t){var e=t.stack,r=e.pop(),n=e.pop();O.DEBUG&&console.log(t.step,"MIN[]",r,n),e.push(Math.min(n,r))}function sg(t){var e=t.stack.pop();O.DEBUG&&console.log(t.step,"SCANTYPE[]",e)}function ug(t){var e=t.stack.pop(),r=t.stack.pop();switch(O.DEBUG&&console.log(t.step,"INSTCTRL[]",e,r),e){case 1:t.inhibitGridFit=!!r;return;case 2:t.ignoreCvt=!!r;return;default:throw new Error("invalid INSTCTRL[] selector")}}function Kt(t,e){var r=e.stack,n=e.prog,o=e.ip;O.DEBUG&&console.log(e.step,"PUSHB["+t+"]");for(var i=0;i<t;i++)r.push(n[++o]);e.ip=o}function Qt(t,e){var r=e.ip,n=e.prog,o=e.stack;O.DEBUG&&console.log(e.ip,"PUSHW["+t+"]");for(var i=0;i<t;i++){var u=n[++r]<<8|n[++r];u&32768&&(u=-((u^65535)+1)),o.push(u)}e.ip=r}function W(t,e,r,n,o,i){var u=i.stack,l=t&&u.pop(),f=u.pop(),p=i.rp0,d=i.z0[p],y=i.z1[f],m=i.minDis,S=i.fv,T=i.dpv,x,C,A,B;C=x=T.distance(y,d,!0,!0),A=C>=0?1:-1,C=Math.abs(C),t&&(B=i.cvt[l],n&&Math.abs(C-B)<i.cvCutIn&&(C=B)),r&&C<m&&(C=m),n&&(C=i.round(C)),S.setRelative(y,d,A*C,T),S.touch(y),O.DEBUG&&console.log(i.step,(t?"MIRP[":"MDRP[")+(e?"M":"m")+(r?">":"_")+(n?"R":"_")+(o===0?"Gr":o===1?"Bl":o===2?"Wh":"")+"]",t?l+"("+i.cvt[l]+","+B+")":"",f,"(d =",x,"->",A*C,")"),i.rp1=i.rp0,i.rp2=f,e&&(i.rp0=f)}ju=[Ds.bind(void 0,Vt),Ds.bind(void 0,Ot),Ms.bind(void 0,Vt),Ms.bind(void 0,Ot),Fs.bind(void 0,Vt),Fs.bind(void 0,Ot),Bs.bind(void 0,0),Bs.bind(void 0,1),Ls.bind(void 0,0),Ls.bind(void 0,1),Nd,Hd,Vd,zd,Wd,Xd,$d,Yd,Zd,qd,jd,Kd,Qd,Jd,ev,tv,rv,nv,ov,iv,void 0,void 0,av,Ui,sv,uv,lv,hv,pv,void 0,void 0,void 0,cv,fv,dv,void 0,Us.bind(void 0,0),Us.bind(void 0,1),Is.bind(void 0,Vt),Is.bind(void 0,Ot),Gs.bind(void 0,0),Gs.bind(void 0,1),Ns.bind(void 0,0),Ns.bind(void 0,1),Hs.bind(void 0,0),Hs.bind(void 0,1),vv,gv,Vs.bind(void 0,0),Vs.bind(void 0,1),mv,yv,zs.bind(void 0,0),zs.bind(void 0,1),wv,_v,bv,Sv,Tv,Ev,Ws.bind(void 0,0),Ws.bind(void 0,1),void 0,Xs.bind(void 0,0),Xs.bind(void 0,1),xv,void 0,Cv,void 0,void 0,Pv,kv,Av,Ov,Rv,Dv,Mv,Fv,Bv,Lv,Uv,Iv,Gv,Ii.bind(void 0,1),Nv,Hv,Vv,zv,Wv,Xv,$v,Yv,Zv,qv,go.bind(void 0,0),go.bind(void 0,1),go.bind(void 0,2),go.bind(void 0,3),void 0,void 0,void 0,void 0,jv,Ii.bind(void 0,2),Ii.bind(void 0,3),Gi.bind(void 0,1),Gi.bind(void 0,2),Gi.bind(void 0,3),Kv,Qv,void 0,void 0,Jv,void 0,eg,tg,Ui,Ui,void 0,void 0,void 0,void 0,void 0,rg,$s.bind(void 0,0),$s.bind(void 0,1),ng,void 0,og,ig,ag,sg,ug,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Kt.bind(void 0,1),Kt.bind(void 0,2),Kt.bind(void 0,3),Kt.bind(void 0,4),Kt.bind(void 0,5),Kt.bind(void 0,6),Kt.bind(void 0,7),Kt.bind(void 0,8),Qt.bind(void 0,1),Qt.bind(void 0,2),Qt.bind(void 0,3),Qt.bind(void 0,4),Qt.bind(void 0,5),Qt.bind(void 0,6),Qt.bind(void 0,7),Qt.bind(void 0,8),W.bind(void 0,0,0,0,0,0),W.bind(void 0,0,0,0,0,1),W.bind(void 0,0,0,0,0,2),W.bind(void 0,0,0,0,0,3),W.bind(void 0,0,0,0,1,0),W.bind(void 0,0,0,0,1,1),W.bind(void 0,0,0,0,1,2),W.bind(void 0,0,0,0,1,3),W.bind(void 0,0,0,1,0,0),W.bind(void 0,0,0,1,0,1),W.bind(void 0,0,0,1,0,2),W.bind(void 0,0,0,1,0,3),W.bind(void 0,0,0,1,1,0),W.bind(void 0,0,0,1,1,1),W.bind(void 0,0,0,1,1,2),W.bind(void 0,0,0,1,1,3),W.bind(void 0,0,1,0,0,0),W.bind(void 0,0,1,0,0,1),W.bind(void 0,0,1,0,0,2),W.bind(void 0,0,1,0,0,3),W.bind(void 0,0,1,0,1,0),W.bind(void 0,0,1,0,1,1),W.bind(void 0,0,1,0,1,2),W.bind(void 0,0,1,0,1,3),W.bind(void 0,0,1,1,0,0),W.bind(void 0,0,1,1,0,1),W.bind(void 0,0,1,1,0,2),W.bind(void 0,0,1,1,0,3),W.bind(void 0,0,1,1,1,0),W.bind(void 0,0,1,1,1,1),W.bind(void 0,0,1,1,1,2),W.bind(void 0,0,1,1,1,3),W.bind(void 0,1,0,0,0,0),W.bind(void 0,1,0,0,0,1),W.bind(void 0,1,0,0,0,2),W.bind(void 0,1,0,0,0,3),W.bind(void 0,1,0,0,1,0),W.bind(void 0,1,0,0,1,1),W.bind(void 0,1,0,0,1,2),W.bind(void 0,1,0,0,1,3),W.bind(void 0,1,0,1,0,0),W.bind(void 0,1,0,1,0,1),W.bind(void 0,1,0,1,0,2),W.bind(void 0,1,0,1,0,3),W.bind(void 0,1,0,1,1,0),W.bind(void 0,1,0,1,1,1),W.bind(void 0,1,0,1,1,2),W.bind(void 0,1,0,1,1,3),W.bind(void 0,1,1,0,0,0),W.bind(void 0,1,1,0,0,1),W.bind(void 0,1,1,0,0,2),W.bind(void 0,1,1,0,0,3),W.bind(void 0,1,1,0,1,0),W.bind(void 0,1,1,0,1,1),W.bind(void 0,1,1,0,1,2),W.bind(void 0,1,1,0,1,3),W.bind(void 0,1,1,1,0,0),W.bind(void 0,1,1,1,0,1),W.bind(void 0,1,1,1,0,2),W.bind(void 0,1,1,1,0,3),W.bind(void 0,1,1,1,1,0),W.bind(void 0,1,1,1,1,1),W.bind(void 0,1,1,1,1,2),W.bind(void 0,1,1,1,1,3)];function $r(t){this.char=t,this.state={},this.activeState=null}function wa(t,e,r){this.contextName=r,this.startIndex=t,this.endOffset=e}function lg(t,e,r){this.contextName=t,this.openRange=null,this.ranges=[],this.checkStart=e,this.checkEnd=r}function bt(t,e){this.context=t,this.index=e,this.length=t.length,this.current=t[e],this.backtrack=t.slice(0,e),this.lookahead=t.slice(e+1)}function Ko(t){this.eventId=t,this.subscribers=[]}function cg(t){var e=this,r=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];r.forEach(function(o){Object.defineProperty(e.events,o,{value:new Ko(o)})}),t&&r.forEach(function(o){var i=t[o];typeof i=="function"&&e.events[o].subscribe(i)});var n=["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"];n.forEach(function(o){e.events[o].subscribe(e.updateContextsRanges)})}function Ue(t){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],cg.call(this,t)}$r.prototype.setState=function(t,e){return this.state[t]=e,this.activeState={key:t,value:this.state[t]},this.activeState};$r.prototype.getState=function(t){return this.state[t]||null};Ue.prototype.inboundIndex=function(t){return t>=0&&t<this.tokens.length};Ue.prototype.composeRUD=function(t){var e=this,r=!0,n=t.map(function(i){return e[i[0]].apply(e,i.slice(1).concat(r))}),o=function(i){return typeof i=="object"&&i.hasOwnProperty("FAIL")};if(n.every(o))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:n.filter(o)};this.dispatch("composeRUD",[n.filter(function(i){return!o(i)})])};Ue.prototype.replaceRange=function(t,e,r,n){e=e!==null?e:this.tokens.length;var o=r.every(function(u){return u instanceof $r});if(!isNaN(t)&&this.inboundIndex(t)&&o){var i=this.tokens.splice.apply(this.tokens,[t,e].concat(r));return n||this.dispatch("replaceToken",[t,e,r]),[i,r]}else return{FAIL:"replaceRange: invalid tokens or startIndex."}};Ue.prototype.replaceToken=function(t,e,r){if(!isNaN(t)&&this.inboundIndex(t)&&e instanceof $r){var n=this.tokens.splice(t,1,e);return r||this.dispatch("replaceToken",[t,e]),[n[0],e]}else return{FAIL:"replaceToken: invalid token or index."}};Ue.prototype.removeRange=function(t,e,r){e=isNaN(e)?this.tokens.length:e;var n=this.tokens.splice(t,e);return r||this.dispatch("removeRange",[n,t,e]),n};Ue.prototype.removeToken=function(t,e){if(!isNaN(t)&&this.inboundIndex(t)){var r=this.tokens.splice(t,1);return e||this.dispatch("removeToken",[r,t]),r}else return{FAIL:"removeToken: invalid token index."}};Ue.prototype.insertToken=function(t,e,r){var n=t.every(function(o){return o instanceof $r});return n?(this.tokens.splice.apply(this.tokens,[e,0].concat(t)),r||this.dispatch("insertToken",[t,e]),t):{FAIL:"insertToken: invalid token(s)."}};Ue.prototype.registerModifier=function(t,e,r){this.events.newToken.subscribe(function(n,o){var i=[n,o],u=e===null||e.apply(this,i)===!0,l=[n,o];if(u){var f=r.apply(this,l);n.setState(t,f)}}),this.registeredModifiers.push(t)};Ko.prototype.subscribe=function(t){return typeof t=="function"?this.subscribers.push(t)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}};Ko.prototype.unsubscribe=function(t){this.subscribers.splice(t,1)};bt.prototype.setCurrentIndex=function(t){this.index=t,this.current=this.context[t],this.backtrack=this.context.slice(0,t),this.lookahead=this.context.slice(t+1)};bt.prototype.get=function(t){switch(!0){case t===0:return this.current;case(t<0&&Math.abs(t)<=this.backtrack.length):return this.backtrack.slice(t)[0];case(t>0&&t<=this.lookahead.length):return this.lookahead[t-1];default:return null}};Ue.prototype.rangeToText=function(t){if(t instanceof wa)return this.getRangeTokens(t).map(function(e){return e.char}).join("")};Ue.prototype.getText=function(){return this.tokens.map(function(t){return t.char}).join("")};Ue.prototype.getContext=function(t){var e=this.registeredContexts[t];return e||null};Ue.prototype.on=function(t,e){var r=this.events[t];return r?r.subscribe(e):null};Ue.prototype.dispatch=function(t,e){var r=this,n=this.events[t];n instanceof Ko&&n.subscribers.forEach(function(o){o.apply(r,e||[])})};Ue.prototype.registerContextChecker=function(t,e,r){if(this.getContext(t))return{FAIL:"context name '"+t+"' is already registered."};if(typeof e!="function")return{FAIL:"missing context start check."};if(typeof r!="function")return{FAIL:"missing context end check."};var n=new lg(t,e,r);return this.registeredContexts[t]=n,this.contextCheckers.push(n),n};Ue.prototype.getRangeTokens=function(t){var e=t.startIndex+t.endOffset;return[].concat(this.tokens.slice(t.startIndex,e))};Ue.prototype.getContextRanges=function(t){var e=this.getContext(t);return e?e.ranges:{FAIL:"context checker '"+t+"' is not registered."}};Ue.prototype.resetContextsRanges=function(){var t=this.registeredContexts;for(var e in t)if(t.hasOwnProperty(e)){var r=t[e];r.ranges=[]}};Ue.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var t=this.tokens.map(function(n){return n.char}),e=0;e<t.length;e++){var r=new bt(t,e);this.runContextCheck(r)}this.dispatch("updateContextsRanges",[this.registeredContexts])};Ue.prototype.setEndOffset=function(t,e){var r=this.getContext(e).openRange.startIndex,n=new wa(r,t,e),o=this.getContext(e).ranges;return n.rangeId=e+"."+o.length,o.push(n),this.getContext(e).openRange=null,n};Ue.prototype.runContextCheck=function(t){var e=this,r=t.index;this.contextCheckers.forEach(function(n){var o=n.contextName,i=e.getContext(o).openRange;if(!i&&n.checkStart(t)&&(i=new wa(r,null,o),e.getContext(o).openRange=i,e.dispatch("contextStart",[o,r])),i&&n.checkEnd(t)){var u=r-i.startIndex+1,l=e.setEndOffset(u,o);e.dispatch("contextEnd",[o,l])}})};Ue.prototype.tokenize=function(t){this.tokens=[],this.resetContextsRanges();var e=Array.from(t);this.dispatch("start");for(var r=0;r<e.length;r++){var n=e[r],o=new bt(e,r);this.dispatch("next",[o]),this.runContextCheck(o);var i=new $r(n);this.tokens.push(i),this.dispatch("newToken",[i,o])}return this.dispatch("end",[this.tokens]),this.tokens};function nr(t){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(t)}function rl(t){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(t)}function ir(t){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(t)}function To(t){return/[A-z]/.test(t)}function fg(t){return/\s/.test(t)}function st(t){this.font=t,this.features={}}function vr(t){this.id=t.id,this.tag=t.tag,this.substitution=t.substitution}function On(t,e){if(!t)return-1;switch(e.format){case 1:return e.glyphs.indexOf(t);case 2:for(var r=e.ranges,n=0;n<r.length;n++){var o=r[n];if(t>=o.start&&t<=o.end){var i=t-o.start;return o.index+i}}break;default:return-1}return-1}function hg(t,e){var r=On(t,e.coverage);return r===-1?null:t+e.deltaGlyphId}function pg(t,e){var r=On(t,e.coverage);return r===-1?null:e.substitute[r]}function Ni(t,e){for(var r=[],n=0;n<t.length;n++){var o=t[n],i=e.current;i=Array.isArray(i)?i[0]:i;var u=On(i,o);u!==-1&&r.push(u)}return r.length!==t.length?-1:r}function dg(t,e){var r=e.inputCoverage.length+e.lookaheadCoverage.length+e.backtrackCoverage.length;if(t.context.length<r)return[];var n=Ni(e.inputCoverage,t);if(n===-1)return[];var o=e.inputCoverage.length-1;if(t.lookahead.length<e.lookaheadCoverage.length)return[];for(var i=t.lookahead.slice(o);i.length&&ir(i[0].char);)i.shift();var u=new bt(i,0),l=Ni(e.lookaheadCoverage,u),f=[].concat(t.backtrack);for(f.reverse();f.length&&ir(f[0].char);)f.shift();if(f.length<e.backtrackCoverage.length)return[];var p=new bt(f,0),d=Ni(e.backtrackCoverage,p),y=n.length===e.inputCoverage.length&&l.length===e.lookaheadCoverage.length&&d.length===e.backtrackCoverage.length,m=[];if(y)for(var S=0;S<e.lookupRecords.length;S++)for(var T=e.lookupRecords[S],x=T.lookupListIndex,C=this.getLookupByIndex(x),A=0;A<C.subtables.length;A++){var B=C.subtables[A],F=this.getLookupMethod(C,B),q=this.getSubstitutionType(C,B);if(q==="12")for(var z=0;z<n.length;z++){var ie=t.get(z),re=F(ie);re&&m.push(re)}}return m}function vg(t,e){var r=t.current,n=On(r,e.coverage);if(n===-1)return null;for(var o,i=e.ligatureSets[n],u=0;u<i.length;u++){o=i[u];for(var l=0;l<o.components.length;l++){var f=t.lookahead[l],p=o.components[l];if(f!==p)break;if(l===o.components.length-1)return o}}return null}function gg(t,e){var r=On(t,e.coverage);return r===-1?null:e.sequences[r]}st.prototype.getDefaultScriptFeaturesIndexes=function(){for(var t=this.font.tables.gsub.scripts,e=0;e<t.length;e++){var r=t[e];if(r.tag==="DFLT")return r.script.defaultLangSys.featureIndexes}return[]};st.prototype.getScriptFeaturesIndexes=function(t){var e=this.font.tables;if(!e.gsub)return[];if(!t)return this.getDefaultScriptFeaturesIndexes();for(var r=this.font.tables.gsub.scripts,n=0;n<r.length;n++){var o=r[n];if(o.tag===t&&o.script.defaultLangSys)return o.script.defaultLangSys.featureIndexes;var i=o.langSysRecords;if(i)for(var u=0;u<i.length;u++){var l=i[u];if(l.tag===t){var f=l.langSys;return f.featureIndexes}}}return this.getDefaultScriptFeaturesIndexes()};st.prototype.mapTagsToFeatures=function(t,e){for(var r={},n=0;n<t.length;n++){var o=t[n].tag,i=t[n].feature;r[o]=i}this.features[e].tags=r};st.prototype.getScriptFeatures=function(t){var e=this.features[t];if(this.features.hasOwnProperty(t))return e;var r=this.getScriptFeaturesIndexes(t);if(!r)return null;var n=this.font.tables.gsub;return e=r.map(function(o){return n.features[o]}),this.features[t]=e,this.mapTagsToFeatures(e,t),e};st.prototype.getSubstitutionType=function(t,e){var r=t.lookupType.toString(),n=e.substFormat.toString();return r+n};st.prototype.getLookupMethod=function(t,e){var r=this,n=this.getSubstitutionType(t,e);switch(n){case"11":return function(o){return hg.apply(r,[o,e])};case"12":return function(o){return pg.apply(r,[o,e])};case"63":return function(o){return dg.apply(r,[o,e])};case"41":return function(o){return vg.apply(r,[o,e])};case"21":return function(o){return gg.apply(r,[o,e])};default:throw new Error("lookupType: "+t.lookupType+" - substFormat: "+e.substFormat+" is not yet supported")}};st.prototype.lookupFeature=function(t){var e=t.contextParams,r=e.index,n=this.getFeature({tag:t.tag,script:t.script});if(!n)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+t.tag+"' for script '"+t.script+"'.");for(var o=this.getFeatureLookups(n),i=[].concat(e.context),u=0;u<o.length;u++)for(var l=o[u],f=this.getLookupSubtables(l),p=0;p<f.length;p++){var d=f[p],y=this.getSubstitutionType(l,d),m=this.getLookupMethod(l,d),S=void 0;switch(y){case"11":S=m(e.current),S&&i.splice(r,1,new vr({id:11,tag:t.tag,substitution:S}));break;case"12":S=m(e.current),S&&i.splice(r,1,new vr({id:12,tag:t.tag,substitution:S}));break;case"63":S=m(e),Array.isArray(S)&&S.length&&i.splice(r,1,new vr({id:63,tag:t.tag,substitution:S}));break;case"41":S=m(e),S&&i.splice(r,1,new vr({id:41,tag:t.tag,substitution:S}));break;case"21":S=m(e.current),S&&i.splice(r,1,new vr({id:21,tag:t.tag,substitution:S}));break}e=new bt(i,r),!(Array.isArray(S)&&!S.length)&&(S=null)}return i.length?i:null};st.prototype.supports=function(t){if(!t.script)return!1;this.getScriptFeatures(t.script);var e=this.features.hasOwnProperty(t.script);if(!t.tag)return e;var r=this.features[t.script].some(function(n){return n.tag===t.tag});return e&&r};st.prototype.getLookupSubtables=function(t){return t.subtables||null};st.prototype.getLookupByIndex=function(t){var e=this.font.tables.gsub.lookups;return e[t]||null};st.prototype.getFeatureLookups=function(t){return t.lookupListIndexes.map(this.getLookupByIndex.bind(this))};st.prototype.getFeature=function(e){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(e.script)||this.getScriptFeatures(e.script);var r=this.features[e.script];return r?r.tags[e.tag]?this.features[e.script].tags[e.tag]:null:{FAIL:"No feature for script "+e.script}};function mg(t){var e=t.current,r=t.get(-1);return r===null&&nr(e)||!nr(r)&&nr(e)}function yg(t){var e=t.get(1);return e===null||!nr(e)}var wg={startCheck:mg,endCheck:yg};function _g(t){var e=t.current,r=t.get(-1);return(nr(e)||ir(e))&&!nr(r)}function bg(t){var e=t.get(1);switch(!0){case e===null:return!0;case(!nr(e)&&!ir(e)):var r=fg(e);if(!r)return!0;if(r){var n=!1;if(n=t.lookahead.some(function(o){return nr(o)||ir(o)}),!n)return!0}break;default:return!1}}var Sg={startCheck:_g,endCheck:bg};function Tg(t,e,r){e[r].setState(t.tag,t.substitution)}function Eg(t,e,r){e[r].setState(t.tag,t.substitution)}function xg(t,e,r){t.substitution.forEach(function(n,o){var i=e[r+o];i.setState(t.tag,n)})}function Cg(t,e,r){var n=e[r];n.setState(t.tag,t.substitution.ligGlyph);for(var o=t.substitution.components.length,i=0;i<o;i++)n=e[r+i+1],n.setState("deleted",!0)}var Ys={11:Tg,12:Eg,63:xg,41:Cg};function _a(t,e,r){t instanceof vr&&Ys[t.id]&&Ys[t.id](t,e,r)}function Pg(t){for(var e=[].concat(t.backtrack),r=e.length-1;r>=0;r--){var n=e[r],o=rl(n),i=ir(n);if(!o&&!i)return!0;if(o)return!1}return!1}function kg(t){if(rl(t.current))return!1;for(var e=0;e<t.lookahead.length;e++){var r=t.lookahead[e],n=ir(r);if(!n)return!0}return!1}function Ag(t){var e=this,r="arab",n=this.featuresTags[r],o=this.tokenizer.getRangeTokens(t);if(o.length!==1){var i=new bt(o.map(function(l){return l.getState("glyphIndex")}),0),u=new bt(o.map(function(l){return l.char}),0);o.forEach(function(l,f){if(!ir(l.char)){i.setCurrentIndex(f),u.setCurrentIndex(f);var p=0;Pg(u)&&(p|=1),kg(u)&&(p|=2);var d;switch(p){case 1:d="fina";break;case 2:d="init";break;case 3:d="medi";break}if(n.indexOf(d)!==-1){var y=e.query.lookupFeature({tag:d,script:r,contextParams:i});if(y instanceof Error)return console.info(y.message);y.forEach(function(m,S){m instanceof vr&&(_a(m,o,S),i.context[S]=m.substitution)})}}})}}function Zs(t,e){var r=t.map(function(n){return n.activeState.value});return new bt(r,e||0)}function Og(t){var e=this,r="arab",n=this.tokenizer.getRangeTokens(t),o=Zs(n);o.context.forEach(function(i,u){o.setCurrentIndex(u);var l=e.query.lookupFeature({tag:"rlig",script:r,contextParams:o});l.length&&(l.forEach(function(f){return _a(f,n,u)}),o=Zs(n))})}function Rg(t){var e=t.current,r=t.get(-1);return r===null&&To(e)||!To(r)&&To(e)}function Dg(t){var e=t.get(1);return e===null||!To(e)}var Mg={startCheck:Rg,endCheck:Dg};function qs(t,e){var r=t.map(function(n){return n.activeState.value});return new bt(r,e||0)}function Fg(t){var e=this,r="latn",n=this.tokenizer.getRangeTokens(t),o=qs(n);o.context.forEach(function(i,u){o.setCurrentIndex(u);var l=e.query.lookupFeature({tag:"liga",script:r,contextParams:o});l.length&&(l.forEach(function(f){return _a(f,n,u)}),o=qs(n))})}function Tt(t){this.baseDir=t||"ltr",this.tokenizer=new Ue,this.featuresTags={}}Tt.prototype.setText=function(t){this.text=t};Tt.prototype.contextChecks={latinWordCheck:Mg,arabicWordCheck:wg,arabicSentenceCheck:Sg};function Hi(t){var e=this.contextChecks[t+"Check"];return this.tokenizer.registerContextChecker(t,e.startCheck,e.endCheck)}function Bg(){return Hi.call(this,"latinWord"),Hi.call(this,"arabicWord"),Hi.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function Lg(){var t=this,e=this.tokenizer.getContextRanges("arabicSentence");e.forEach(function(r){var n=t.tokenizer.getRangeTokens(r);t.tokenizer.replaceRange(r.startIndex,r.endOffset,n.reverse())})}Tt.prototype.registerFeatures=function(t,e){var r=this,n=e.filter(function(o){return r.query.supports({script:t,tag:o})});this.featuresTags.hasOwnProperty(t)?this.featuresTags[t]=this.featuresTags[t].concat(n):this.featuresTags[t]=n};Tt.prototype.applyFeatures=function(t,e){if(!t)throw new Error("No valid font was provided to apply features");this.query||(this.query=new st(t));for(var r=0;r<e.length;r++){var n=e[r];this.query.supports({script:n.script})&&this.registerFeatures(n.script,n.tags)}};Tt.prototype.registerModifier=function(t,e,r){this.tokenizer.registerModifier(t,e,r)};function ba(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function Ug(){var t=this,e="arab";if(this.featuresTags.hasOwnProperty(e)){ba.call(this);var r=this.tokenizer.getContextRanges("arabicWord");r.forEach(function(n){Ag.call(t,n)})}}function Ig(){var t=this,e="arab";if(this.featuresTags.hasOwnProperty(e)){var r=this.featuresTags[e];if(r.indexOf("rlig")!==-1){ba.call(this);var n=this.tokenizer.getContextRanges("arabicWord");n.forEach(function(o){Og.call(t,o)})}}}function Gg(){var t=this,e="latn";if(this.featuresTags.hasOwnProperty(e)){var r=this.featuresTags[e];if(r.indexOf("liga")!==-1){ba.call(this);var n=this.tokenizer.getContextRanges("latinWord");n.forEach(function(o){Fg.call(t,o)})}}}Tt.prototype.checkContextReady=function(t){return!!this.tokenizer.getContext(t)};Tt.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(Ug.call(this),Ig.call(this)),this.checkContextReady("latinWord")&&Gg.call(this),this.checkContextReady("arabicSentence")&&Lg.call(this)};Tt.prototype.processText=function(t){(!this.text||this.text!==t)&&(this.setText(t),Bg.call(this),this.applyFeaturesToContexts())};Tt.prototype.getBidiText=function(t){return this.processText(t),this.tokenizer.getText()};Tt.prototype.getTextGlyphs=function(t){this.processText(t);for(var e=[],r=0;r<this.tokenizer.tokens.length;r++){var n=this.tokenizer.tokens[r];if(!n.state.deleted){var o=n.activeState.value;e.push(Array.isArray(o)?o[0]:o)}}return e};function Se(t){t=t||{},t.tables=t.tables||{},t.empty||(on(t.familyName,"When creating a new Font object, familyName is required."),on(t.styleName,"When creating a new Font object, styleName is required."),on(t.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),on(t.ascender,"When creating a new Font object, ascender is required."),on(t.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:t.familyName||" "},fontSubfamily:{en:t.styleName||" "},fullName:{en:t.fullName||t.familyName+" "+t.styleName},postScriptName:{en:t.postScriptName||(t.familyName+t.styleName).replace(/\s/g,"")},designer:{en:t.designer||" "},designerURL:{en:t.designerURL||" "},manufacturer:{en:t.manufacturer||" "},manufacturerURL:{en:t.manufacturerURL||" "},license:{en:t.license||" "},licenseURL:{en:t.licenseURL||" "},version:{en:t.version||"Version 0.1"},description:{en:t.description||" "},copyright:{en:t.copyright||" "},trademark:{en:t.trademark||" "}},this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.createdTimestamp=t.createdTimestamp,this.tables=Object.assign(t.tables,{os2:Object.assign({usWeightClass:t.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:t.widthClass||this.usWidthClasses.MEDIUM,fsSelection:t.fsSelection||this.fsSelectionValues.REGULAR},t.tables.os2)})),this.supported=!0,this.glyphs=new Rt.GlyphSet(this,t.glyphs||[]),this.encoding=new Mu(this),this.position=new Pn(this),this.substitution=new at(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){if(this._hinting)return this._hinting;if(this.outlinesFormat==="truetype")return this._hinting=new Qu(this)}})}Se.prototype.hasChar=function(t){return this.encoding.charToGlyphIndex(t)!==null};Se.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)};Se.prototype.charToGlyph=function(t){var e=this.charToGlyphIndex(t),r=this.glyphs.get(e);return r||(r=this.glyphs.get(0)),r};Se.prototype.updateFeatures=function(t){return this.defaultRenderOptions.features.map(function(e){return e.script==="latn"?{script:"latn",tags:e.tags.filter(function(r){return t[r]})}:e})};Se.prototype.stringToGlyphs=function(t,e){var r=this,n=new Tt,o=function(y){return r.charToGlyphIndex(y.char)};n.registerModifier("glyphIndex",null,o);var i=e?this.updateFeatures(e.features):this.defaultRenderOptions.features;n.applyFeatures(this,i);for(var u=n.getTextGlyphs(t),l=u.length,f=new Array(l),p=this.glyphs.get(0),d=0;d<l;d+=1)f[d]=this.glyphs.get(u[d])||p;return f};Se.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)};Se.prototype.nameToGlyph=function(t){var e=this.nameToGlyphIndex(t),r=this.glyphs.get(e);return r||(r=this.glyphs.get(0)),r};Se.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""};Se.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;var r=this.position.defaultKerningTables;return r?this.position.getKerningValue(r,t,e):this.kerningPairs[t+","+e]||0};Se.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]};Se.prototype.forEachGlyph=function(t,e,r,n,o,i){e=e!==void 0?e:0,r=r!==void 0?r:0,n=n!==void 0?n:72,o=Object.assign({},this.defaultRenderOptions,o);var u=1/this.unitsPerEm*n,l=this.stringToGlyphs(t,o),f;if(o.kerning){var p=o.script||this.position.getDefaultScriptName();f=this.position.getKerningTables(p,o.language)}for(var d=0;d<l.length;d+=1){var y=l[d];if(i.call(this,y,e,r,n,o),y.advanceWidth&&(e+=y.advanceWidth*u),o.kerning&&d<l.length-1){var m=f?this.position.getKerningValue(f,y.index,l[d+1].index):this.getKerningValue(y,l[d+1]);e+=m*u}o.letterSpacing?e+=o.letterSpacing*n:o.tracking&&(e+=o.tracking/1e3*n)}return e};Se.prototype.getPath=function(t,e,r,n,o){var i=new $e;return this.forEachGlyph(t,e,r,n,o,function(u,l,f,p){var d=u.getPath(l,f,p,o,this);i.extend(d)}),i};Se.prototype.getPaths=function(t,e,r,n,o){var i=[];return this.forEachGlyph(t,e,r,n,o,function(u,l,f,p){var d=u.getPath(l,f,p,o,this);i.push(d)}),i};Se.prototype.getAdvanceWidth=function(t,e,r){return this.forEachGlyph(t,0,0,e,r,function(){})};Se.prototype.draw=function(t,e,r,n,o,i){this.getPath(e,r,n,o,i).draw(t)};Se.prototype.drawPoints=function(t,e,r,n,o,i){this.forEachGlyph(e,r,n,o,i,function(u,l,f,p){u.drawPoints(t,l,f,p)})};Se.prototype.drawMetrics=function(t,e,r,n,o,i){this.forEachGlyph(e,r,n,o,i,function(u,l,f,p){u.drawMetrics(t,l,f,p)})};Se.prototype.getEnglishName=function(t){var e=this.names[t];if(e)return e.en};Se.prototype.validate=function(){var t=this;function e(n,o){}function r(n){var o=t.getEnglishName(n);o&&o.trim().length>0}r("fontFamily"),r("weightName"),r("manufacturer"),r("copyright"),r("version"),this.unitsPerEm>0};Se.prototype.toTables=function(){return xd.fontToTable(this)};Se.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()};Se.prototype.toArrayBuffer=function(){for(var t=this.toTables(),e=t.encode(),r=new ArrayBuffer(e.length),n=new Uint8Array(r),o=0;o<e.length;o++)n[o]=e[o];return r};Se.prototype.download=function(t){var e=this.getEnglishName("fontFamily"),r=this.getEnglishName("fontSubfamily");t=t||e.replace(/\s/g,"")+"-"+r+".otf";var n=this.toArrayBuffer();if(Pd())if(window.URL=window.URL||window.webkitURL,window.URL){var o=new DataView(n),i=new Blob([o],{type:"font/opentype"}),u=document.createElement("a");u.href=window.URL.createObjectURL(i),u.download=t;var l=document.createEvent("MouseEvents");l.initEvent("click",!0,!1),u.dispatchEvent(l)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var f=require("fs"),p=kd(n);f.writeFileSync(t,p)}};Se.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512};Se.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9};Se.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var Xt=new Array(10);Xt[1]=function(){var e=this.offset+this.relativeOffset,r=this.parseUShort();if(r===1)return{posFormat:1,coverage:this.parsePointer(P.coverage),value:this.parseValueRecord()};if(r===2)return{posFormat:2,coverage:this.parsePointer(P.coverage),values:this.parseValueRecordList()};Q.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")};Xt[2]=function(){var e=this.offset+this.relativeOffset,r=this.parseUShort();Q.assert(r===1||r===2,"0x"+e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var n=this.parsePointer(P.coverage),o=this.parseUShort(),i=this.parseUShort();if(r===1)return{posFormat:r,coverage:n,valueFormat1:o,valueFormat2:i,pairSets:this.parseList(P.pointer(P.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(o),value2:this.parseValueRecord(i)}})))};if(r===2){var u=this.parsePointer(P.classDef),l=this.parsePointer(P.classDef),f=this.parseUShort(),p=this.parseUShort();return{posFormat:r,coverage:n,valueFormat1:o,valueFormat2:i,classDef1:u,classDef2:l,class1Count:f,class2Count:p,classRecords:this.parseList(f,P.list(p,function(){return{value1:this.parseValueRecord(o),value2:this.parseValueRecord(i)}}))}}};Xt[3]=function(){return{error:"GPOS Lookup 3 not supported"}};Xt[4]=function(){return{error:"GPOS Lookup 4 not supported"}};Xt[5]=function(){return{error:"GPOS Lookup 5 not supported"}};Xt[6]=function(){return{error:"GPOS Lookup 6 not supported"}};Xt[7]=function(){return{error:"GPOS Lookup 7 not supported"}};Xt[8]=function(){return{error:"GPOS Lookup 8 not supported"}};Xt[9]=function(){return{error:"GPOS Lookup 9 not supported"}};new Array(10);const mr=1e-8,Br=(t,e)=>Qe(t,e,mr*10);function Ng(t,e){const r=t.orientation==="clockwise"?-e:e,n=t.curves.map(p=>({offset:$i(p,r),original:p})),o=[];let i=null,u=n.at(-1);if(!u)return[];if(o.length===1)return o;const l=p=>{i?p.offset instanceof Le?o.push(p.offset):Br(p.offset.firstPoint,p.offset.lastPoint)||o.push(Tn(p.offset.firstPoint,p.offset.lastPoint)):i=p},f=function*(){for(const p of n.slice(0,-1))yield p;if(!i)throw new Error("Bug in the offset algorithm");yield i};for(const p of f()){const d=u.offset.lastPoint,y=p.offset.firstPoint;if(Br(d,y)){l(u),u=p;continue}let m=[];if(u.offset instanceof Le&&p.offset instanceof Le){const{intersections:T,commonSegmentsPoints:x}=Sn(u.offset,p.offset,mr/100);m=[...T,...x]}if(m.length>0){let T=m[0];if(m.length>1){const A=u==null?void 0:u.original.lastPoint,B=m.map(F=>Vf(F,A));T=m[B.indexOf(Math.min(...B))]}const x=u.offset.splitAt([T],mr)[0],C=p.offset.splitAt([T],mr).at(-1);if(!C)throw new Error("Bug in the splitting algo in offset");l({offset:x,original:u.original}),u={offset:C,original:p.original};continue}const S=su(d,y,u.original.lastPoint);l(u),o.push(S),u=p}return l(u),o}function Hg(t,e){const r=Ng(t,e);if(r.length<2)return null;const n=new Map,o=(p,d)=>{const y=n.get(p)||[];n.set(p,[...y,...d])};if(r.forEach((p,d)=>{r.slice(d+1).forEach((y,m)=>{const{intersections:S,commonSegmentsPoints:T}=Sn(p,y,mr),x=[...S,...T].filter(C=>{const A=Br(C,p.firstPoint)||Br(C,p.lastPoint),B=Br(C,y.firstPoint)||Br(C,y.lastPoint);return!(A&&B)});x.length&&(o(d,x),o(m+d+1,x))})}),!n.size){const p=new se(r);return t.intersects(p)?null:p}const u=r.flatMap((p,d)=>{if(!n.has(d))return p;const y=n.get(d)||[];return p.splitAt(y,mr*100)}).filter(p=>!t.curves.find(y=>y.distanceFrom(p)<Math.abs(e)-mr));if(!u.length)return null;const f=nh(u).filter(p=>p.length>1).map(p=>new se(p)).filter(p=>p.isClosed());return f.length?f.length===1?f[0]:new J(f):null}const js=t=>{let e=t[0];for(let r=1;r<t.length;r++)e=Ht(e,t[r]);return e};function Eo(t,e){if(t instanceof se)return Hg(t,e);if(t instanceof J)return js(t.blueprints.map(r=>Eo(r,e)));if(t instanceof me){const r=js(t.blueprints.slice(1).map(n=>Eo(n,e)));return tr(Eo(t.blueprints[0],e),r)}return null}function Ks(t,e,r,n){let o=()=>!0;n&&(o=n.shouldKeep.bind(n));const i=[e.curves[0]],u=(f,p)=>{o({firstCurve:f,secondCurve:p,point:f.lastPoint})?i.push(...t(f,p,r)):i.push(f,p)};e.curves.slice(1).forEach(f=>{const p=i.pop();if(!p)throw new Error("Bug in the blueprint filletting algo");u(p,f)});const l=i.at(-1);if(!l)throw new Error("Bug in the blueprint corner algo");if(Qe(i[0].firstPoint,l.lastPoint)&&i.length>1){const f=i.pop(),p=i.shift();if(!f||!p)throw new Error("Bug in the blueprint filletting algo");u(f,p)}return new se(i)}function Sa(t,e,r,n){if(e instanceof se)return Ks(t,e,r,n);if(e instanceof me)return new me(e.blueprints.map(o=>Ks(t,o,r,n)));if(e instanceof J){const o=e.blueprints.map(i=>Sa(t,i,r,n)).filter(i=>i!==null);return new J(o)}return null}function Vg(t,e,r){return Sa(Yi,t,e,r)}function zg(t,e,r){return Sa(Zi,t,e,r)}function oa(t,e){return t instanceof se?new se(ko(t.curves,e)):t instanceof me?new me(t.blueprints.map(r=>oa(r,e))):t instanceof J?new J(t.blueprints.map(r=>oa(r,e))):t}class We{constructor(e=null){this.innerShape=e}clone(){var e;return new We(((e=this.innerShape)==null?void 0:e.clone())||null)}get boundingBox(){return this.innerShape?this.innerShape.boundingBox:new bn}stretch(e,r,n){return this.innerShape?new We(this.innerShape.stretch(e,r,n)):new We}get repr(){return this.innerShape===null?"=== empty shape":this.innerShape.repr}rotate(e,r){return this.innerShape?new We(this.innerShape.rotate(e,r)):new We}translate(e,r=0){return this.innerShape?new We(this.innerShape.translate(e,r)):new We}scale(e,r){return this.innerShape?new We(this.innerShape.scale(e,r)):new We}mirror(e,r,n){return this.innerShape?new We(this.innerShape.mirror(e,r,n)):new We}cut(e){return new We(tr(this.innerShape,e.innerShape))}fuse(e){return new We(Ht(this.innerShape,e.innerShape))}intersect(e){return new We(un(this.innerShape,e.innerShape))}fillet(e,r){const n=r&&r(new Ro);return new We(Vg(this.innerShape,e,n))}chamfer(e,r){const n=r&&r(new Ro);return new We(zg(this.innerShape,e,n))}sketchOnPlane(e,r){if(!this.innerShape)throw new Error("Trying to sketch an empty drawing");return this.innerShape.sketchOnPlane(e,r)}sketchOnFace(e,r){if(!this.innerShape)throw new Error("Trying to sketch an empty drawing");return this.innerShape.sketchOnFace(e,r)}toSVG(e){var r;return((r=this.innerShape)==null?void 0:r.toSVG(e))||""}toSVGViewBox(e=1){var r;return((r=this.innerShape)==null?void 0:r.toSVGViewBox(e))||""}toSVGPaths(){var e;return((e=this.innerShape)==null?void 0:e.toSVGPaths())||[]}offset(e){return new We(Eo(this.innerShape,e))}approximate(e,r={}){if(e!=="svg")throw new Error("Only 'svg' is supported for now");return new We(oa(this.innerShape,r))}get blueprint(){if(!(this.innerShape instanceof se)){if(this.innerShape instanceof J&&this.innerShape.blueprints.length===1&&this.innerShape.blueprints[0]instanceof se)return this.innerShape.blueprints[0];throw new Error("This drawing is not a blueprint")}return this.innerShape}}class Wg extends Rh{constructor(e=[0,0]){super(),this.pointer=e,this.firstPoint=e,this.pendingCurves=[]}done(){return new We(new se(this.pendingCurves))}close(){return this._closeSketch(),this.done()}closeWithMirror(){return this._closeWithMirror(),this.close()}closeWithCustomCorner(e,r="fillet"){return this._closeSketch(),this._customCornerLastWithFirst(e,r),this.done()}}function Xg(t){const e=new Wg;return t&&e.movePointerTo(t),e}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nl=Symbol("Comlink.proxy"),$g=Symbol("Comlink.endpoint"),Yg=Symbol("Comlink.releaseProxy"),Vi=Symbol("Comlink.finalizer"),xo=Symbol("Comlink.thrown"),ol=t=>typeof t=="object"&&t!==null||typeof t=="function",Zg={canHandle:t=>ol(t)&&t[nl],serialize(t){const{port1:e,port2:r}=new MessageChannel;return Ta(t,e),[r,[r]]},deserialize(t){return t.start(),Qg(t)}},qg={canHandle:t=>ol(t)&&xo in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},il=new Map([["proxy",Zg],["throw",qg]]);function jg(t,e){for(const r of t)if(e===r||r==="*"||r instanceof RegExp&&r.test(e))return!0;return!1}function Ta(t,e=globalThis,r=["*"]){e.addEventListener("message",function n(o){if(!o||!o.data)return;if(!jg(r,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}const{id:i,type:u,path:l}=Object.assign({path:[]},o.data),f=(o.data.argumentList||[]).map(gr);let p;try{const d=l.slice(0,-1).reduce((m,S)=>m[S],t),y=l.reduce((m,S)=>m[S],t);switch(u){case"GET":p=y;break;case"SET":d[l.slice(-1)[0]]=gr(o.data.value),p=!0;break;case"APPLY":p=y.apply(d,f);break;case"CONSTRUCT":{const m=new y(...f);p=nm(m)}break;case"ENDPOINT":{const{port1:m,port2:S}=new MessageChannel;Ta(t,S),p=rm(m,[m])}break;case"RELEASE":p=void 0;break;default:return}}catch(d){p={value:d,[xo]:0}}Promise.resolve(p).catch(d=>({value:d,[xo]:0})).then(d=>{const[y,m]=Wo(d);e.postMessage(Object.assign(Object.assign({},y),{id:i}),m),u==="RELEASE"&&(e.removeEventListener("message",n),al(e),Vi in t&&typeof t[Vi]=="function"&&t[Vi]())}).catch(d=>{const[y,m]=Wo({value:new TypeError("Unserializable return value"),[xo]:0});e.postMessage(Object.assign(Object.assign({},y),{id:i}),m)})}),e.start&&e.start()}function Kg(t){return t.constructor.name==="MessagePort"}function al(t){Kg(t)&&t.close()}function Qg(t,e){const r=new Map;return t.addEventListener("message",function(o){const{data:i}=o;if(!i||!i.id)return;const u=r.get(i.id);if(u)try{u(i)}finally{r.delete(i.id)}}),ia(t,r,[],e)}function mo(t){if(t)throw new Error("Proxy has been released and is not useable")}function sl(t){return Mr(t,new Map,{type:"RELEASE"}).then(()=>{al(t)})}const Vo=new WeakMap,zo="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(Vo.get(t)||0)-1;Vo.set(t,e),e===0&&sl(t)});function Jg(t,e){const r=(Vo.get(e)||0)+1;Vo.set(e,r),zo&&zo.register(t,e,t)}function em(t){zo&&zo.unregister(t)}function ia(t,e,r=[],n=function(){}){let o=!1;const i=new Proxy(n,{get(u,l){if(mo(o),l===Yg)return()=>{em(i),sl(t),e.clear(),o=!0};if(l==="then"){if(r.length===0)return{then:()=>i};const f=Mr(t,e,{type:"GET",path:r.map(p=>p.toString())}).then(gr);return f.then.bind(f)}return ia(t,e,[...r,l])},set(u,l,f){mo(o);const[p,d]=Wo(f);return Mr(t,e,{type:"SET",path:[...r,l].map(y=>y.toString()),value:p},d).then(gr)},apply(u,l,f){mo(o);const p=r[r.length-1];if(p===$g)return Mr(t,e,{type:"ENDPOINT"}).then(gr);if(p==="bind")return ia(t,e,r.slice(0,-1));const[d,y]=Qs(f);return Mr(t,e,{type:"APPLY",path:r.map(m=>m.toString()),argumentList:d},y).then(gr)},construct(u,l){mo(o);const[f,p]=Qs(l);return Mr(t,e,{type:"CONSTRUCT",path:r.map(d=>d.toString()),argumentList:f},p).then(gr)}});return Jg(i,t),i}function tm(t){return Array.prototype.concat.apply([],t)}function Qs(t){const e=t.map(Wo);return[e.map(r=>r[0]),tm(e.map(r=>r[1]))]}const ul=new WeakMap;function rm(t,e){return ul.set(t,e),t}function nm(t){return Object.assign(t,{[nl]:!0})}function Wo(t){for(const[e,r]of il)if(r.canHandle(t)){const[n,o]=r.serialize(t);return[{type:"HANDLER",name:e,value:n},o]}return[{type:"RAW",value:t},ul.get(t)||[]]}function gr(t){switch(t.type){case"HANDLER":return il.get(t.name).deserialize(t.value);case"RAW":return t.value}}function Mr(t,e,r,n){return new Promise(o=>{const i=om();e.set(i,o),t.start&&t.start(),t.postMessage(Object.assign({id:i},r),n)})}function om(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function ll(t,e){return typeof t!="number"||isNaN(t)?{valid:!1,message:`Parameter '${e}' must be a number`}:{valid:!0}}function im(t,e){return t<=0?{valid:!1,message:`Parameter '${e}' must be positive`}:{valid:!0}}function am(t,e,r){return t>=e?{valid:!1,message:`${r} (${t}) must be less than ${e}`}:{valid:!0}}function Et(t,e){const r=ll(t,e);return r.valid?im(t,e):r}function sm(t,e,r){const n=ll(t,r);return n.valid?am(t,e,r):n}function xt(t,e){return r=>{const n=[];for(const o of e){const i=t(r[o],o);i.valid||n.push(i.message)}return{valid:n.length===0,errors:n}}}function Js(t,e){return r=>{const n=r[t],o=r[e],i=sm(n,o,t);return i.valid?{valid:!0,errors:[]}:{valid:!1,errors:[i.message]}}}function um(t,e){let r=!0;const n=[];if(e.params)for(const o of e.params){const{name:i,validators:u}=o;if(!u)continue;const l=t[i];for(const f of u){const p=f(l,i);if(!p.valid){r=!1,n.push(p.message);break}}}if(e.validators)for(const o of e.validators){const i=o(t);i.valid||(r=!1,n.push(...i.errors))}return{valid:r,errors:n}}function Ir({width:t=100,depth:e=100,height:r=100}){if(t===0&&e===0&&r===0)return fe([0,0,0],[1e-7,1e-7,1e-7]);const n=t/2,o=e/2;return fe([-n,-o,0],[n,o,r])}const lm={name:"Cuboid",create:Ir,params:[{name:"width",defaultValue:100},{name:"depth",defaultValue:100},{name:"height",defaultValue:100}],validators:[xt(Et,["width","depth","height"])],hasExplosion:!1};function cm({radius:t=50}){return dh(t)}const fm={name:"Sphere",create:cm,params:[{name:"radius",defaultValue:50}],validators:[xt(Et,["radius"])],hasExplosion:!1};function cl({radius:t=50,height:e=100}){return dr(t,e,[0,0,0],[0,0,-1])}const hm={name:"Cylinder",create:cl,params:[{name:"radius",defaultValue:50},{name:"height",defaultValue:100}],validators:[xt(Et,["radius","height"])],hasExplosion:!1};function pm({aLength:t=80,bLength:e=50,cLength:r=30}){return mh(t,e,r)}const dm={name:"Ellipsoid",create:pm,params:[{name:"aLength",defaultValue:80},{name:"bLength",defaultValue:50},{name:"cLength",defaultValue:30}],validators:[xt(Et,["aLength","bLength","cLength"])],hasExplosion:!1},fl=t=>t.boundingBox.center;function hl(t,e,r){return r.map(({position:n,direction:o,orientation:i})=>{const u=t(),l=e(u);let f=u.translate([n[0]-l[0],n[1]-l[1],n[2]-l[2]]);const p=[0,0,1],d=new M(i||o);if(d.Length>0){const y=new M(p).cross(d);if(y.Length>1e-10){const m=new M(p).getAngle(d);f=f.rotate(m,n,y)}else d.dot(new M(p))<0&&(f=f.rotate(180,n,[1,0,0]))}return f})}function pl(t,e,r,n,o,i=0,u=0,l=1){const f=new M([i,u,l]).normalized();return Array.from({length:e*r},(p,d)=>{const y=Math.floor(d/r),S=d%r*n,T=y*o,C=new tt(new M(t.origin),new M(t.xDirection).normalized(),new M(t.normal).normalized()).toWorldCoords([S,T,0]);return{position:[C.x,C.y,C.z],direction:[t.normal[0],t.normal[1],t.normal[2]],orientation:[f.x,f.y,f.z]}})}function vm(t,e,r,n=0,o=0,i=1){return pl({origin:t,xDirection:e,normal:(()=>{const u=new M(e),l=new M([0,0,1]),f=Math.abs(u.normalized().dot(l))>.99?new M([1,0,0]):u.cross(l).normalized();return[f.x,f.y,f.z]})()},1,r,r>1?new M(e).Length/(r-1):0,0,n,o,i)}function gm({count:t=5,vectorX:e=0,vectorY:r=50,vectorZ:n=50,originX:o=0,originY:i=0,originZ:u=0,boxWidth:l=10,boxDepth:f=10,boxHeight:p=10,orientationX:d=0,orientationY:y=0,orientationZ:m=1}){return At(hl(()=>Ir({width:l,depth:f,height:p}),fl,vm([o,i,u],[e,r,n],t,d,y,m)))}const mm={name:"DiagonalCuboidPattern",create:gm,params:[{name:"count",defaultValue:5},{name:"vectorX",defaultValue:0},{name:"vectorY",defaultValue:50},{name:"vectorZ",defaultValue:50},{name:"originX",defaultValue:0},{name:"originY",defaultValue:0},{name:"originZ",defaultValue:0},{name:"boxWidth",defaultValue:10},{name:"boxDepth",defaultValue:10},{name:"boxHeight",defaultValue:10},{name:"orientationX",defaultValue:0},{name:"orientationY",defaultValue:0},{name:"orientationZ",defaultValue:1}],validators:[xt(Et,["count","boxWidth","boxDepth","boxHeight"])],hasExplosion:!1};function ym({originX:t=0,originY:e=0,originZ:r=0,directionX:n=1,directionY:o=0,directionZ:i=0,normalX:u=0,normalY:l=0,normalZ:f=1,rowCount:p=3,colCount:d=3,xSpacing:y=30,ySpacing:m=30,boxWidth:S=10,boxDepth:T=10,boxHeight:x=10,orientationX:C=0,orientationY:A=0,orientationZ:B=1}){return At(hl(()=>Ir({width:S,depth:T,height:x}),fl,pl({origin:[t,e,r],xDirection:[n,o,i],normal:[u,l,f]},p,d,y,m,C,A,B)))}const wm={name:"RectangularCuboidGrid",create:ym,params:[{name:"originX",defaultValue:0},{name:"originY",defaultValue:0},{name:"originZ",defaultValue:0},{name:"directionX",defaultValue:1},{name:"directionY",defaultValue:0},{name:"directionZ",defaultValue:0},{name:"normalX",defaultValue:0},{name:"normalY",defaultValue:0},{name:"normalZ",defaultValue:1},{name:"rowCount",defaultValue:3},{name:"colCount",defaultValue:3},{name:"xSpacing",defaultValue:30},{name:"ySpacing",defaultValue:30},{name:"boxWidth",defaultValue:10},{name:"boxDepth",defaultValue:10},{name:"boxHeight",defaultValue:10},{name:"orientationX",defaultValue:0},{name:"orientationY",defaultValue:0},{name:"orientationZ",defaultValue:1}],validators:[xt(Et,["rowCount","colCount","xSpacing","ySpacing","boxWidth","boxDepth","boxHeight"])],hasExplosion:!1};function dl({depth:t=100,flangeXLenght:e=50,flangeYLenght:r=50,thickness:n=5}){const o=fe([0,-t/2,0],[e,t/2,n]),i=fe([0,-t/2,0],[n,t/2,r]);return o.fuse(i)}const _m={name:"LProfile",create:dl,params:[{name:"depth",defaultValue:100},{name:"flangeXLenght",defaultValue:50},{name:"flangeYLenght",defaultValue:50},{name:"thickness",defaultValue:5}],validators:[xt(Et,["depth","flangeXLenght","flangeYLenght","thickness"]),Js("thickness","flangeXLenght"),Js("thickness","flangeYLenght")],hasExplosion:!1};function vl({bottomRadius:t=50,topRadius:e=25,height:r=100}){return hs(t,{plane:"XY",origin:[0,0,0]}).loftWith(hs(e,{plane:"XY",origin:[0,0,-r]}),{ruled:!0})}const bm={name:"Frustum",create:vl,params:[{name:"bottomRadius",defaultValue:50},{name:"topRadius",defaultValue:25},{name:"height",defaultValue:100}],validators:[xt(Et,["bottomRadius","topRadius","height"])],hasExplosion:!1};function gl({bottomRadius:t=50,topRadius:e=25,frustumHeight:r=80,cylinderHeight:n=40}){return vl({bottomRadius:t,topRadius:e,height:r}).fuse(dr(e,n,[0,0,-r],[0,0,-1]))}const Sm={name:"Drill",create:gl,params:[{name:"bottomRadius",defaultValue:50},{name:"topRadius",defaultValue:25},{name:"frustumHeight",defaultValue:80},{name:"cylinderHeight",defaultValue:40}],validators:[xt(Et,["bottomRadius","topRadius","frustumHeight","cylinderHeight"])],hasExplosion:!1};function Tm(t,e){return{main:t,helperSpaces:e}}const ne={FRONT:"front",BACK:"back",LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom"},ae={FRONT_LEFT:"front_left",FRONT_RIGHT:"front_right",FRONT_TOP:"front_top",FRONT_BOTTOM:"front_bottom",BACK_LEFT:"back_left",BACK_RIGHT:"back_right",BACK_TOP:"back_top",BACK_BOTTOM:"back_bottom",LEFT_TOP:"left_top",LEFT_BOTTOM:"left_bottom",RIGHT_TOP:"right_top",RIGHT_BOTTOM:"right_bottom"};function yo(t){let e;switch(t){case ne.FRONT:e=new M([0,-1,0]);break;case ne.BACK:e=new M([0,1,0]);break;case ne.LEFT:e=new M([-1,0,0]);break;case ne.RIGHT:e=new M([1,0,0]);break;case ne.TOP:e=new M([0,0,1]);break;case ne.BOTTOM:e=new M([0,0,-1]);break;default:throw new Error(`Unknown face identifier: ${t}`)}return e}function ml(t,e){const[[r,n,o],[i,u,l]]=t.bounds;let f;switch(e){case ae.FRONT_TOP:f=new M([r,n,l]);break;case ae.FRONT_BOTTOM:f=new M([r,n,o]);break;case ae.BACK_TOP:f=new M([r,u,l]);break;case ae.BACK_BOTTOM:f=new M([r,u,o]);break;case ae.LEFT_TOP:f=new M([r,n,l]);break;case ae.LEFT_BOTTOM:f=new M([r,n,o]);break;case ae.RIGHT_TOP:f=new M([i,n,l]);break;case ae.RIGHT_BOTTOM:f=new M([i,n,o]);break;case ae.FRONT_LEFT:f=new M([r,n,o]);break;case ae.FRONT_RIGHT:f=new M([i,n,o]);break;case ae.BACK_LEFT:f=new M([r,u,o]);break;case ae.BACK_RIGHT:f=new M([i,u,o]);break;default:throw new Error(`Unknown edge identifier: ${e}`)}return f}function yl(t,e){const[[r,n,o],[i,u,l]]=t.bounds;let f;switch(e){case ae.FRONT_TOP:f=new M([i,n,l]);break;case ae.FRONT_BOTTOM:f=new M([i,n,o]);break;case ae.BACK_TOP:f=new M([i,u,l]);break;case ae.BACK_BOTTOM:f=new M([i,u,o]);break;case ae.LEFT_TOP:f=new M([r,u,l]);break;case ae.LEFT_BOTTOM:f=new M([r,u,o]);break;case ae.RIGHT_TOP:f=new M([i,u,l]);break;case ae.RIGHT_BOTTOM:f=new M([i,u,o]);break;case ae.FRONT_LEFT:f=new M([r,n,l]);break;case ae.FRONT_RIGHT:f=new M([i,n,l]);break;case ae.BACK_LEFT:f=new M([r,u,l]);break;case ae.BACK_RIGHT:f=new M([i,u,l]);break;default:throw new Error(`Unknown edge identifier: ${e}`)}return f}function Em(t){switch(t){case ae.FRONT_LEFT:return[ne.FRONT,ne.LEFT];case ae.FRONT_RIGHT:return[ne.FRONT,ne.RIGHT];case ae.FRONT_TOP:return[ne.FRONT,ne.TOP];case ae.FRONT_BOTTOM:return[ne.FRONT,ne.BOTTOM];case ae.BACK_LEFT:return[ne.BACK,ne.LEFT];case ae.BACK_RIGHT:return[ne.BACK,ne.RIGHT];case ae.BACK_TOP:return[ne.BACK,ne.TOP];case ae.BACK_BOTTOM:return[ne.BACK,ne.BOTTOM];case ae.LEFT_TOP:return[ne.LEFT,ne.TOP];case ae.LEFT_BOTTOM:return[ne.LEFT,ne.BOTTOM];case ae.RIGHT_TOP:return[ne.RIGHT,ne.TOP];case ae.RIGHT_BOTTOM:return[ne.RIGHT,ne.BOTTOM];default:throw new Error(`Unknown edge identifier: ${t}`)}}function xm(t,e,r=.5,n=.5){const[[o,i,u],[l,f,p]]=t.bounds,d=Math.max(0,Math.min(1,r)),y=Math.max(0,Math.min(1,n));let m;switch(e){case ne.FRONT:m=new M([o+(l-o)*d,i,u+(p-u)*y]);break;case ne.BACK:m=new M([o+(l-o)*d,f,u+(p-u)*y]);break;case ne.LEFT:m=new M([o,i+(f-i)*d,u+(p-u)*y]);break;case ne.RIGHT:m=new M([l,i+(f-i)*d,u+(p-u)*y]);break;case ne.TOP:m=new M([o+(l-o)*d,i+(f-i)*y,p]);break;case ne.BOTTOM:m=new M([o+(l-o)*d,i+(f-i)*y,u]);break;default:throw new Error(`Unknown face identifier: ${e}`)}return m}function Cm(t,e,r=.5){const n=Math.max(0,Math.min(1,r)),o=ml(t,e),i=yl(t,e);return new M([o.x+(i.x-o.x)*n,o.y+(i.y-o.y)*n,o.z+(i.z-o.z)*n])}function Pm(t,e){const{type:r,element:n,params:o={}}=e;switch(r){case"face":return xm(t,n,o.u,o.v);case"edge":return Cm(t,n,o.t);case"corner":if(n.includes("START")){const i=n.replace("_START","");return ml(t,i)}else if(n.includes("END")){const i=n.replace("_END","");return yl(t,i)}else throw new Error(`Invalid corner identifier: ${n}`);case"center":return new M(t.center);default:throw new Error(`Unknown position type: ${r}`)}}function km(t){const e=t.normalized(),r=Math.abs(e.x),n=Math.abs(e.y),o=Math.abs(e.z);let i;return r<=n&&r<=o?i=new M([0,e.z,-e.y]):n<=r&&n<=o?i=new M([e.z,0,-e.x]):i=new M([e.y,-e.x,0]),i.normalized()}function wo(t,e,r,n={}){const o=Pm(t.boundingBox,e);let i;n.normal?i=new M(n.normal):i=Am(t,e,n);let u;n.xDir?u=new M(n.xDir):u=km(i);const l=new yr;l.coordSystemChange({origin:o.toTuple(),zDir:i.toTuple(),xDir:u.toTuple()},"reference");const f=Ae(l.transform(r.wrapped));return l.delete(),i.delete(),u.delete(),o.delete(),f}function Am(t,e,r={}){const{type:n,element:o}=e;switch(n){case"face":return yo(o);case"edge":if(r.faceForEdge)return yo(r.faceForEdge);{const i=Em(o);return yo(i[0])}case"corner":return r.faceForCorner?yo(r.faceForCorner):new M([0,0,1]);case"center":default:return new M([0,0,1])}}function pr(t,e,r,n=!1){return n?Ae(t.wrapped).mirror(e,r):t.mirror(e,r)}const wl=[{id:"ST001",name:"Stringer"},{id:"LP001",name:"L-Profile"},{id:"SS001",name:"Side Stringer"}];function Om({width:t=50,depth:e=100,height:r=200,showHelper:n=!0,explosionFactor:o=0}){const i=Ir({width:t,depth:e,height:r}),u=Math.round(r/17.5)-1;if(u<=0)return Tm(At([]),n?[i]:[]);const l=r/(u+1),f=u>1?(e-28)/(u-1):0,p=Ir({width:t-1,depth:20,height:.5}),d=p.boundingBox.center,y=wo(p,{type:"face",element:ne.TOP,params:{u:1.5/(t-1),v:2.25/20}},gl({bottomRadius:1.2,topRadius:.8,frustumHeight:.5*.8,cylinderHeight:.5*.2})),m=p.cut(y).cut(pr(y,"XZ",d,!0)).cut(pr(y,"YZ",d,!0)).cut(pr(pr(y,"XZ",d,!0),"YZ",d,!0)),S=m.clone(),T=dl({depth:20,flangeXLenght:4.5,flangeYLenght:4.5,thickness:.5}),x=T.boundingBox.center,C=wo(T,{type:"face",element:ne.BOTTOM,params:{u:1.5/4.5,v:2.25/20}},cl({radius:.800001,height:.5})),A=T.cut(C).cut(pr(C,"XZ",x,!0)),B=A.clone(),F=wo(m,{type:"edge",element:ae.LEFT_BOTTOM,params:{t:.5}},A,{normal:[0,0,-1],xDir:[1,0,0]}),q=pr(F,"YZ",d,!0),z=[];let ie=0,re=-e/2+14,ee=l-(m.boundingBox.bounds[1][2]-m.boundingBox.bounds[0][2]);for(let rt=0;rt<u;rt++){const je=o*15;z.push(m.clone().translate([ie,re,ee])),z.push(F.clone().translate([ie-je,re,ee])),z.push(q.clone().translate([ie+je,re,ee])),re+=f,ee+=l}const de=Ir({width:600,depth:20,height:.5}),Te=f,Oe=l,Re=Math.sqrt(Te*Te+Oe*Oe),Ce=Re>.001?[0,Te/Re,Oe/Re]:[1,0,0],ge=wo(i,{type:"face",element:ne.RIGHT},de,{normal:[-1,0,0],xDir:Ce}).intersect(i),Pe=ge.clone(),ve=i.boundingBox.center,we=pr(ge,"YZ",ve,!0),ke=o*30,Ge=o*30;z.push(ge.translate([ke,0,0])),z.push(we.translate([-Ge,0,0]));const _e=At(z),De=wl.map(rt=>{let je=0,ut="Variable";return rt.id==="ST001"?(je=u,ut=`${t-1}200.5cm`):rt.id==="LP001"?(je=u*2,ut="4.54.520cm"):rt.id==="SS001"&&(je=2),{...rt,quantity:je,dimensions:ut,material:"Steel"}});return{main:_e,helperSpaces:n?[i]:[],componentData:De,technicalDrawingModels:{ST001:S,LP001:B,SS001:Pe}}}const Rm={name:"Staircase",create:Om,params:[{name:"width",defaultValue:50},{name:"depth",defaultValue:100},{name:"height",defaultValue:200},{name:"showHelper",defaultValue:!0},{name:"explosionFactor",defaultValue:0}],validators:[xt(Et,["width","depth","height"])],hasExplosion:!0,hasTechnicalDrawingParts:!0,componentDataStructure:wl},Dm=[{id:"SB001",name:"Side Board + Tape"},{id:"BD001",name:"Bottom Divider + Tape"},{id:"HB1001",name:"Horizontal Board 1 + Tape"},{id:"HB2001",name:"Horizontal Board 2 + Tape"},{id:"VB001",name:"Vertical Board + Tape"},{id:"SS001",name:"Small Shelf + Tape"},{id:"SSTDH001",name:"Small Shelf (Top Div Holes) + Tape"},{id:"SSBDH001",name:"Small Shelf (Both Div Holes) + Tape"},{id:"SSWDH001",name:"Small Shelf (Bottom Div Holes) + Tape"},{id:"SSD001",name:"Small Shelf Divider + Tape"},{id:"BS001",name:"Big Shelf + Tape"},{id:"HB3001",name:"Horizontal Board 3 + Tape"},{id:"MD001",name:"Middle Door + Tapes"},{id:"SDL001",name:"Side Door Left + Tapes"},{id:"SDR001",name:"Side Door Right + Tapes"}];function Mm({width:t,depth:e,board_thickness:r}){let n=[];const o={},l=Math.floor(e/10),f=Math.floor((e-r)/10),p=Math.floor(e/15),d=(e-l*5)/(l+1),y=(e-r-f*5)/(f+1),m=(2*e/3-p*5)/(p+1),S=Xg([-2.4,.25]).bulgeArcTo([2.4,.25],-.3).tangentArcTo([2.4,-.25]).bulgeArcTo([-2.4,-.25],-.3).tangentArcTo([-2.4,.25]).close().sketchOnPlane("XZ",-.15).extrude(.3),T=[];for(let G=0;G<l;G++){const Y=S.clone().translate(d+2.5+G*(5+d),-t/2+r/2,50);T.push(Y),n.push(Y.clone()),n.push(Y.clone().mirror("XZ"))}const x=ye(T),C=[];for(let G=0;G<f;G++){const Y=S.clone().rotate(90,[0,0,0],[1,0,0]).translate(y+2.5+G*(5+y),-t/2+r,3*r/2);C.push(Y),n.push(Y.clone()),n.push(Y.clone().mirror("XZ"))}const A=ye(C),B=fe([0,-t/2,0],[e,-t/2+r,50]).cut(x).cut(A),F=fe([e,-t/2,0],[e+.2,-t/2+r,50]),q=B.clone(),z=F.clone();o.SB001=ye([q,z]),n.push(B),n.push(B.clone().mirror("XZ")),n.push(F),n.push(F.clone().mirror("XZ"));const ie=[];for(let G=0;G<f;G++){const Y=S.clone().translate(y+2.5+G*(5+y),t/6,2*r);ie.push(Y),n.push(Y.clone()),n.push(Y.clone().mirror("XZ"))}const re=ye(ie),ee=fe([0,-t/2+r,r],[e-r-.2,t/2-r,2*r]).cut(A).cut(A).cut(A.mirror("XZ")).cut(re).cut(re.clone().mirror("XZ")),de=fe([e-r-.2,-t/2+r,r],[e-r,t/2-r,2*r]),Te=ee.clone(),Oe=de.clone();o.HB1001=ye([Te,Oe]),n.push(ee),n.push(de);const Re=[];for(let G=0;G<f;G++){const Y=S.clone().translate(y+2.5+G*(5+y),t/6,50);Re.push(Y),n.push(Y.clone()),n.push(Y.clone().mirror("XZ"))}const Ce=ye(Re),ue=fe([0,t/6-r/2,2*r],[e-r-.2,t/6+r/2,50]).cut(re).cut(Ce),ge=fe([e-r-.2,t/6-r/2,2*r],[e-r,t/6+r/2,50]),Pe=ue.clone(),ve=ge.clone();o.BD001=ye([Pe,ve]),n.push(ue),n.push(ue.clone().mirror("XZ")),n.push(ge),n.push(ge.clone().mirror("XZ"));const we=[];for(let G=0;G<p;G++){const Y=S.clone().translate(m+2.5+G*(5+m),t/4,50+r);we.push(Y),n.push(Y.clone()),n.push(Y.clone().mirror("XZ"))}const ke=ye(we),Ge=fe([0,-t/2,50],[e,t/2,50+r]).cut(x).cut(x.mirror("XZ")).cut(Ce).cut(Ce.mirror("XZ")).cut(ke).cut(ke.clone().mirror("XZ")),_e=fe([e,-t/2,50],[e+.2,t/2,50+r]),De=Ge.clone(),$t=_e.clone();o.HB2001=ye([De,$t]),n.push(Ge),n.push(_e);const rt=[];for(let G=0;G<p;G++){const Y=S.clone().translate(m+2.5+G*(5+m),t/4,50+6*(r+30));rt.push(Y),n.push(Y.clone()),n.push(Y.clone().mirror("XZ"))}const je=ye(rt),ut=[];for(let G=0;G<4;G++)for(let Y=0;Y<p;Y++){const Je=S.clone().rotate(90,[0,0,0],[1,0,0]).translate(m+2.5+Y*(5+m),t/4-r/2,50+2.5*r+60+G*(30+r));ut.push(Je),n.push(Je.clone()),n.push(Je.clone().mirror("XZ"))}const Sr=ye(ut),lt=dr(.4,3,[m/2,-t/4,50+30+1.5*r],[0,-1,0]),Ne=[];for(let G=0;G<5;G++)for(let Y=0;Y<p+1;Y++){const Je=lt.clone().translate(Y*(m+5),0,G*(30+r));Ne.push(Je),n.push(Je.clone()),n.push(Je.clone().mirror("XZ"))}const Ye=ye(Ne),ct=fe([0,t/4-r/2,50+r],[2*e/3,t/4+r/2,50+6*(r+30)]).cut(ke).cut(je).cut(Sr).cut(Ye),Dt=fe([2*e/3,t/4-r/2,50+r],[2*e/3+.2,t/4+r/2,50+6*(r+30)]),L=ct.clone(),oe=Dt.clone();o.VB001=ye([L,oe]),n.push(ct),n.push(ct.clone().mirror("XZ")),n.push(Dt),n.push(Dt.clone().mirror("XZ"));const nt=[];for(let G=0;G<p+1;G++){const Y=lt.clone().translateX(G*(m+5));nt.push(Y)}const Rn=ye(nt),dt=fe([0,t/4+r/2,50+r+30],[2*e/3,t/2,50+2*r+30]).cut(Rn),Mt=fe([2*e/3,t/4+r/2,50+r+30],[2*e/3+.2,t/2,50+2*r+30]),Dn=dt.clone(),Mn=Mt.clone();o.SS001=ye([Dn,Mn]),n.push(dt),n.push(dt.clone().mirror("XZ")),n.push(dt.clone().translateZ(30+r)),n.push(dt.clone().translateZ(30+r).mirror("XZ"));const Yr=[];for(let G=0;G<p;G++){const Y=S.clone().translate(m+2.5+G*(m+5),3*t/8-r/4,140+4*r);Yr.push(Y),n.push(Y.clone()),n.push(Y.clone().mirror("XZ"))}const Zr=ye(Yr),Fn=[];for(let G=0;G<p;G++){const Y=S.clone().translate(m+2.5+G*(m+5),3*t/8-r/4,50+4*(30+r));Fn.push(Y),n.push(Y.clone()),n.push(Y.clone().mirror("XZ"))}const Bn=ye(Fn),Ln=[];for(let G=0;G<p;G++){const Y=S.clone().translate(m+2.5+G*(m+5),3*t/8-r/4,170+5*r);Ln.push(Y),n.push(Y.clone()),n.push(Y.clone().mirror("XZ"))}const Qo=ye(Ln),Un=[];for(let G=0;G<p;G++){const Y=S.clone().translate(m+2.5+G*(m+5),3*t/8-r/4,50+5*(30+r));Un.push(Y),n.push(Y.clone()),n.push(Y.clone().mirror("XZ"))}const Jo=ye(Un),vt=dt.clone().translateZ(2*(30+r)).cut(Zr),ur=vt.clone(),Ea=Mt.clone().translateZ(2*(30+r));o.SSTDH001=ye([ur,Ea]),n.push(vt),n.push(vt.clone().mirror("XZ"));const lr=dt.clone().translateZ(3*(30+r)).cut(Bn).cut(Qo),Tr=lr.clone(),Ct=Mt.clone().translateZ(3*(30+r));o.SSBDH001=ye([Tr,Ct]),n.push(lr),n.push(lr.clone().mirror("XZ"));const qr=dt.clone().translateZ(4*(30+r)).cut(Jo),In=qr.clone(),Gn=Mt.clone().translateZ(4*(30+r));o.SSWDH001=ye([In,Gn]),n.push(qr),n.push(qr.clone().mirror("XZ"));for(let G=0;G<5;G++)n.push(Mt.clone().translateZ(G*(r+30))),n.push(Mt.clone().translateZ(G*(r+30)).mirror("XZ"));const He=fe([0,3*t/8-3*r/4,50+3*30+4*r],[2*e/3,3*t/8+r/4,50+4*(30+r)]).cut(Zr).cut(Bn);n.push(He),n.push(He.clone().mirror("XZ")),n.push(He.clone().translateZ(30+r)),n.push(He.clone().translateZ(30+r).mirror("XZ"));const Yt=fe([2*e/3,3*t/8-3*r/4,50+3*30+4*r],[2*e/3+.2,3*t/8+r/4,50+4*(30+r)]),ei=He.clone(),ti=Yt.clone();o.SSD001=ye([ei,ti]),n.push(Yt),n.push(Yt.clone().mirror("XZ")),n.push(Yt.clone().translateZ(r+30)),n.push(Yt.clone().translateZ(r+30).mirror("XZ"));const Ie=[];for(let G=0;G<p;G++){const Y=S.clone().rotate(90,[0,0,0],[1,0,0]).translate(m+2.5+G*(5+m),t/4-r/2,50+2.5*r+60);Ie.push(Y)}const gt=ye(Ie),Nn=fe([0,-t/4+r/2,50+2*(30+r)],[2*e/3,t/4-r/2,50+2*30+3*r]).cut(gt),Er=fe([2*e/3,-t/4+r/2,50+2*(30+r)],[2*e/3+.2,t/4-r/2,50+2*30+3*r]),xr=Nn.clone(),Cr=Er.clone();o.BS001=ye([xr,Cr]);for(let G=0;G<4;G++)n.push(Nn.clone().translateZ(G*(30+r))),n.push(Er.clone().translateZ(G*(30+r)));const Hn=fe([0,-t/2,50+6*(r+30)],[e,t/2,50+7*r+6*30]).cut(je).cut(je.mirror("XZ")),Vn=fe([e,-t/2,50+6*(r+30)],[e+.2,t/2,50+7*r+6*30]),ri=Hn.clone(),ni=Vn.clone();o.HB3001=ye([ri,ni]),n.push(Hn),n.push(Vn);const le=dr(.3,r,[e,-t/6-r,50-r],[-1,0,0]),Pr=dr(1.5,r/2,[e-r,-t/2+2*r,50-2*r],[1,0,0]),it=fe([e-r,-t/2+r+.4,r],[e,-t/6-.3,50-.4]).cut(le).cut(Pr).cut(Pr.clone().translateZ(-50+6*r));n.push(it);const Ft=it.clone().mirror("XZ"),jr=fe([e-r,-t/6-.3,r],[e,-t/6-.1,50-.4]),Kr=fe([e-r,-t/2+r+.2,r],[e,-t/2+r+.4,50-.4]),kr=fe([e-r,-t/2+r+.4,50-.4],[e,-t/6-.3,50-.2]),K=fe([e-r,-t/2+r+.4,r],[e,-t/6-.3,r+.2]),oi=it.clone(),g=jr.clone(),ce=Kr.clone(),ii=kr.clone(),ai=K.clone(),zn=ye([oi,g,ce,ii,ai]);o.SDL001=zn,o.SDR001=zn.clone().mirror("XZ"),n.push(Ft);const Wn=fe([e-r,-t/6+.3,r],[e,t/6-.3,50-.4]).cut(le.clone().translateY(2*r).mirror("XZ")).cut(Pr.clone().translateY(t/3)).cut(Pr.clone().translate(0,t/3,-50+6*r)),Xn=fe([e-r,-t/6+.1,r],[e,-t/6+.3,50-.4]),$n=fe([e-r,t/6-.3,r],[e,t/6-.1,50-.4]),Yn=fe([e-r,-t/6+.3,50-.4],[e,t/6-.3,50-.2]),Zn=fe([e-r,-t/6+.3,r],[e,t/6-.3,r+.2]),si=Wn.clone(),ui=Xn.clone(),li=$n.clone(),Ar=Yn.clone(),ci=Zn.clone();o.MD001=ye([si,ui,li,Ar,ci]),n.push(Wn),n.push(Xn),n.push($n),n.push(Yn),n.push(Zn),n.push(jr),n.push(Kr),n.push(kr),n.push(K),n.push(jr.clone().mirror("XZ")),n.push(Kr.clone().mirror("XZ")),n.push(kr.clone().mirror("XZ")),n.push(K.clone().mirror("XZ"));const Or=dr(.5,2,[e,t/6+r,50-r],[1,0,0]).fuse(dr(1,1,[e+2,t/6+r,50-r],[1,0,0]));return n.push(Or),n.push(Or.clone().mirror("XZ")),n.push(Or.clone().translateY(-2*r)),{main:ye(n),technicalDrawingModels:o}}const Fm={name:"Closet",create:Mm,params:[{name:"width",defaultValue:200,description:"Overall width of the closet"},{name:"depth",defaultValue:50,description:"Overall depth of the closet"},{name:"board_thickness",defaultValue:3,description:"Thickness of the boards used"}],validators:[xt(Et,["width","depth","board_thickness"])],hasExplosion:!1,hasBoM:!0,hasTechnicalDrawingParts:!0,componentDataStructure:Dm},Bm={Cuboid:lm,Sphere:fm,Cylinder:hm,Ellipsoid:dm,DiagonalCuboidPattern:mm,RectangularCuboidGrid:wm,LProfile:_m,Frustum:bm,Drill:Sm,Closet:Fm,Staircase:{...Rm,hasBoM:!0}};function Lm(t,e){const r=Bm[t];if(!r)throw new Error(`Model "${t}" not found`);const n=um(e,r);return n.valid?r.create(e):{error:!0,validationErrors:n.errors}}let eu=!1;const Um=async()=>{if(eu)return Promise.resolve(!0);const t=await Pf({locateFile:()=>kf});return eu=!0,Af(t),!0},Im=Um();function Gm(t,e,r="standard"){return console.time(`[PERF] Total ${t} creation (Quality: ${r})`),Im.then(()=>{console.time(`[PERF] ${t} model function`);const n=Lm(t,e);if(console.timeEnd(`[PERF] ${t} model function`),n&&n.error)return{error:!0,validationErrors:n.validationErrors};const o=n&&n.main?n.main:n;if(!o||typeof o.mesh!="function")return console.error("Invalid shape determined for meshing:",o),console.timeEnd(`[PERF] Total ${t} creation (Quality: ${r})`),{error:!0,message:"Invalid model shape generated."};const i=n&&n.main&&Array.isArray(n.helperSpaces)?n.helperSpaces:[],u=r==="high"?{tolerance:.01,angularTolerance:1}:{tolerance:.1,angularTolerance:15};console.log(`[INFO] Using mesh options for ${r} quality:`,u),console.time(`[PERF] ${t} main model generation (Quality: ${r})`);const l=o.mesh(u),f=o.meshEdges(u);console.timeEnd(`[PERF] ${t} main model generation (Quality: ${r})`);let p=[];return i.length>0&&(console.time(`[PERF] ${t} helper spaces generation (Quality: ${r})`),p=i.map(d=>!d||typeof d.mesh!="function"?(console.warn("Skipping invalid helper space shape:",d),null):{faces:d.mesh(u),edges:d.meshEdges(u)}).filter(d=>d!==null),console.timeEnd(`[PERF] ${t} helper spaces generation (Quality: ${r})`)),console.timeEnd(`[PERF] Total ${t} creation (Quality: ${r})`),{faces:l,edges:f,helperSpaces:p,componentData:n.componentData}})}Ta({createMesh:Gm})});export default Nm();
